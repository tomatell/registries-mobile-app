{"version":3,"file":"xpsui.min.js","sources":["../../../src/client/js/xpsui/services-module.js","../../../src/client/js/xpsui/services/calculator.js","../../../src/client/js/xpsui/services/component-generator.js","../../../src/client/js/xpsui/services/date-util.js","../../../src/client/js/xpsui/services/dropdown-factory.js","../../../src/client/js/xpsui/services/file-upload-factory.js","../../../src/client/js/xpsui/services/form-generator.js","../../../src/client/js/xpsui/services/generators-generator.js","../../../src/client/js/xpsui/services/generic-search-factory.js","../../../src/client/js/xpsui/services/http-handler-factory.js","../../../src/client/js/xpsui/services/logging.js","../../../src/client/js/xpsui/services/massmailing-factory.js","../../../src/client/js/xpsui/services/navigation-service.js","../../../src/client/js/xpsui/services/notification-factory.js","../../../src/client/js/xpsui/services/object-tools.js","../../../src/client/js/xpsui/services/objectlink2-factory.js","../../../src/client/js/xpsui/services/remove-button-facktory.js","../../../src/client/js/xpsui/services/schema-editor-service.js","../../../src/client/js/xpsui/services/schema-util.js","../../../src/client/js/xpsui/services/security-service.js","../../../src/client/js/xpsui/services/selectbox-factory.js","../../../src/client/js/xpsui/services/selectdata-factory.js","../../../src/client/js/xpsui/services/statistics-service-factory.js","../../../src/client/js/xpsui/directives-module.js","../../../src/client/js/xpsui/directives/actionLink.js","../../../src/client/js/xpsui/directives/array-control-edit.js","../../../src/client/js/xpsui/directives/array-control-view.js","../../../src/client/js/xpsui/directives/array.js","../../../src/client/js/xpsui/directives/by-schema-field-edit.js","../../../src/client/js/xpsui/directives/by-schema-field-view.js","../../../src/client/js/xpsui/directives/calendar.js","../../../src/client/js/xpsui/directives/confirm.js","../../../src/client/js/xpsui/directives/contenteditable.js","../../../src/client/js/xpsui/directives/dashboard-widget-empty.js","../../../src/client/js/xpsui/directives/dashboard-widget-requests.js","../../../src/client/js/xpsui/directives/date-edit.js","../../../src/client/js/xpsui/directives/date-view.js","../../../src/client/js/xpsui/directives/default-src.js","../../../src/client/js/xpsui/directives/fieldset.js","../../../src/client/js/xpsui/directives/form-control.js","../../../src/client/js/xpsui/directives/form.js","../../../src/client/js/xpsui/directives/generateActionLink.js","../../../src/client/js/xpsui/directives/generic-search-factory.js","../../../src/client/js/xpsui/directives/imageresizor.js","../../../src/client/js/xpsui/directives/inlineedit.js","../../../src/client/js/xpsui/directives/menu-items.js","../../../src/client/js/xpsui/directives/menu.js","../../../src/client/js/xpsui/directives/multistring-edit.js","../../../src/client/js/xpsui/directives/notification.js","../../../src/client/js/xpsui/directives/objectlink2-edit.js","../../../src/client/js/xpsui/directives/objectlink2-view.js","../../../src/client/js/xpsui/directives/portal-article-content-edit.js","../../../src/client/js/xpsui/directives/portal-menu-editor.js","../../../src/client/js/xpsui/directives/portal-menu-render.js","../../../src/client/js/xpsui/directives/portal-multistring-edit.js","../../../src/client/js/xpsui/directives/portal-widget-category-edit.js","../../../src/client/js/xpsui/directives/portal-widget-category-view.js","../../../src/client/js/xpsui/directives/portal-widget-file-list-edit.js","../../../src/client/js/xpsui/directives/portal-widget-file-list-view.js","../../../src/client/js/xpsui/directives/portal-widget-gallery-edit.js","../../../src/client/js/xpsui/directives/portal-widget-gallery-view.js","../../../src/client/js/xpsui/directives/portal-widget-image-edit.js","../../../src/client/js/xpsui/directives/portal-widget-image-view.js","../../../src/client/js/xpsui/directives/portal-widget-image1170-edit.js","../../../src/client/js/xpsui/directives/portal-widget-image1170-view.js","../../../src/client/js/xpsui/directives/portal-widget-link-edit.js","../../../src/client/js/xpsui/directives/portal-widget-link-view.js","../../../src/client/js/xpsui/directives/portal-widget-match-results-edit.js","../../../src/client/js/xpsui/directives/portal-widget-match-results-view.js","../../../src/client/js/xpsui/directives/portal-widget-match-standings-edit.js","../../../src/client/js/xpsui/directives/portal-widget-match-standings-view.js","../../../src/client/js/xpsui/directives/portal-widget-overview-edit.js","../../../src/client/js/xpsui/directives/portal-widget-overview-view.js","../../../src/client/js/xpsui/directives/portal-widget-pure-html-edit.js","../../../src/client/js/xpsui/directives/portal-widget-pure-html-view.js","../../../src/client/js/xpsui/directives/portal-widget-ranking-edit.js","../../../src/client/js/xpsui/directives/portal-widget-ranking-view.js","../../../src/client/js/xpsui/directives/portal-widget-showcase-edit.js","../../../src/client/js/xpsui/directives/portal-widget-showcase-view.js","../../../src/client/js/xpsui/directives/portal-widget-showcasevideo-edit.js","../../../src/client/js/xpsui/directives/portal-widget-showcasevideo-view.js","../../../src/client/js/xpsui/directives/portal-widget-video-edit.js","../../../src/client/js/xpsui/directives/portal-widget-video-view.js","../../../src/client/js/xpsui/directives/record-action.js","../../../src/client/js/xpsui/directives/required.js","../../../src/client/js/xpsui/directives/select-edit.js","../../../src/client/js/xpsui/directives/select-view.js","../../../src/client/js/xpsui/directives/string-edit.js","../../../src/client/js/xpsui/directives/string-view.js","../../../src/client/js/xpsui/directives/textarea-edit.js","../../../src/client/js/xpsui/directives/textarea-view.js","../../../src/client/js/xpsui/directives/unique.js","../../../src/client/js/xpsui/directives/uploadable-file.js","../../../src/client/js/xpsui/directives/uploadable-image-view.js","../../../src/client/js/xpsui/directives/uploadable-image.js","../../../src/client/js/xpsui/directives/validity-mark.js","../../../src/client/js/xpsui/directives/x-portal-multistring-edit.js","../../../src/client/js/xpsui/controllers-module.js","../../../src/client/js/xpsui/controller/dashboard-ctrl.js","../../../src/client/js/xpsui/controller/help-page-ctrl.js","../../../src/client/js/xpsui/controller/massmailing-edit-ctrl.js","../../../src/client/js/xpsui/controller/personal-page-ctrl.js","../../../src/client/js/xpsui/controller/portal-editor-ctrl.js","../../../src/client/js/xpsui/controller/portal-editor-list-ctrl.js","../../../src/client/js/xpsui/controller/portal-editor-menu-ctrl.js","../../../src/client/js/xpsui/controller/registry-custom-generate-ctrl.js","../../../src/client/js/xpsui/controller/registry-custom-template-ctrl.js","../../../src/client/js/xpsui/controller/registry-new-ctrl.js","../../../src/client/js/xpsui/controller/registry-search-ctrl.js","../../../src/client/js/xpsui/controller/registry-view-ctrl.js","../../../src/client/js/xpsui/controller/schema-editor-index-ctrl.js","../../../src/client/js/xpsui/controller/schema-editor-show-ctrl.js","../../../src/client/js/xpsui/controller/security-forgotten-ctrl.js","../../../src/client/js/xpsui/controller/security-forgotten-reset-ctrl.js","../../../src/client/js/xpsui/controller/security-group-edit-ctrl.js","../../../src/client/js/xpsui/controller/security-login-ctrl.js","../../../src/client/js/xpsui/controller/security-logout-ctrl.js","../../../src/client/js/xpsui/controller/security-personal-change-password-ctrl.js","../../../src/client/js/xpsui/controller/security-profile-edit-ctrl.js","../../../src/client/js/xpsui/controller/security-user-edit-ctrl.js","../../../src/client/js/xpsui/controller/statistics-view-ctrl.js","../../../src/client/js/xpsui/filters-module.js","../../../src/client/js/xpsui/filters/dateToString.js","../../../src/client/js/xpsui/filters/httpPrefixed.js","../../../src/client/js/xpsui/filters/uriescape.js"],"names":["angular","module","dotAccess","obj","key","def","Array","isArray","split","i","l","length","part","factory","q","noop","args","concat","keys","Object","sort","result","get","scope","path","substr","string","start","mod","first","second","replace","search","value","if","condition","eq","gt","gte","lt","lte","and","or","pad","size","fill","computationRegistry","ComputedProperty","schema","this","prototype","getter","computationFunc","func","self","argName","hasOwnProperty","arg","argProperty","all","then","results","watcher","collect","subschema","watch","push","createProperty","window","log","isPrimitiveProperty","schemaFragment","type","generatePrimitiveViewControl","schemaPath","modelPath","control","element","attr","generatePrimitiveEditControl","generateStandardPrimitivePropertyPair","mode","propContainer","label","append","title","text","error","generate","VIEW_MODE","$translate","getDateFromYYYYMMDD","year","substring","month","day","Date","getDateFromDMYYYY","test","s","parseInt","d","setDate","setMonth","setYear","formatterDMYYYY","date","isString","getDate","getMonth","getFullYear","formatterYYYYMMDD","ys","toString","ms","ds","conat","parserDMYYYY","isDate","getTime","nowToReverse","formatter","parser","undefined","formatterToBackend","getNameOfMonth","instant","$timeout","Dropdown","$element","options","extend","DEFAULTS","closeTimeout","closingTime","clsOpen","bodyClsOpen","allowClose","showDropdownAction","titleTransCode","getElement","getContentElement","$bodyEl","setInput","input","$inputElement","on","evt","keyCode","open","renderInit","$contentEl","initDropdownAtion","$contentInnerEl","$titleEl","getTitle","$closeEl","$actionEl","event","onCloseButton","addClass","hasClass","close","stopPropagation","preventDefault","setOptions","toggle","waiting","removeClass","afterClose","document","querySelector","classList","remove","afterOpen","add","cancelClosing","cancel","render","create","$http","idCounter","FileUploader","$scope","data","contentType","url","id","xhr","XMLHttpRequest","progress","upload","callback","that","addEventListener","lengthComputable","loaded","total","$emit","uploader","onreadystatechange","readyState","setRequestHeader","send","status","responseText","exports","$compile","componentGenerator","FormGenerator","MODE","VIEW","EDIT","VIEWEDIT","generateLabel","isRequired","required","fieldsetClass","transCode","generateValidations","field","unique","console","generateField","items","component","objectLink2","uploadableImage","width","height","style","generatePropertyRow","container","row1","readOnly","row2","row","generateForm","elm","p","localSchemaPath","localModelPath","localFragment","warn","properties","group","groupEnd","urlEncoder","schemaUtilFactory","$q","objectTools","bergerTable","teams","terms","n","floatTable","increment","atype","minmove","flipcolors","complement","j","temp","colorFlag","incr","nr","n2","max_round","test_r","outRounds","r","outRound","round","term","matches","match","home","visitors","boar","board","notPlaying","saveBerger","entity","saveSchema","encodeUri","saving","generated","map","toSave","baseData","homeClub","awayClub","matchRound","registry","oid","competition","competitionPart","matchDate","state","method","generateBerger","searchSchema","crits","f","v","op","sorts","o","success","listOfTeam","team","err","generateUserAccounting","info","accounting","generateClubAccounting","service","exportCsv","c","convertCriteria","searchCrit","idx","forcedCriterias","genericSearchFactory","getSearch","entityUri","lastCriteria","convertSortBy","sortBy","toHtml","blob","Blob","webkitURL","URL","link","createElementNS","href","createObjectURL","download","createEvent","initEvent","dispatchEvent","notificationFactory","save","skip","limit","concatUri","getSearchCount","parseSearchDef","collectProperties","pathPrefix","objectDef","resultArr","pr","datepicker","retval","attributes","operators","HttpHandler","activeDeffered","http","config","deffered","defer","reject","resolve","apply","arguments","notify","promise","newHandler","provider","Logger","loggingLevel","level","ERROR","WARN","INFO","DEBUG","TRACE","debug","trace","groupCollapsed","profile","profileEnd","time","timeEnd","loggerSingleton","setLevel","$get","sendMail","template","users","$location","navigationStack","top","navigate","context","splice","navigateToPath","restore","topItem","pop","back","last","clear","$rootScope","psuiNotification","message","defaultMessage","deletable","timeout","finalMessage","copy","translationCode","JSON","stringify","ObjectTools","getSchemaFragmentByObjectPath","propertiesFragment","dotPosition","indexOf","pathPropName","selectbox","dateUtil","$parse","Objectlink2","controller","call","generateElement","$item","renderElement","getDataset","getFieldsSchema","wrapperElement","fieldsSchema","refData","getFormatedValue","RemoveButton","backspace","del","enabled","onClear","show","hide","_handleKeyDown","_onClear","getSchemaList","getFileContent","pathContext","responseType","getPostContent","bytes","headers","Content-Type","getCompiledSchema","schemaUri","suffix","_schemaUri","cache","listBySchema","getFieldsSchemaFragment","fields","outFields","fieldProp","join","generateObjectFromSchema","_obj","forEach","fillObj","scopeToFill","values","assign","encode","decodeUri","decode","getLogin","user","password","login","selectProfile","profileId","getCurrentUser","getResetPassword","userId","getChangePassword","currentPassword","newPassword","getSecurityGroups","getForgotenToken","email","captcha","getForgotenPasswordReset","token","getCaptchaKey","getLogout","getSecurityPermissions","getSecurityProfiles","getSecuritySearchSchemas","getUserPermissions","updateUserSecurity","loginName","profiles","updateProfileSecurity","profileName","permissions","groups","updateSecurityGroup","groupName","groupId","parent","hasPermissions","requiredPermissions","security","currentUser","systemCredentials","datafactory","Selectbox","dataset","isRendered","$searchInput","_startPaging","selected","tab","enter","escape","space","pageup","pagedown","end","left","up","right","down","asterisk","useSearchInput","filterTimeout","showInfo","onSelected","closeOnBlur","pagingScrollBuffer","pagingItemsBuffer","freeTextMode","_bindInputEventHandlers","dropdown","keychar","getKeyChar","val","actionFilter","blur","focus","which","String","fromCharCode","charCode","getInput","setDataset","beforeLoad","dataSet","onBeforeLoad","newData","onLoaded","reset","onReset","setDropdown","renderTo","doReset","doLoad","$selectboxElement","$itemsElement","scrollTop","scrollLeft","unselectItem","loading","getData","selectItem","$el","doPaging","setRootElement","$rootElement","getRootElement","_bindEventHandlers","renderSearch","_handleScrollEvent","renderInfo","scrollHeight","offsetHeight","load","setInfoText","setInfoNumFromText","renderItems","setInfoNum","empty","$header","$footer","$infoTextElement","$infoElement","loadDone","offset","getOffset","item","k","$items","e","_handleMouseover","_handleClick","_handleFocus","_handleBlur","actionSelected","_fixScroller","selectedItem","itemsElement","offsetTop","bottomBorderSelectedItem","bottomBorderItemsEl","clientHeight","$selectedItem","children","__filterTimeout","setSearchValue","schemaUtil","httpHandlerFactory","DataSet","store","serachValue","ArrayStore","ObjectDataSet","ObjectLinkStore","HttpStoreTest","fieldsIndex","_fieldsSchemaFragment","_lables","getLimit","getSearchValue","setData","translateCode","getValueByKey","regExp","RegExp","slice","index","searchCondition","orderBySort","initFieldsSchema","getHttp","setForcedCriteria","setSchema","getHttpConfing","_orderByName","_searchVal","objectLink","outData","setFields","setScope","getFieldSchemaFragment","fieldName","getLabel","setTestData","count","randomString","chars","mask","Math","random","refdata","dataSetController","arrayStoreController","createArrayDataset","createObjectDataset","objectLink2ForcedCriteria","createTestDataset","itemLenght","getObjectLinkData","getStatisticsData","directive","restrict","attrs","ctrls","$eval","psuiOptions","psuiModel","$watch","nv","ov","$set","getTemplate","renderComponent","uploadablefileTemplate","objectLinkTemplate","ngModel","xpsuiSchema","isEmptyObj","html","xpsuiArrayControlEdit","contents","modelChanged","$watchCollection","removeByIndex","appendNew","xpsuiArrayControlView","generateArrayElements","itemsHolder","arrayItem","xpsuiModel","formGenerator","require","regenerateField","$observe","dropdownFactory","DEFAULT","setValue","isUndefined","setFocus","$focusElement","getValue","_bindHandlers","resetTabElemens","_handleActions","previousAction","nextAction","indexOfTabElements","getTabElements","$previousActionElement","$nextActionElement","$currentDayActionElement","currentDayAction","$headerActionElement","headerAction","doLayout","yearlyLayout","getFirstTabElement","setFullYear","monthlyLayout","dailyLayout","_renderInit","_controllsInit","$contentElement","$tabElements","querySelectorAll","$controllElement","$container","setHeaderText","tr","td","currentDate","selectedDate","whichDay","getDay","xpsuiDatapickerCtrl","xpsuiTextInputCtrl","$apply","$setViewValue","$render","$viewValue","$formatters","$parsers","msg","xpsuiConfirmClick","clickAction","xpsuiConfirmedClick","bind","confirm","$animate","pasteHtmlAtCaret","selectPastedContent","sel","range","getSelection","getRangeAt","rangeCount","deleteContents","el","createElement","innerHTML","node","lastNode","frag","createDocumentFragment","firstChild","appendChild","firstNode","insertNode","cloneRange","setStartAfter","setStartBefore","collapse","removeAllRanges","addRange","selection","originalRange","createRange","pasteHTML","setEndPoint","select","buttonsHolder","content","commitData","buttonLeft","buttonCenter","buttonRight","buttonJustify","buttonBold","buttonItalic","buttonRemoveFormat","buttonLink","buttonImage","buttonUndo","buttonRedo","buttonRemoveHeading","buttonH1","buttonH2","buttonH3","buttonOL","buttonUL","buttonOutdent","buttonIndent","buttonTable","execCommand","prompt","table","tbody","br","rowstext","colstext","rows","cols","outerHTML","buttonsHide","buttonsHideTimeout","ua","navigator","userAgent","msie","trident","htmlNodes","rangy","htmlElements","containsNode","getAllRanges","startContainer","parentElement","getAttribute","nodeName","htmlElements2","endContainer","getComputedStyle","getPropertyValue","isBold","isItalic","isH1","isH2","isH3","align","isOL","isUL","isTable","titleBar","createWidgetBlock","block","contentDiv","navigationService","$attrs","showRegistrations","showDataChanges","showTransfers","showRegistrationsSolver","showDataChangesSolver","showTransfersSolver","getCount","uri","onClick","label_noOpenRequests","blocks","label_loading","contentBlock1Elm","contentBlock2Elm","contentBlock3Elm","contentBlock1Title","contentBlock2Title","contentBlock3Title","block1","block2","block3","setup","$input","formControl","selfControl","oldValue","$modelValue","view","ngSrc","newVal","xpsuiDefaultSrc","xpsuiOptions","xpsuiFieldset","form","focusedElm","acquireFocus","releaseFocus","commit","rollback","calculation","unregister","registerCalculation","$on","calculator","model","calculate","modelValue","modelGetter","onlyEmpty","property","formModel","formModelGetter","newValue","formCtrl","xpsui","submitPrepare","prepareForSubmit","xpsuiForm","clientActions","contentActionsHolder","actionIndex","actionElm","action","__DIRECTIVE__","schemaFrom","generateBy","moveImg","clientX","clientY","numberOfRot","difX","x","difY","y","draw","context2","getVector","vec","vectorLength","vec1","vec2","abs","sqrt","wrapper","pomer","tmp","originImgWidth","originImgHeight","imgCtrl","resultImgWidth","psuiWidth","resultImgHeight","psuiHeight","imgWidth","imgHeight","resize","innerWidth","resizeRatio","modalEl","modalContentWrapperEl","modalWidth","css","labelTranslated","modalHeader","modalContentEl","canvasContainer","resizorCanvas","canvasResult","buttonRotate","buttonOk","buttonClose","getContext","translate","img","Image","ctx","ctx2","fillStyle","fillRect","rotate","PI","drawImage","onload","srcElm","toBlob","imageProcessed","parts","toDataURL","binStr","atob","buf","ArrayBuffer","Uint8Array","charCodeAt","wheelDelta","detail","zoomTouch","targetTouches","currentZoomTouch","setCommitButton","button","comitButton","showCommitButton","hideCommitButton","enterEditMode","viewElm","editElm","buttonsElm","triggerHandler","off","viewModeClickHandler","constructor","enterViewMode","selfCtrl","xpsuiInlineedit","contentElm","commitButton","rollbackButton","commitClickHandler","rollbackClickHandler","one","submenu","$this","toggleClass","links","$open","setElement","target","selectboxFactory","inputWrapper","addButton","xButton","stringElm","trim","newNames","oldNames","translationData","buttonDelete","searchedMsg","messageHide","z","objectlink2Factory","dataFactory","removeButtonFactory","removeButton","parseSchemaFragment","equals","xpsuiuriescape","moveUp","parsedModel","array","$broadcast","moveDown","meta","cssClass","elementIdx","subElements","removeParent","$parent","removeFn","upInParent","curr","downInParent","opened","header","openIcon","actionButtons","editButton","downButton","upButton","editPanel","addNew","upFn","downFn","name","tags","$route","renderMenuEntry","menuEntry","counter","menuHash","subMenu","loadingDiv","$sce","findFirstOfType","page","numberPerPage","pageSize","prevPage","refreshPage","nextPage","totalPages","ceil","modelAll","iterateFrom","iterateTo","makeSafe","str","trustAsHtml","abstract","img1170","video","aid","files","photoLeft","photoRight","photoRemove","images","viewer","viewerVisible","visibleIndex","newWindow","contentInner","$interval","marginLeft","moveLeft","moveRight","article","src","subTitle","$injector","navS","schemaParser","modelParser","modelFragment","invoke","$interpolate","navPath","params","enumTransCodes","isNaN","QueryFilter","latestId","controllers","xpsuiUnique","containEqualId","ngModelStr","pos","lastIndexOf","ver","$setValidity","qf","addCriterium","operation","EQUAL","setLimit","conf","getContentType","fileName","ext","contentTypes","toLowerCase",".pdf",".xls",".doc",".docx",".ppt",".odt",".bin",".bmp",".jpg",".jpeg",".png",".csv",".zip","psFileUploadFactory","getReadableFileSizeString","fileSizeInBytes","byteUnits","max","toFixed","fileButton","chooseFileButton","click","file","urlObject","fileId","find","inlineEditCtrl","validationMark","prepend","errors","$invalid","$pristine","$error","ngVal","isObject","getOwnPropertyNames","greeting","$routeParams","SchemaUtilFactory","massmailingFactory","searchBy","direction","crit","attribute","operator","peopleSchemaUri","selectedTemplate","textTemplate","htmlTemplate","searchDef","selectAll","addCrit","listFields","removeCrit","templates","parse","dataSize","recipientCount","setSortBy","searchNext","newItems","userIds","dateUtils","desc","icon","isIndex","isMenu","parentMenu","publishFrom","location","news","photo","riderszone","matchResults","image","image1170","fileList","category","overview","ranking","gallery","showcase","showcasevideo","viewTemplate","getViewTemplate","edit","findSurrogateTitle","pageBlocks","lastModTimestamp","surrogateTitle","reload","showBlockSelector","blockSelectorShown","hideBlockSelector","selectBlock","hoverShowDesc","hoverCloseWhite","color","hoverCloseBlack","ASC","DESC","currSort","order","newCrit","searchCrits","isSearching","changeSort","newField","filterFn","val1","val2","editArticle","articleId","addNewCrit","dateToUI","emptyMenu","hash","generator","toXlsHtml","tableHtml","retVal","fillClubLogos","position","rosterId","roster","fillForClub","club","clubOid","logoInfo","progess","exportTable","getElementById","idFrom","currentSchemaUri","copyFields","transferData","dataProfiles","statusProfiles","headersProfiles","configProfiles","defaultProfile","contactInfo","accountName","schemaFormOptions","newForm","filler","httpFactory","fetchData","fieldDef","findFieldDefinition","fragment","oids","addField","addSort","setSkip","currPage","httpHandler","moreData","flattenData","flattenSchema","propertyName","propertyTitle","localPath","dataRow","objectPathToSchemaPath","objPath","fieldWeigth","isExporting","allOps","filterKeyPressed","setTimeout","htmlData","li","lisDef","sep","setSearch","next","fieldPath","schemaFields","code","currentSchema","currentId","fieldError","schemas","schemaList","schemaService","aceConfig","useWrapMode","showGutter","theme","onLoad","_editor","setReadOnly","getSession","setMode","ace","set","postData","alert","SecurityService","$window","reCAPTCHA","capcha","done","json","destroy","setPublicKey","mes","submit","challenge","response","Recaptcha","fillGroupPerm","perms","groupper","selectedGroup","arr","addPermission","removePermission","updateGroupPermissions","selectGroup","selectedProfile","resetPassword","logout","newPasswordCheck","changePassword","securityService","mapOperator","mapAttribute","att","object","convertProfileCriteria","expr","fillProfilePerm","per","fillProfileGroups","ug","profilegroup","profileList","profileCrit","editCrit","critTempAtt","critTempOper","oper","critTempVal","addProfileCrit","removeProfileCrit","schemaChange","attDef","searchSchemas","addGroup","removeGroup","forcedCriteria","schemaCrit","modelCrit","applySchema","fieldKeyDown","$event","fillUserProfiles","convertProfiles","userList","selectedUser","addProfile","removeProfile","selectUser","StatisticsServiceFactory","filter","startsWith"],"mappings":"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","sourcesContent":["(function(angular) {\n\t'use strict';\n\n\tangular.module('xpsui:services', []);\n}(angular));\n","(function(angular) {\n\t'use strict';\n\n\t/**\n\t * Easy object access using dot notation\n\t *\n\t * TODO: Move this to some utils module\n\t *\n\t * @param obj\n\t * @param key\n\t * @param def\n\t * @returns {*}\n\t */\n\tfunction dotAccess(obj, key, def) {\n\t\tkey = Array.isArray(key) ? key : key.split('.');\n\t\tfor (var i = 0, l = key.length; i < l; i++) {\n\t\t\tvar part = key[i];\n\t\t\tif (!(part in obj)) return def;\n\t\t\tobj = obj[part];\n\t\t}\n\t\treturn obj;\n\t}\n\n\tangular.module('xpsui:services')\n\t\t.factory('xpsui:Calculator:ComputationRegistry', [ '$q', function(q) {\n\n\t\t\t// TODO: Move this to the shared and import it here with require()\n\t\t\t// This will be exported as shared library for the server and browser\n\t\t\t// when the browserify will work\n\t\t\treturn \t{\n\n\t\t\t\t/**\n\t\t\t\t * Default noop function\n\t\t\t\t *\n\t\t\t\t * @param {*} args\n\t\t\t\t * @returns {*}\n\t\t\t\t */\n\t\t\t\tnoop: function(args) { return args; },\n\n\t\t\t\t/**\n\t\t\t\t * Concat all values from args - keys are sorted, before concatenation\n\t\t\t\t *\n\t\t\t\t * @param {object|array} args\n\t\t\t\t * @returns {string}\n\t\t\t\t */\n\t\t\t\tconcat: function(args) {\n\t\t\t\t\tvar keys = Object.keys(args).sort(),\n\t\t\t\t\t\tresult = '';\n\t\t\t\t\tfor (var i = 0; i < keys.length; i++) {\n\t\t\t\t\t\tresult = result.concat(args[keys[i]])\n\t\t\t\t\t}\n\t\t\t\t\treturn result;\n\t\t\t\t},\n\n\t\t\t\t/**\n\t\t\t\t * Get value from the scope object\n\t\t\t\t *\n\t\t\t\t * @param {object|array} args Args must be an object with \"path\" property\n\t\t\t\t * @param {object} scope\n\t\t\t\t * @param {*} def\n\t\t\t\t * @returns {*}\n\t\t\t\t */\n\t\t\t\t'get': function(args, scope, def) {\n\t\t\t\t\tvar keys = Object.keys(args).sort();\n\t\t\t\t\tvar path = args[keys[0]];\n\n\t\t\t\t\treturn dotAccess(scope, path, def);\n\t\t\t\t},\n\n\t\t\t\t/**\n\t\t\t\t * Returns a substring of the first argument, with start as second argument and\n\t\t\t\t * optional length as third argument\n\t\t\t\t *\n\t\t\t\t * @param {object|array} args\n\t\t\t\t * @returns {string}\n\t\t\t\t */\n\t\t\t\tsubstr: function(args) {\n\t\t\t\t\tvar keys = Object.keys(args).sort();\n\n\t\t\t\t\tvar string = args[keys[0]],\n\t\t\t\t\t\tstart = args[keys[1]],\n\t\t\t\t\t\tlength;\n\n\t\t\t\t\tif (keys[2]) {\n\t\t\t\t\t\tlength = args[keys[2]];\n\t\t\t\t\t}\n\n\t\t\t\t\treturn string.substr(start, length);\n\t\t\t\t},\n\n\t\t\t\t/**\n\t\t\t\t * Returns a result of the first argument modulo second argument\n\t\t\t\t *\n\t\t\t\t * @param {object|array} args\n\t\t\t\t * @returns {number}\n\t\t\t\t */\n\t\t\t\tmod: function(args) {\n\t\t\t\t\tvar keys = Object.keys(args).sort();\n\t\t\t\t\tvar first = args[keys[0]],\n\t\t\t\t\t\tsecond = args[keys[1]];\n\n\t\t\t\t\treturn first % second;\n\t\t\t\t},\n\n\t\t\t\t/**\n\t\t\t\t * Returns a string of the first argument, where search as second argument\n\t\t\t\t * is replaced by value as third argument\n\t\t\t\t *\n\t\t\t\t * @param {object|array} args\n\t\t\t\t * @returns {string}\n\t\t\t\t */\n\t\t\t\treplace: function(args) {\n\t\t\t\t\tvar keys = Object.keys(args).sort();\n\n\t\t\t\t\tvar string = args[keys[0]],\n\t\t\t\t\t\tsearch = args[keys[1]],\n\t\t\t\t\t\tvalue = args[keys[2]];\n\n\t\t\t\t\treturn string.replace(search, value);\n\t\t\t\t},\n\n\t\t\t\t/**\n\t\t\t\t * Returns a second argument when conditional as first argument is true else\n\t\t\t\t * third argument is returned\n\t\t\t\t *\n\t\t\t\t * @param {object|array} args\n\t\t\t\t * @returns {*}\n\t\t\t\t */\n\t\t\t\t'if': function(args) {\n\t\t\t\t\tvar keys = Object.keys(args).sort();\n\n\t\t\t\t\tvar condition = args[keys[0]],\n\t\t\t\t\t\tfirst = args[keys[1]],\n\t\t\t\t\t\tsecond = args[keys[2]];\n\n\t\t\t\t\treturn condition ? first : second;\n\t\t\t\t},\n\n\t\t\t\t/**\n\t\t\t\t * Returns a length of the first argument\n\t\t\t\t *\n\t\t\t\t * @param {object|array} args\n\t\t\t\t * @returns {number}\n\t\t\t\t */\n\t\t\t\tlength: function(args) {\n\t\t\t\t\tvar keys = Object.keys(args).sort();\n\n\t\t\t\t\tvar first = args[keys[0]];\n\n\t\t\t\t\treturn first.length;\n\t\t\t\t},\n\n\t\t\t\t/**\n\t\t\t\t * Returns true when first argument is equal to the second argument\n\t\t\t\t *\n\t\t\t\t * @param {object|array} args\n\t\t\t\t * @returns {boolean}\n\t\t\t\t */\n\t\t\t\teq: function(args) {\n\t\t\t\t\tvar keys = Object.keys(args).sort();\n\n\t\t\t\t\tvar first = args[keys[0]],\n\t\t\t\t\t\tsecond = args[keys[1]];\n\n\t\t\t\t\treturn first == second;\n\t\t\t\t},\n\n\t\t\t\t/**\n\t\t\t\t * Returns true when first argument is greater then second argument\n\t\t\t\t *\n\t\t\t\t * @param {object|array} args\n\t\t\t\t * @returns {boolean}\n\t\t\t\t */\n\t\t\t\tgt: function(args) {\n\t\t\t\t\tvar keys = Object.keys(args).sort();\n\n\t\t\t\t\tvar first = args[keys[0]],\n\t\t\t\t\t\tsecond = args[keys[1]];\n\n\t\t\t\t\treturn first > second;\n\t\t\t\t},\n\n\t\t\t\t/**\n\t\t\t\t * Returns true when first argument is greater or equal to the second argument\n\t\t\t\t *\n\t\t\t\t * @param {object|array} args\n\t\t\t\t * @returns {boolean}\n\t\t\t\t */\n\t\t\t\tgte: function(args) {\n\t\t\t\t\tvar keys = Object.keys(args).sort();\n\n\t\t\t\t\tvar first = args[keys[0]],\n\t\t\t\t\t\tsecond = args[keys[1]];\n\n\t\t\t\t\treturn first >= second;\n\t\t\t\t},\n\n\t\t\t\t/**\n\t\t\t\t * Returns true when first argument is less then second argument\n\t\t\t\t *\n\t\t\t\t * @param {object|array} args\n\t\t\t\t * @returns {boolean}\n\t\t\t\t */\n\t\t\t\tlt: function(args) {\n\t\t\t\t\tvar keys = Object.keys(args).sort();\n\n\t\t\t\t\tvar first = args[keys[0]],\n\t\t\t\t\t\tsecond = args[keys[1]];\n\n\t\t\t\t\treturn first < second;\n\t\t\t\t},\n\n\t\t\t\t/**\n\t\t\t\t * Returns true when first argument is less or equal to the second argument\n\t\t\t\t *\n\t\t\t\t * @param {object|array} args\n\t\t\t\t * @returns {boolean}\n\t\t\t\t */\n\t\t\t\tlte: function(args) {\n\t\t\t\t\tvar keys = Object.keys(args).sort();\n\n\t\t\t\t\tvar first = args[keys[0]],\n\t\t\t\t\t\tsecond = args[keys[1]];\n\n\t\t\t\t\treturn first <= second;\n\t\t\t\t},\n\n\t\t\t\t/**\n\t\t\t\t * Returns true when first argument and the second argument are true\n\t\t\t\t *\n\t\t\t\t * @param {object|array} args\n\t\t\t\t * @returns {boolean}\n\t\t\t\t */\n\t\t\t\tand: function(args) {\n\t\t\t\t\tvar keys = Object.keys(args).sort();\n\n\t\t\t\t\tvar first = args[keys[0]],\n\t\t\t\t\t\tsecond = args[keys[1]];\n\n\t\t\t\t\treturn first && second;\n\t\t\t\t},\n\n\t\t\t\t/**\n\t\t\t\t * Returns true when first argument or the second argument are true\n\t\t\t\t *\n\t\t\t\t * @param {object|array} args\n\t\t\t\t * @returns {boolean}\n\t\t\t\t */\n\t\t\t\tor: function(args) {\n\t\t\t\t\tvar keys = Object.keys(args).sort();\n\n\t\t\t\t\tvar first = args[keys[0]],\n\t\t\t\t\t\tsecond = args[keys[1]];\n\n\t\t\t\t\treturn first || second;\n\t\t\t\t},\n\n\t\t\t\t/**\n\t\t\t\t * Returns string as first argument padded to size as second argument with\n\t\t\t\t * values as third argument\n\t\t\t\t *\n\t\t\t\t * @param {object|array} args\n\t\t\t\t * @returns {string}\n\t\t\t\t */\n\t\t\t\tpad: function(args) {\n\t\t\t\t\tvar keys = Object.keys(args).sort();\n\n\t\t\t\t\tvar string = args[keys[0]] + \"\", // Convert to string\n\t\t\t\t\t\tsize = args[keys[1]],\n\t\t\t\t\t\tfill = '0';\n\n\t\t\t\t\tif (keys[2]) {\n\t\t\t\t\t\tfill = args[keys[2]];\n\t\t\t\t\t}\n\n\t\t\t\t\twhile (string.length < size) {\n\t\t\t\t\t\tstring = fill + string;\n\t\t\t\t\t}\n\n\t\t\t\t\treturn string;\n\t\t\t\t}\n\t\t\t};\n\n\t\t}])\n\n\t\t.factory('xpsui:Calculator:ComputedProperty', [ '$q', 'xpsui:Calculator:ComputationRegistry', function(q, computationRegistry) {\n\n\t\t\t// TODO: Move this to the shared and import it here with require()\n\n\t\t\t/**\n\t\t\t * Constructor for the ComputedProperty\n\t\t\t *\n\t\t\t * ```js\n\t\t\t\t{\n\t\t\t\t\t\"onlyEmpty\": false,                   // If true - modify model only if the current model value is undefined or \"\"\n\t\t\t\t\t\"func\": \"concat\",                     // Function from \"xpsui:Calculator:ComputationRegistry\",\n\t\t\t\t\t\"args\": {                             // {array|object} - based on the requirements of the function from ComputationRegistry\n\t\t\t\t\t\t1: \"Ing.\",                        // Arguments can be strings\n\t\t\t\t\t\t\t2: {                          // or another computation\n\t\t\t\t\t\t\t\t\"func\": \"get\",\n\t\t\t\t\t\t\t\t\"args\": {\n\t\t\t\t\t\t\t\t\"path\": \"baseData.name\"\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t * ```\n\t\t\t * @param schema\n\t\t\t * @constructor\n\t\t\t */\n\t\t\tfunction ComputedProperty(schema) {\n\t\t\t\tthis.schema = schema;\n\t\t\t}\n\n\t\t\t/**\n\t\t\t * Getter function\n\t\t\t *\n\t\t\t * @param scope\n\t\t\t * @returns {*}\n\t\t\t */\n\t\t\tComputedProperty.prototype.getter = function(scope) {\n\t\t\t\tvar computationFunc = computationRegistry[this.schema.func] || computationRegistry.noop;\n\n\t\t\t\t// Check arguments\n\t\t\t\tvar args = {},\n\t\t\t\t\tself = this;\n\n\t\t\t\tfor (var argName in this.schema.args) {\n\t\t\t\t\tif (!this.schema.args.hasOwnProperty(argName)) {\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\n\t\t\t\t\tvar arg = this.schema.args[argName];\n\n\t\t\t\t\tif (typeof arg === 'object') {\n\t\t\t\t\t\tvar argProperty = new ComputedProperty(arg);\n\t\t\t\t\t\targs[argName] = argProperty.getter(scope);\n\t\t\t\t\t} else {\n\t\t\t\t\t\targs[argName] = arg; //q.when(arg);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\treturn q.all(args).then(function(results) {\n\t\t\t\t\treturn computationFunc(results, scope, self.schema.def);\n\t\t\t\t});\n\t\t\t};\n\n\t\t\tComputedProperty.prototype.watcher = function(scope) {\n\t\t\t\tvar self = this;\n\n\t\t\t\tfunction collect(subschema) {\n\t\t\t\t\tvar result = [];\n\t\t\t\t\tfor (var argName in subschema.args) {\n\t\t\t\t\t\tif (!subschema.args.hasOwnProperty(argName)) {\n\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tvar arg = subschema.args[argName];\n\t\t\t\t\t\t// Ignore scalar arguments and arguments without watch property set to 'true'\n\t\t\t\t\t\tif (typeof arg !== 'object') {\n\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (arg.func === 'get') {\n\t\t\t\t\t\t\t// Only if watch === true\n\t\t\t\t\t\t\tif (arg.watch === true) {\n\t\t\t\t\t\t\t\tresult.push(dotAccess(scope, arg.args.path, arg.def));\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else if (arg.args) {\n\t\t\t\t\t\t\tresult = result.concat(collect(arg));\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\treturn result;\n\t\t\t\t}\n\n\t\t\t\treturn function() {\n\t\t\t\t\treturn collect(self.schema);\n\t\t\t\t}\n\t\t\t};\n\n\t\t\treturn ComputedProperty;\n\n\t\t}])\n\n\t\t.factory('xpsui:Calculator', ['xpsui:Calculator:ComputedProperty', function(ComputedProperty) {\n\t\t\treturn {\n\t\t\t\t/**\n\t\t\t\t * Create new instance of the ComputedProperty\n\t\t\t\t *\n\t\t\t\t * @param {object} schema\n\t\t\t\t * @returns {ComputedProperty}\n\t\t\t\t */\n\t\t\t\tcreateProperty: function(schema) {\n\t\t\t\t\treturn new ComputedProperty(schema);\n\t\t\t\t}\n\t\t\t}\n\t\t}]);\n\n}(window.angular));\n","(function(angular) {\n\t'use strict';\n\n\tangular.module('xpsui:services')\n\t.factory('xpsui:ComponentGenerator', ['xpsui:logging', function(log) {\n\t\tvar EDIT_MODE = 'EDIT_MODE';\n\t\tvar VIEW_MODE = 'VIEW_MODE';\n\t\tvar EDITVIEW_MODE = 'EDITVIEW_MODE';\n\n\t\tfunction isPrimitiveProperty(schemaFragment) {\n\t\t\tif (schemaFragment.type && (schemaFragment.type === 'string' || schemaFragment.type === 'number')) {\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\treturn false;\n\t\t}\n\n\t\tfunction generatePrimitiveViewControl(schemaFragment, schemaPath, modelPath) {\n\t\t\tvar control = angular.element('<div xpsui-string-view></div>');\n\t\t\tcontrol.attr('ng-model', modelPath);\n\n\t\t\treturn control;\n\t\t}\n\n\t\t// @todo add datapicker\n\t\tfunction generatePrimitiveEditControl(schemaFragment, schemaPath, modelPath) {\n\t\t\tvar control = angular.element('<div xpsui-string-edit></div>');\n\t\t\tcontrol.attr('ng-model', modelPath);\n\n\t\t\treturn control;\n\t\t}\n\n\t\tfunction generateStandardPrimitivePropertyPair(schemaFragment, schemaPath, modelPath, mode) {\n\t\t\tvar propContainer = angular.element('<div class=\"x-standard-prop-pair\"></div>');\n\t\t\tvar label = angular.element('<div class=\"x-label\"></div>');\n\n\t\t\tpropContainer.append(label);\n\t\t\tif (schemaFragment && schemaFragment.title) {\n\t\t\t\tlabel.text(schemaFragment.title);\n\t\t\t}\n\n\t\t\tvar control;\n\t\t\tif (mode === 'EDIT_MODE') {\n\t\t\t\tcontrol = generatePrimitiveEditControl(schemaFragment, schemaPath, modelPath);\n\t\t\t} else if (mode === 'VIEW_MODE') {\n\t\t\t\tcontrol = generatePrimitiveViewControl(schemaFragment, schemaPath, modelPath);\n\t\t\t} else if (mode === 'EDITVIEW_MODE') {\n\t\t\t} else {\n\t\t\t\tlog.error('Unknown mode');\n\t\t\t\treturn null;\n\t\t\t}\n\t\t\tpropContainer.append(control);\n\t\t\treturn propContainer;\n\t\t}\n\n\t\tfunction generate(schemaFragment, schemaPath, modelPath, mode) {\n\t\t\t/*\n\t\t\t * Known modes EDIT, VIEW, EDITVIEW\n\t\t\t */\n\t\t\tvar result;\n\t\t\tif (!schemaFragment) {\n\t\t\t\tlog.error('No schemaFragment provided, cannot generate component');\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// identify base component to use\n\t\t\tif (schemaFragment.type && schemaFragment.type === 'array') {\n\t\t\t\tresult = angular.element('<xpsui-array></xpsui-array>');\n\t\t\t\tresult.attr('xpsui-schema', schemaPath);\n\t\t\t\tresult.attr('xpsui-model', modelPath);\n\n\t\t\t\treturn result;\n\t\t\t} else if (isPrimitiveProperty(schemaFragment)) {\n\t\t\t\treturn generateStandardPrimitivePropertyPair(schemaFragment, schemaPath, modelPath, mode || VIEW_MODE);\n\t\t\t} else {\n\t\t\t\tresult = angular.element('<div xpsui-fieldset></div>');\n\t\t\t\tresult.attr('xpsui-schema', schemaPath);\n\t\t\t\tresult.attr('xpsui-model', modelPath);\n\n\t\t\t\treturn result;\n\t\t\t}\n\n\t\t\tif (schemaFragment.transient) {\n\t\t\t\tlog.debug('transient');\n\t\t\t\tresult.attr('xpsui-model', modelPath);\n\t\t\t} else {\n\t\t\t\tlog.debug('not transient, setting ng-model to \"%s\"', modelPath);\n\t\t\t\tresult.attr('ng-model', modelPath);\n\t\t\t}\n\n\t\t\tif (schemaFragment.readOnly) {\n\t\t\t\tlog.debug('readOnly, setting xpsui-text-view');\n\t\t\t\tresult.attr('xpsui-text-view', '');\n\t\t\t} else {\n\t\t\t\tlog.debug('not readOnly, setting xpsui-text-input');\n\t\t\t\tresult.attr('xpsui-text-input', '');\n\t\t\t}\n\n\t\t\tif (schemaPath) {\n\t\t\t\tlog.debug('schemaPath is defined, setting xpsui-options to \"%s\"', schemaPath);\n\t\t\t\tresult.attr('xpsui-options', schemaPath);\n\t\t\t}\n\n\t\t\treturn result;\n\t\t}\n\n\t\treturn {\n\t\t\tgenerate: generate\n\t\t};\n\t}]);\n\n}(window.angular));\n","(function(angular) {\n\t'use strict';\n\n\tangular.module('xpsui:services')\n\t.factory('xpsui:DateUtil',['xpsui:logging', '$translate', function(log, $translate) {\n\t\t\n\t\tfunction getDateFromYYYYMMDD(value){\n\t\t\tvar year = value.substring(0,4),\n\t\t\t\tmonth = value.substring(4,6),\n\t\t\t\tday = value.substring(6,8)\n\t\t\t;\n\t\t\t\n\t\t\tif (year.length === 4 && month.length === 2 && day.length === 2) {\n\t\t\t\treturn new Date(year, month-1, day);\n\t\t\t}\n\t\t\treturn null;\n\t\t}\n\t\t\n\t\tfunction getDateFromDMYYYY(value){\n\t\t\tif (/^[0-9]{1,2}\\.[0-9]{1,2}\\.[1-9][0-9][0-9][0-9]$/.test(value)) {\n\t\t\t\tvar s = value.split('.');\n\t\t\t\tvar day = parseInt(s[0]);\n\t\t\t\tvar month = parseInt(s[1]);\n\t\t\t\tvar year = parseInt(s[2]);\n\n\t\t\t\tif ((day > 0 && day < 32) &&\n\t\t\t\t\t(month > 0 && month <13) &&\n\t\t\t\t\t(year > 0 && year < 10000)\n\t\t\t\t) {\n\t\t\t\t\tvar d = new Date();\n\t\t\t\t\td.setDate(day);\n\t\t\t\t\td.setMonth(month -1);\n\t\t\t\t\td.setYear(year);\n\t\t\t\t\treturn d;\n\t\t\t\t}\n\t\t\t}\t\n\t\t\treturn null;\n\t\t}\n\t\t\n\t\t\n\t\tfunction formatterDMYYYY(date){\n\t\t\tif (angular.isString(date) ){\n\t\t\t\tdate = getDateFromYYYYMMDD(date);\n\t\t\t}\n\t\t\t\n\t\t\tif (date instanceof Date) {\n\t\t\t\treturn date.getDate() + '.' + (date.getMonth()+1) + '.' + date.getFullYear();\n\t\t\t}\n\t\t\t\n\t\t\treturn null;\n\t\t}\n\t\t\n\t\tfunction formatterYYYYMMDD(date) {\n\t\t\tif (date instanceof Date) {\n\t\t\t\tvar ys = date.getFullYear().toString(10);\n\n\t\t\t\tvar ms = (date.getMonth() + 1).toString(10);\n\t\t\t\tif (ms.length < 2) {\n\t\t\t\t\tms = '0'.concat(ms);\n\t\t\t\t}\n\n\t\t\t\tvar ds = date.getDate().toString();\n\t\t\t\tif (ds.length < 2) {\n\t\t\t\t\tds = '0'.concat(ds);\n\t\t\t\t}\n\n\t\t\t\treturn ds.conat('.',ms,'.',ys);\n\t\t\t}\n\t\t\t\n\t\t\treturn null;\n\t\t}\n\n\t\tfunction parserDMYYYY(value){\n\t\t\tvar date;\n\t\t\t\n\t\t\tif (angular.isDate(value)) {\n\t\t\t\tdate = new Date(value.getTime()) ;\n\t\t\t} else {\n\t\t\t\tdate = getDateFromDMYYYY(value);\n\t\t\t}\n\t\t\t\n\t\t\tif (angular.isDate(date)) {\n\t\t\t\tvar ys = date.getFullYear().toString(10);\n\t\t\t\tvar ms = (date.getMonth() + 1).toString(10);\n\t\t\t\tif (ms.length < 2) {\n\t\t\t\t\tms = '0'.concat(ms);\n\t\t\t\t}\n\t\t\t\tvar ds = date.getDate().toString();\n\t\t\t\tif (ds.length < 2) {\n\t\t\t\t\tds = '0'.concat(ds);\n\t\t\t\t}\n\n\t\t\t\treturn ys.concat(ms, ds);\n\t\t\t}\n\t\t\t\n\t\t\treturn null;\n\t\t}\n\n\t\tfunction nowToReverse() {\n\t\t\treturn parserDMYYYY(new Date());\n\t\t};\n\n\t\treturn {\n\t\t\tgetDateFromYYYYMMDD: getDateFromYYYYMMDD, \n\t\t\tnowToReverse: function () {\n\t\t\t\treturn nowToReverse();\n\t\t\t},\n\t\t\tformatter:function(value) {\n\t\t\t\tif (value) {\n\t\t\t\t\tvar string = formatterDMYYYY(value);\n\t\t\t\t\tif(string){\n\t\t\t\t\t\treturn string;\n\t\t\t\t\t}\n\n\t\t\t\t\treturn value;\n\t\t\t\t}\n\t\t\t\treturn '';\n\t\t\t},\n\t\t\t\t\t\t\n\t\t\tparser: function(value) {\n\t\t\t\tif (value) {\n\t\t\t\t\tvar string = parserDMYYYY(value);\n\t\t\t\t\tif(string){\n\t\t\t\t\t\treturn string;\n\t\t\t\t\t}\n\t\t\t\t\t// invalid\n\t\t\t\t\treturn undefined;\n\t\t\t\t}\n\t\t\t},\n\t\t\t\n\t\t\tformatterToBackend: function(value) {\n\t\t\t\tif (value) {\n\t\t\t\t\tvar string = formatterYYYYMMDD(value);\n\t\t\t\t\tif(string){\n\t\t\t\t\t\treturn string;\n\t\t\t\t\t}\n\n\t\t\t\t\treturn value;\n\t\t\t\t}\n\t\t\t\treturn '';\n\t\t\t},\n\n\t\t\tgetNameOfMonth: function(month){\n\t\t\t\tif (month == 0){\n\t\t\t\t\treturn $translate.instant('date.jan');\n\t\t\t\t}else if (month == 1){\n\t\t\t\t\treturn $translate.instant('date.feb');\n\t\t\t\t}else if (month == 2){\n\t\t\t\t\treturn $translate.instant('date.mar');\n\t\t\t\t}else if (month == 3){\n\t\t\t\t\treturn $translate.instant('date.apr');\n\t\t\t\t}else if (month == 4){\n\t\t\t\t\treturn $translate.instant('date.may');\n\t\t\t\t}else if (month == 5){\n\t\t\t\t\treturn $translate.instant('date.jun');\n\t\t\t\t}else if (month == 6){\n\t\t\t\t\treturn $translate.instant('date.jul');\n\t\t\t\t}else if (month == 7){\n\t\t\t\t\treturn $translate.instant('date.aug');\t\n\t\t\t\t}else if (month == 8){\n\t\t\t\t\treturn $translate.instant('date.sep');\n\t\t\t\t}else if (month == 9){\n\t\t\t\t\treturn $translate.instant('date.oct');\n\t\t\t\t}else if (month == 10){\n\t\t\t\t\treturn $translate.instant('date.nov');\n\t\t\t\t}else if (month == 11){\n\t\t\t\t\treturn $translate.instant('date.dec');\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t}]);\n\n}(window.angular));","(function(angular) {\n\t'use strict';\n\n\tangular.module('xpsui:services')\n\t.factory('xpsui:DropdownFactory', ['xpsui:logging', '$timeout', '$translate',  function(log, $timeout, $translate) {\t\n\t\tfunction Dropdown($element,options){\n\t\t\tthis.$element = $element;\n\t\t\t\n\t\t\t//this.options = Dropdown.DEFAULTS;\n\t\t\tthis.options = angular.extend({}, Dropdown.DEFAULTS, options || {} );\n\t\t\t\n\t\t\tthis.closeTimeout = null;\n\t\t};\n\t\t\n\t\tDropdown.DEFAULTS = {\n\t\t\tclosingTime: 150,\n\t\t\tclsOpen: 'x-open',\n\t\t\tbodyClsOpen: 'x-dropdown-open-sm',\n\t\t\tallowClose: true,\n\t\t\tshowDropdownAction: true,\n\t\t\ttitleTransCode: null\n\t\t};\n\t\t\n\t\tDropdown.prototype.getElement =  function(){\n\t\t\treturn this.$element;\n\t\t};\n\t\t\n\t\tDropdown.prototype.getContentElement =  function(){\n\t\t\treturn this.$bodyEl;\n\t\t};\n\t\t\n\t\tDropdown.prototype.setInput = function(input){\n\t\t\tvar self = this;\n\t\t\tthis.$inputElement = input;\n\t\t\t\n\t\t\tthis.$inputElement.on('keydown', function(evt) {\n\t\t\t\tswitch (evt.keyCode) {\n\t\t\t\t\tcase 40: // key down\n\t\t\t\t\tcase 13: // key enter\n\t\t\t\t\t\tself.open();\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t});\n\n\t\t\treturn this;\n\t\t};\n\t\t\n\t\tDropdown.prototype.renderInit = function(){\n\t\t\tvar self = this;\n\t\t\tif(!this.$contentEl){\n\t\t\t\t// showDropdownAction\n\t\t\t\t//this.$actionEl = angular.element('<div class=\"x-dropdown-action\"><span>' + $translate.instant('Dropdown.toggle') + '</span></div>');\n\t\t\t\tthis.initDropdownAtion();\n\t\t\t\tthis.$contentEl = angular.element('<div class=\"x-dropdown-content\"></div>');\n\n\t\t\t\tthis.$contentInnerEl = angular.element('<div class=\"x-dropdown-content-inner\"></div>');\n\t\t\t\tthis.$contentEl.append(this.$contentInnerEl);\n\n\t\t\t\tthis.$titleEl = angular.element('<div class=\"x-dropdown-header\">' + this.getTitle() + '</div>');\n\t\t\t\tthis.$contentInnerEl.append(this.$titleEl);\n\t\t\t\tthis.$closeEl = angular.element('<a href=\"#\" class=\"x-dropdown-close\"></a>');\n\t\t\t\tthis.$contentInnerEl.append(this.$closeEl);\n\n\t\t\t\tthis.$bodyEl = angular.element('<div class=\"x-dropdown-body\"></div>');\n\t\t\t\tthis.$contentInnerEl.append(this.$bodyEl);\n\n\t\t\t\tthis.$element.append(this.$actionEl);\n\t\t\t\tthis.$element.append(this.$contentEl);\n\t\t\t\t\n\t\t\t\tthis.$closeEl.on('click', function(event){\n\t\t\t\t\tself.onCloseButton(event);\n\t\t\t\t});\n\t\t\t}\n\t\t};\n\n\t\tDropdown.prototype.initDropdownAtion = function(){\n\t\t\tvar self = this;\n\t\t\tif(this.options.showDropdownAction){\n\t\t\t\tthis.$actionEl = angular.element('<div class=\"x-dropdown-action\"><span>' + $translate.instant('Dropdown.toggle') + '</span></div>');\n\t\t\t\tthis.$actionEl.on('click', function(event){\n\t\t\t\t\tself.onCloseButton(event);\n\t\t\t\t});\n\n\t\t\t\tthis.$element.addClass('x-dropdown-action-enabled');\n\t\t\t}\n\t\t};\n\n\t\tDropdown.prototype.getTitle = function(){\n\t\t\tif(this.options.titleTransCode){\n\t\t\t\treturn $translate.instant(this.options.titleTransCode);\n\t\t\t}\n\t\t\treturn '';\n\t\t}\n\n\t\tDropdown.prototype.onCloseButton = function(event){\n\t\t\tif(this.$element.hasClass(this.options.clsOpen)){\n\t\t\t\tthis.close(false);\n\t\t\t} else {\n\t\t\t\tthis.open();\n\t\t\t}\n\t\t\tevent.stopPropagation();\n\t\t\tevent.preventDefault();\n\t\t};\n\t\t\n\t\tDropdown.prototype.setOptions = function(options){\n\t\t\tangular.extend(this.options, options || {});\n\t\t};\n\t\t\n\t\tDropdown.prototype.toggle = function(){\n\t\t\tif(this.$element.hasClass(this.options.clsOpen)){\n\t\t\t\tthis.close();\n\t\t\t} else {\n\t\t\t\tthis.open();\n\t\t\t}\n\t\t};\n\t\t\n\t\tDropdown.prototype.close = function(waiting){\n\t\t\tvar self = this;\n\t\t\t\n\t\t\tif (waiting === undefined ) {\n\t\t\t\twaiting = true;\n\t\t\t}\n\t\t\t\n\t\t\tif (waiting) {\n\t\t\t\tthis.closeTimeout = $timeout(function(){\n\t\t\t\t\tself.close(false);\n\t\t\t\t}, this.options.closingTime);\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\tif(this.options.allowClose){\n\t\t\t\tthis.$element.removeClass(this.options.clsOpen);\n\t\t\t\n\t\t\t\tthis.afterClose();\n\t\t\t\tdocument.querySelector('body').classList.remove(this.options.bodyClsOpen);\n\t\t\t}\n\t\t};\n\t\t\n\t\tDropdown.prototype.afterClose =  function(){};\n\t\t\n\t\tDropdown.prototype.open = function(){\n\t\t\tif(!this.$element.hasClass(this.options.clsOpen)){\n\t\t\t\tthis.$element.addClass(this.options.clsOpen);\n\t\t\t\tthis.afterOpen();\n\t\t\t\tdocument.querySelector('body').classList.add(this.options.bodyClsOpen);\n\t\t\t}\n\t\t};\n\t\t\n\t\tDropdown.prototype.afterOpen = function(){};\n\t\t\n\t\tDropdown.prototype.cancelClosing = function(){\n\t\t\tthis.closeTimeout && $timeout.cancel(this.closeTimeout);\n\t\t};\n\t\t\t\n\t\tDropdown.prototype.render = function(){\n\t\t\tthis.renderInit();\n\t\t\tthis.$element.addClass('x-dropdown');\n\t\t};\n\n\t\treturn {\n\t\t\tcreate : function(element, options) {\n\t\t\t\treturn new Dropdown(element, options);\n\t\t\t}\n\t\t}\n\t\n\t}]);\n}(window.angular));","(function(angular) {\r\n\t'use strict';\r\n\r\n\tangular.module('xpsui:services') \r\n\t.factory('xpsui:FileUploadFactory', ['$http', \t\r\n\t\t/**\r\n\t\t * Factory method\r\n\t\t */\r\n\t\tfunction($http) {\r\n\t\tvar idCounter = 0;\r\n\t\t/**\r\n\t\t * FileUploader constructor\r\n\t\t * @param {$scope} $scope - scope to bind fileuploader to\r\n\t\t * @param {File} file - file to upload\r\n\t\t * @constructor file-upload-snippet.psFileUploadFactory~FileUploader\r\n\t\t */\r\n\t\tvar FileUploader = function($scope, data, contentType, url) {\r\n\t\t\tthis.id = ++idCounter;\r\n\t\t\tthis.$scope = $scope;\r\n\t\t\tthis.data = data;\r\n\t\t\tthis.xhr = new XMLHttpRequest();\r\n\t\t\tthis.progress = 0;\r\n\t\t\tthis.contentType = contentType;\r\n\t\t\tthis.url = url;\r\n\r\n\t\t\t/**\r\n\t\t\t * ddd\r\n\t\t\t * @method\r\n\t\t\t */\r\n\t\t\tthis.upload = function(callback) {\r\n\t\t\t\tvar that = this;\r\n\t\t\t\tthat.callback = callback;\r\n\r\n\r\n\t\t\t\tthis.xhr.upload.addEventListener('progress', function(evt) {\r\n\t\t\t\t\tif (evt.lengthComputable) {\r\n\t\t\t\t\t\tthat.progress = evt.loaded / evt.total;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tthat.$scope.$emit('psui:fileupload-progress', {\r\n\t\t\t\t\t\tuploader: that,\r\n\t\t\t\t\t});\r\n\t\t\t\t});\r\n\r\n\t\t\t\tthis.xhr.onreadystatechange = function() {\r\n\t\t\t\t\tif (that.xhr.readyState === 1) {\r\n\t\t\t\t\t\tthat.$scope.$emit('psui:fileupload-start', {\r\n\t\t\t\t\t\t\tuploader: that,\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tthat.xhr.setRequestHeader('content-type', that.contentType || 'application/octet-stream');\r\n\t\t\t\t\t\tthat.xhr.send(that.data);\r\n\t\t\t\t\t} else if (that.xhr.readyState === 4) {\r\n\t\t\t\t\t\t\tthat.progress = 1;\r\n\t\t\t\t\t\tif (that.xhr.status === 200) {\r\n\t\t\t\t\t\t\tthat.$scope.$emit('psui:fileupload-success', {\r\n\t\t\t\t\t\t\t\tuploader: that,\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\tthat.callback(null, that.xhr.responseText);\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tthat.$scope.$emit('psui-fileupload-fail', {\r\n\t\t\t\t\t\t\t\tuploader: that,\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\tthat.callback(that.xhr.status);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t};\r\n\t\t\t\tthis.xhr.open('PUT', this.url);\r\n\t\t\t};\r\n\t\t};\r\n\r\n\t\tvar exports = {\r\n\t\t\t/**\r\n\t\t\t * xxx\r\n\t\t\t * @property {FileUploader}\r\n\t\t\t */\r\n\t\t\tFileUploader: FileUploader\r\n\t\t};\r\n\r\n\t\treturn exports;\r\n\t}]);\r\n\r\n}(window.angular));","(function(angular) {\n\t'use strict';\n\n\tangular.module('xpsui:services')\n\t/**\n\t *\n\t * Factory used for generation of forms by schema definitions.\n\t *\n\t * @class FormGenerator\n\t * @module client\n\t * @submodule services\n\t */\n\t.factory('xpsui:FormGenerator', ['xpsui:logging', '$compile', 'xpsui:ComponentGenerator', '$timeout', '$translate', function(log, $compile, componentGenerator, $timeout, $translate) {\n\t\tfunction FormGenerator() {\n\t\t}\n\n\t\tFormGenerator.prototype.MODE = {\n\t\t\tVIEW: 'view',\n\t\t\tEDIT: 'edit',\n\t\t\tVIEWEDIT: 'viewedit'\n\t\t};\n\n\t\tFormGenerator.prototype.generateLabel = function(schemaFragment) {\n\t\t\t// TODO translation\n\t\t\tvar isRequired = (schemaFragment.required ? ' x-required': '');\n\t\t\tvar fieldsetClass = 'x-fieldset-label';\n\n\t\t\treturn angular.element('<div class=\"' + fieldsetClass + ' ' + isRequired + '\" >' \n\t\t\t\t+ '<span>' + (schemaFragment.transCode ?\n\t\t\t\t\t$translate.instant(schemaFragment.transCode) : schemaFragment.title\n\t\t\t\t) + '</span>' \n\t\t\t+ '</div>');\n\t\t};\n\n\t\tFormGenerator.prototype.generateValidations = function(field, schemaFragment, schemaPath, modelPath, mode) {\n\t\t\t//validation make sense only in edit mode\n\t\t\tif (mode === this.MODE.EDIT) {\n\n\t\t\t\t// validations\n\t\t\t\tif (schemaFragment.required) {\n\t\t\t\t\tfield.attr('required', true);\n\t\t\t\t\tfield.attr('xpsui-validity-mark', '');\n\t\t\t\t}\n\n\t\t\t\tif (schemaFragment.unique) {\n\t\t\t\t\tconsole.log('');\n\t\t\t\t\t// FIXME why do i need this definition? whay i cannot simply use whole object options in xpsui-schema\n\t\t\t\t\tfield.attr('xpsui-unique', schemaPath + '.unique');\n\t\t\t\t\tfield.attr('xpsui-validity-mark', '');\n\t\t\t\t\t// @todo it is replaced with recursive function (from down to up)\n\t\t\t\t\t// field.attr('psui-unique-id', options.modelPath+'.id');\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn field;\n\t\t};\n\n\t\tFormGenerator.prototype.generateField = function(schemaFragment, schemaPath, modelPath, mode) {\n\t\t\tvar field;\n\n\t\t\tif (mode === this.MODE.VIEWEDIT) {\n\t\t\t\tfield = angular.element('<div></div>');\n\t\t\t\tfield.attr('xpsui-form-control', 'x');\n\t\t\t\tfield.attr('xpsui-inlineedit', this.MODE.VIEW);\n\t\t\t\tfield.attr('xpsui-model', modelPath);\n\t\t\t\tfield.attr('xpsui-schema', schemaPath);\n\t\t\t} else if (mode === this.MODE.EDIT) {\n\t\t\t\tif (schemaFragment.type === 'array') {\n\t\t\t\t\tif (schemaFragment.items && schemaFragment.items.render && schemaFragment.items.render.component ) {\n\t\t\t\t\t\tfield = angular.element('<div xpsui-array-control-edit=\"'+schemaFragment.items.render.component+'\"></div>');\n\t\t\t\t\t} else {\n\t\t\t\t\t\tfield = angular.element('<div xpsui-array-control-edit></div>');\n\t\t\t\t\t}\n\t\t\t\t\tfield.attr('xpsui-schema', schemaPath);\n\t\t\t\t} else if(schemaFragment.objectLink2) {\n\t\t\t\t\tfield = angular.element('<div xpsui-objectlink2-edit></div>');\n\t\t\t\t\tfield.attr('xpsui-schema', schemaPath);\n\t\t\t\t} else if(schemaFragment.uploadableImage\n\t\t\t\t\t|| (schemaFragment.render && schemaFragment.render.component === 'psui-uploadable-image')){\n\t\t\t\t\tfield = angular.element('<div xpsui-uploadable-image xpsui-imageresizor /></div>');\n\t\t\t\t\tfield.attr('xpsui-schema', schemaPath);\n\t\t\t\t\tvar width = schemaFragment.uploadableImage ? \n\t\t\t\t\t\tschemaFragment.uploadableImage.width : schemaFragment.render.width;\n\t\t\t\t\tvar height = schemaFragment.uploadableImage ? \n\t\t\t\t\t\tschemaFragment.uploadableImage.height : schemaFragment.render.height;\n\n\t\t\t\t\tfield.attr('psui-width', width);\n\t\t\t\t\tfield.attr('psui-height', height);\n\n\t\t\t\t} else if (schemaFragment.enum) {\n\t\t\t\t\tfield = angular.element('<div xpsui-select-edit></div>');\n\t\t\t\t\tfield.attr('xpsui-schema', schemaPath);\n\t\t\t\t} else if (schemaFragment.render && schemaFragment.render.component  ){\n\t\t\t\t\tif ( schemaFragment.render.component==\"psui-textarea\" ) {\n\t\t\t\t\t\tfield = angular.element('<div xpsui-textarea-edit></div>');\n\t\t\t\t\t} else if ( schemaFragment.render.component==\"psui-datepicker\" ) {\n\t\t\t\t\t\tfield = angular.element('<div xpsui-date-edit xpsui-calendar ></div>');\n\t\t\t\t\t} else if (schemaFragment.render.component==\"psui-contenteditable\") {\n\t\t\t\t\t\tfield = angular.element('<div xpsui-contenteditable></div>');\n\n\t\t\t\t\t} else if (schemaFragment.render.component==\"psui-uploadable-file\") {\n\t\t\t\t\t\tfield = angular.element('<div xpsui-uploadable-file></div>');\n\t\t\t\t\t} else {\n\t\t\t\t\t\tfield = angular.element('<div>Unsupported render component '+schemaFragment.render.component+'</div>');\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tfield = angular.element('<div xpsui-string-edit></div>');\n\t\t\t\t}\n\n\t\t\t\tfield.attr('xpsui-schema', schemaPath);\n\t\t\t\tfield.attr('ng-model', modelPath);\n\n\t\t\t} else {\n\t\t\t\tif (schemaFragment.type === 'array') {\n\t\t\t\t\tif (schemaFragment.items && schemaFragment.items.render && schemaFragment.items.render.component) {\n\t\t\t\t\t\tfield = angular.element('<div xpsui-array-control-view=\"'+schemaFragment.items.render.component+'\"></div>');\n\n\t\t\t\t\t} else {\n\t\t\t\t\t\tfield = angular.element('<div xpsui-array-control-view></div>');\n\t\t\t\t\t}\n\n\t\t\t\t\tfield.attr('xpsui-schema', schemaPath);\n\t\t\t\t} else if (schemaFragment.objectLink2) {\n\t\t\t\t\tfield = angular.element('<div xpsui-objectlink2-view></div>');\n\t\t\t\t\tfield.attr('xpsui-schema', schemaPath);\n\t\t\t\t} else if (schemaFragment.uploadableImage\n\t\t\t\t\t|| (schemaFragment.render && schemaFragment.render.component === 'psui-uploadable-image')) {\n\n\t\t\t\t\tfield = angular.element('<div xpsui-uploadable-image-view></div>');\n\t\t\t\t\tvar width = schemaFragment.uploadableImage ? \n\t\t\t\t\t\t\tschemaFragment.uploadableImage.width : schemaFragment.render.width;\n\t\t\t\t\tvar height = schemaFragment.uploadableImage ? \n\t\t\t\t\t\tschemaFragment.uploadableImage.height : schemaFragment.render.height;\n\t\t\t\t\tvar style = 'width: 100% !important;'\n\t\t\t\t\t\t+ (height ? 'height:'+height+'px !important;':'height:150px;')\n\t\t\t\t\t\t+ 'background-size: contain;'\n\t\t\t\t\t\t+ 'background-repeat: no-repeat;'\n\t\t\t\t\t\t+ 'background-position: top left;';\n\t\t\t\t\tfield = angular.element('<div style=\"' + style + 'background-image: url(\\'{{' + modelPath + '?' + modelPath + ':\\'/img/no_photo.jpg\\'}}\\')\"></div>');\n\t\t\t\t} else if(schemaFragment.type === \"date\"\n\t\t\t\t\t|| (schemaFragment.render && schemaFragment.render.component === 'psui-datepicker')) {\n\t\t\t\t\tfield = angular.element('<div xpsui-date-view></div>');\n\t\t\t\t} else if (schemaFragment.enum) {\n\t\t\t\t\tfield = angular.element('<div xpsui-select-view></div>');\n\t\t\t\t\tfield.attr('xpsui-schema', schemaPath);\n\t\t\t\t} else {\n\t\t\t\t\tfield = angular.element('<div xpsui-string-view></div>');\n\t\t\t\t}\n\n\t\t\t\tfield.attr('ng-model', modelPath);\n\n\t\t\t}\n\n\t\t\treturn field;\n\t\t};\n\n\t\tFormGenerator.prototype.generatePropertyRow = function(schemaFragment, schemaPath, modelPath, mode) {\n\n\t\t\tif (schemaFragment.type === 'array') {\n\t\t\t\tvar container = angular.element('<div ></div>');\n\t\t\t\tvar row1 = angular.element('<div class=\"x-fieldset-row\"></div>');\n\t\t\t\trow1.append(this.generateLabel(schemaFragment));\n\n\t\t\t\tif (schemaFragment.readOnly) {\n\t\t\t\t\tmode = this.MODE.VIEW;\n\t\t\t\t}\n\t\t\t\tvar row2 = angular.element('<div class=\"x-fieldset-row\"></div>');\n\t\t\t\trow2.append(this.generateValidations(this.generateField(schemaFragment, schemaPath, modelPath, mode), schemaFragment, schemaPath, modelPath, mode));\n\t\t\t\tcontainer.append(row1);\n\t\t\t\tcontainer.append(row2);\n\t\t\t\treturn container;\n\t\t\t}\n\n\t\t\tvar row = angular.element('<div class=\"x-fieldset-row\"></div>');\n\n\t\t\trow.append(this.generateLabel(schemaFragment));\n\n\t\t\tvar value = angular.element('<div class=\"x-fieldset-value\"></div>');\n\n\t\t\tif (schemaFragment.readOnly) {\n\t\t\t\tmode = this.MODE.VIEW;\n\t\t\t}\n\t\t\tvalue.append(this.generateValidations(this.generateField(schemaFragment, schemaPath, modelPath, mode),schemaFragment, schemaPath, modelPath, mode));\n\t\t\trow.append(value);\n\n\t\t\treturn row;\n\t\t};\n\n\t\t/**\n\t\t * Generates form defined by schema\n\t\t * @method generateForm\n\t\t * @param scope used angular scope\n\t\t * @param elm element to geneerate form elements in\n\t\t * @param schemaFragment {Object} fragment of schema used as form definition\n\t\t * @param schemaPath\n\t\t * @param modelPath\n\t\t * @param mode\n\t\t */\n\t\tFormGenerator.prototype.generateForm = function(scope, elm, schemaFragment, schemaPath, modelPath, mode) {\n\t\t\tvar p, localSchemaPath, localModelPath, localFragment, component, labelComponent, fieldComponent;\n\n\t\t\tif (!schemaFragment) {\n\t\t\t\tlog.warn('Schema fragment not defined, existing');\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// @todo schema root missing type property\n\t\t\t// if (schemaFragment && schemaFragment.type) {\n\t\t\tif (schemaFragment) {\n\t\t\t\t// schema fragment has defined type\n\t\t\t\t// @todo schema root missing type property\n\t\t\t\t//if (schemaFragment.type === 'object') {\n\t\t\t\tif (typeof schemaFragment.properties == 'object') {\n\t\t\t\t\tfor (p in schemaFragment.properties) {\n\t\t\t\t\t\tcomponent = null;\n\t\t\t\t\t\tlocalSchemaPath = schemaPath.concat('.properties.', p);\n\t\t\t\t\t\tlocalModelPath = modelPath.concat('.', p);\n\t\t\t\t\t\tlocalFragment = schemaFragment.properties[p];\n\n\t\t\t\t\t\tlog.group('Generating element for \"%s\"', localSchemaPath);\n\n\t\t\t\t\t\tif (localFragment && localFragment.type) {\n\t\t\t\t\t\t\t// localFragment has explicitly defined type\n\n\t\t\t\t\t\t\tif (localFragment.type === 'object') {\n\t\t\t\t\t\t\t\tif (localFragment.objectLink2) {\n\t\t\t\t\t\t\t\t\t// objectLink2\n\t\t\t\t\t\t\t\t\tcomponent = this.generatePropertyRow(localFragment, localSchemaPath, localModelPath, mode);\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t// general object, render as fieldset\n\t\t\t\t\t\t\t\t\tcomponent = angular.element('<div></div>');\n\t\t\t\t\t\t\t\t\tcomponent.attr('xpsui-options', localSchemaPath);\n\t\t\t\t\t\t\t\t\tcomponent.attr('xpsui-model', localModelPath);\n\t\t\t\t\t\t\t\t\tcomponent.attr('xpsui-fieldset', mode);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t} else if (localFragment.type === 'string' ||\n\t\t\t\t\t\t\t\tlocalFragment.type === 'array' ||\n\t\t\t\t\t\t\t\tlocalFragment.type === 'number'\n\t\t\t\t\t\t\t) {\n\t\t\t\t\t\t\t\tcomponent = this.generatePropertyRow(localFragment, localSchemaPath, localModelPath, mode);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tlog.warn('Local fragment type %s not implemented yet', localFragment.type);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t// localFragment has not explicitly defined type\n\t\t\t\t\t\t\t// we will try to identify types by other means\n\t\t\t\t\t\t\tif (localFragment.objectLink2) {\n\t\t\t\t\t\t\t\tcomponent = this.generatePropertyRow(localFragment, localSchemaPath, localModelPath, mode);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tlog.warn('Cannot identify type of fragment %s', localSchemaPath);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t//component = componentGenerator.generate(schemaFragment.properties[p], localSchemaPath, localModelPath, mode || this.MODE.VIEW);\n\t\t\t\t\t\tif(component){\n\t\t\t\t\t\t\telm.append(component);\n\t\t\t\t\t\t\t$compile(component)(scope);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tlog.groupEnd();\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\t\tlog.warn('Schema fragment type \"%s\" not implemented yet', schemaFragment.type);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tlog.warn('Schema fragment has not explicit type defined');\n\t\t\t}\n\t\t};\n\n\t\treturn new FormGenerator();\n\t}]);\n\n}(window.angular));\n","(function(angular) {\n\t'use strict';\n\n\tangular.module('xpsui:services')\n\t.factory('xpsui:GeneratorsGenerator', [ '$http', 'xpsui:safeUrlEncoder',\n\t\t'xpsui:SchemaUtil','$q','xpsui:ObjectTools', \n\t\tfunction($http, urlEncoder,schemaUtilFactory,$q,objectTools) {\n\t\tvar service = {};\n\n\t\t/** Counts porter(-berger) table\n\t\t * @teams - array of objects that will be used to define match\n\t\t * @terms - array of object that will be used to define round, its size limits result\n\t\t * @returns - object in form\n\t\t\t\t[{ round:<index>,term:<round_term>,,matches:[{home:teams[x1],visitors:teams[y1],board:<board_index>},...] },...]\n\t\t */\n\t\tfunction bergerTable (teams,terms) {\n\t\t\tvar floatTable = [];\n\t\t\tvar n, i, increment=1, atype=1, minmove=0, flipcolors=0;\n\n\n\t\t\tif (teams.length%2===1){\n\t\t\t\tteams.push({complement:true});\n\t\t\t}\n\n\t\t\tn = teams.length;\n\n\n\t\t\tvar nr = n-1; // Number of rounds\n\n\t\t\tvar n2 = n / 2;\n\t\t\tvar x, j, temp, colorFlag, incr;\n\n\t\t\tvar max_round = terms.length ;\n\n\t\t\tvar test_r = 0;\n\t\t\tvar outRounds=[];\n\n\t\t\tfor (var r=1; r<= max_round; r++) {\t// r is the round number.\n\t\t\t\t\t\tvar outRound={round:r,term:terms[r-1],matches:[]};\n\t\t\t\t\t\toutRounds.push(outRound);\n\n\t\t\t\tif (r == 1) {\t\t // Round 1 initially seat the players\n\n\t\t\t\t\tincr=n-3; j = 0;\n\n\t\t\t\t\tfor (i = 1; i < n; i++) {\n\t\t\t\t\t\tfloatTable[j]=i;\n\t\t\t\t\t\tj += incr;\n\t\t\t\t\t\tj = j % (n-1);\n\t\t\t\t\t}\n\t\t\t\t\tfloatTable[nr]=n;\t// Identifies the \"ghost\" player, will not move\n\t\t\t\t}\n\t\t\t\telse {\t\t\t // Other rounds, rotate the players \"clockwise\"\n\t\t\t\t\ttemp = floatTable[n-2];\n\t\t\t\t\tfor (i=n-2;\ti > 0 ; i--) {\n\t\t\t\t\t\tfloatTable[i] = floatTable[i-1];\n\t\t\t\t\t}\n\t\t\t\t\tfloatTable[0] = temp;\n\t\t\t\t}\n\t\t\t\tif (r == n) {\n\t\t\t\t\t flipcolors ^= 1; // Swap colors for 2nd half\n\t\t\t\t\t test_r = 1; }\n\n\t\t\t\ti=0; // i is the board number about to be displayed, changed at bottom of loop\n\t\t\t\tif (atype == '1')\n\t\t\t\t\tincrement=2;\n\n\t\t\t\twhile (1) {\t //Must get out of this loop with break\n\t\t\t\t\tif (i === 0)\t //At ghost board, color determined by round number\n\t\t\t\t\t\tcolorFlag = ((r-test_r)%2) ? 1 : 0;\n\t\t\t\t\telse\t\t\t//On other boards, board number determines it\n\t\t\t\t\t\tcolorFlag = (i % 2) ? 0 : 1;\n\n\t\t\t\t\tcolorFlag ^= flipcolors; //Will reverse color assignment if checked\n\n\t\t\t\t\tvar match={home: teams[floatTable[colorFlag?nr-i:i]-1] ,visitors:teams[floatTable[colorFlag?i:nr-i]-1] ,boar:i};\n\n\t\t\t\t\tif (i===0){\n\t\t\t\t\t\t\tmatch={home:match.visitors,visitors:match.home,board:i};\n\t\t\t\t\t}\n\n\t\t\t\t\tif (match.home.complement){\n\t\t\t\t\t\toutRound.notPlaying=match.visitors;\n\t\t\t\t\t} else if (match.visitors.complement){\n\t\t\t\t\t\toutRound.notPlaying=match.home;\n\t\t\t\t\t} else {\n\t\t\t\t\t\toutRound.matches.push(match);\n\t\t\t\t\t}\n\n\t\t\t\t\t\tif (minmove && (i===0) && (r % 2)===0)\n\t\t\t\t\t\t\t\t\t i = 1;\n\t\t\t\t\t\telse\n\t\t\t\t\t\t\ti+= increment;\n\t\t\t\t\t\tif (i >= n2)\n\t\t\t\t\t\t\tif (increment == 1)\t//Board number option\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\telse\t{\t//Come back to display the boards we missed\n\t\t\t\t\t\t\t\tincrement = -2;\n\t\t\t\t\t\t\t\ti = ((i > n2) ? i - 3 : --i) ;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\tif ((i < 1) && (increment == -2)) //Finished with NOT board number option, exit loop\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// console.log(outRounds);\n\t\t\t// console.log(JSON.stringify(outRounds));\n\t\t\treturn outRounds;\n\t\t}\n\t\tfunction saveBerger(entity,callback){\n\n\t\t\tvar saveSchema= schemaUtilFactory.encodeUri(\"uri://registries/refereeReports#views/refereeReports/new\");\n\t\t\tvar saved=0;\n\t\t\tvar all=[];\n\n\n\t\t\tentity.saving=true;\n\n\t\t\tentity.generated.map(function(round){\n\t\t\t\tround.matches.map(function(match){\n\t\t\t\t\tvar toSave={};\n\t\t\t\t\ttoSave.baseData={};\n\t\t\t\t\ttoSave.baseData.homeClub=match.home;\n\t\t\t\t\ttoSave.baseData.awayClub=match.visitors;\n\t\t\t\t\ttoSave.baseData.matchRound={registry:\"schedules\",oid:round.term.id};\n\t\t\t\t\ttoSave.baseData.competition=entity.baseData.competition;\n\t\t\t\t\ttoSave.baseData.competitionPart={registry:\"competitionParts\",oid:entity.id};\n\t\t\t\t\ttoSave.baseData.matchDate=round.term.baseData.date;\n\t\t\t\t\ttoSave.baseData.state='Otvorený';\n\t\t\t\t\tall.push( $http({url: '/udao/saveBySchema/'+saveSchema, method: 'PUT',data: toSave}));\n\t\t\t\t});\n\t\t\t});\n\t\t\t$q.all(all).then(function(){\n\t\t\t \t\tcallback(null);\n\t\t\t});\n\n\t\t}\n\n\t\tfunction generateBerger(entity,callback){\n\t\t\tvar searchSchema=\"uri://registries/schedule#views/schedule/search\";\n\t\t\t$http({\n\t\t\t\tmethod : 'POST',\n\t\t\t\turl : '/search/' + schemaUtilFactory.encodeUri(searchSchema),\n\t\t\t\tdata : {\n\t\t\t\t\tcrits :[{\n\t\t\t\t\t\tf : \"baseData.competitionPart.oid\",\n\t\t\t\t\t\tv : entity.id,\n\t\t\t\t\t\top : \"eq\"\n\t\t\t\t\t}],\n\t\t\t\t\tsorts: [ { f:\"baseData.date\", o: \"asc\"}]\n\t\t\t\t}\n\t\t\t}).success(function(terms){\n\t\t\t\tvar teams=entity.listOfTeam.team;\n\n\t\t\t\tentity.generated=bergerTable(teams,terms);\n\t\t\t\tcallback();\n\t\t\t}).error(function(err){\n\t\t\t\tcallback(err);\n\t\t\t});\n\t\t}\n\n\t\tfunction generateUserAccounting(entity,callback){\n\n\t\t\t$http({\n\t\t\t\tmethod : 'GET',\n\t\t\t\turl : '/info/accounting/user/' + entity.id,\n\n\t\t\t}).success(function(info){\n\t\t\t\tentity.accounting=info;\n\t\t\t\tcallback();\n\t\t\t}).error(function(err){\n\t\t\t\tcallback(err);\n\t\t\t});\n\t\t}\n\n\t\tfunction generateClubAccounting(entity,callback){\n\n\t\t\t$http({\n\t\t\t\tmethod : 'get',\n\t\t\t\turl : '/info/accounting/club/' + entity.id,\n\n\t\t\t}).success(function(info){\n\t\t\t\tentity.accounting=info;\n\t\t\t\tcallback();\n\t\t\t}).error(function(err){\n\t\t\t\tcallback(err);\n\t\t\t});\n\t\t}\n\n\n\t\tservice.exportCsv = function() {\n\t\t\tvar c = convertCriteria($scope.searchCrit);\n\t\t\t// add forced criteria\n\t\t\tfor (var idx = 0; idx < $scope.forcedCriterias.length; idx++) {\n\t\t\t\tc.push($scope.forcedCriterias[idx]);\n\t\t\t}\n\t\t\tgenericSearchFactory.getSearch($scope.entityUri, $scope.lastCriteria,convertSortBy( $scope.sortBy),0,1000).success(function(data) {\n\n\t\t\t\tdata=toHtml($scope.schema,data);\n\n\t\t\t\tvar blob = new Blob([data], {type: 'application/vnd.ms-excel;charset=utf-8'});\n\t\t\t\tvar url  =  window.webkitURL||window.URL;\n\t\t\t\tvar link = document.createElementNS('http://www.w3.org/1999/xhtml', 'a');\n\t\t\t\tlink.href = url.createObjectURL(blob);\n\t\t\t\tlink.download = 'search-export.xls'; // whatever file name you want :)\n\n\t\t\t\tvar event = document.createEvent('MouseEvents');\n\t\t\t\tevent.initEvent('click', true, false);\n\t\t\t\tlink.dispatchEvent(event);\n\n\t\t\t}).error(function(err) {\n\t\t\t\tnotificationFactory.error(err);\n\t\t\t});\n\t\t};\n\n\n\t\tservice.generate=function(entity,type,callback){\n\t\t\tswitch (type){\n\t\t\t\tcase \"BERGER\":\n\t\t\t\t\tgenerateBerger(entity,callback);\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"USER-ACCOUNTING\":\n\t\t\t\t\tgenerateUserAccounting(entity,callback);\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"CLUB-ACCOUNTING\":\n\t\t\t\t\tgenerateClubAccounting(entity,callback);\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t};\n\t\tservice.save=function(entity,type,callback){\n\t\t\tswitch (type){\n\t\t\t\tcase \"BERGER\":\n\t\t\t\t\tsaveBerger(entity,callback);\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t};\n\t\treturn service;\n\t} ]);\n\n}(window.angular));\n","(function(angular) {\n\t'use strict';\n\n\tangular.module('xpsui:services')\n\t.factory('xpsui:GenericSearchFactory', [ '$http', 'xpsui:SchemaUtil', '$translate', function($http, schemaUtilFactory, $translate) {\n\t\tvar service = {};\n\n\t\tservice.getSearch = function(searchSchema, crits,sortBy,skip,limit) {\n\n\t\t\treturn $http({\n\t\t\t\tmethod : 'POST',\n\t\t\t\turl : '/search/' + schemaUtilFactory.encodeUri(schemaUtilFactory.concatUri(searchSchema,'search')),\n\t\t\t\tdata : {\n\t\t\t\t\tcrits: crits,\n\t\t\t\t\tsortBy: sortBy,\n\t\t\t\t\tlimit: limit,\n\t\t\t\t\tskip: skip\n\t\t\t\t}\n\t\t\t});\n\t\t};\n\n\n\t\tservice.getSearchCount = function(searchSchema, crits) {\n\n\t\t\treturn $http({\n\t\t\t\tmethod : 'POST',\n\t\t\t\turl : '/search/count/' + schemaUtilFactory.encodeUri(schemaUtilFactory.concatUri(searchSchema,'search')),\n\t\t\t\tdata : {\n\t\t\t\t\tcrits : crits\n\t\t\t\t}\n\t\t\t});\n\t\t};\n\n\t\tservice.parseSearchDef = function(schema) {\n\n\t\t\tvar retval = {};\n\n\t\t\tfunction collectProperties(pathPrefix, objectDef,group,resultArr) {\n\t\t\t\tfor ( var pr in objectDef.properties) {\n\t\t\t\t\t\tif (objectDef.properties[pr].objectLink2) {\n\t\t\t\t\t\t\tresultArr.push({\n\t\t\t\t\t\t\t\tpath: pathPrefix + pr+'.oid',\n\t\t\t\t\t\t\t\ttype: objectDef.properties[pr].type,\n\t\t\t\t\t\t\t\trender:{objectLink2:objectDef.properties[pr].objectLink2},\n\t\t\t\t\t\t\t\tschemaFragment:objectDef.properties[pr],\n\t\t\t\t\t\t\t\tgroup:group,\n\t\t\t\t\t\t\t\ttitle: (objectDef.properties[pr].transCode ? $translate.instant(objectDef.properties[pr].transCode) : objectDef.properties[pr].title)\n\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\n\t\t\t\t\t//FIXME: change to datetype\n\t\t\t\t\tif ('render' in objectDef.properties[pr] && objectDef.properties[pr].render.component==='psui-datepicker' ) {\n\t\t\t\t\t\t\tresultArr.push({\n\t\t\t\t\t\t\t\tpath: pathPrefix + pr,\n\t\t\t\t\t\t\t\ttype: objectDef.properties[pr].type,\n\t\t\t\t\t\t\t\trender:{datepicker:true},\n\t\t\t\t\t\t\t\tschemaFragment:objectDef.properties[pr],\n\t\t\t\t\t\t\t\tgroup:group,\n\t\t\t\t\t\t\t\ttitle: (objectDef.properties[pr].transCode ? $translate.instant(objectDef.properties[pr].transCode) : objectDef.properties[pr].title)\n\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\n\n\t\t\t\t\tif (objectDef.properties[pr].type === 'object') {\n\n\n\n\t\t\t\t\t\tcollectProperties(pr + '.', objectDef.properties[pr],objectDef.properties[pr].transCode ? $translate.instant(objectDef.properties[pr].transCode) :objectDef.properties[pr].title, resultArr);\n\n\n\n\t\t\t\t\t} else {\n\t\t\t\t\t\tresultArr.push({\n\t\t\t\t\t\t\tpath: pathPrefix + pr,\n\t\t\t\t\t\t\ttype: objectDef.properties[pr].type,\n\t\t\t\t\t\t\tgroup:group,\n\t\t\t\t\t\t\ttitle: objectDef.properties[pr].transCode ? $translate.instant(objectDef.properties[pr].transCode) : objectDef.properties[pr].title\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t}\n\n\n\t\t\tretval.schema = schema.url;\n\t\t\tretval.attributes = [];\n\t\t\tretval.operators = [ {\n\t\t\t\ttitle: '=',\n\t\t\t\tvalue: 'eq'\n\t\t\t}, {\n\t\t\t\ttitle: '>',\n\t\t\t\tvalue: 'gt'\n\t\t\t},\n\t\t\t{\n\t\t\t\ttitle: '>=',\n\t\t\t\tvalue: 'gte'\n\t\t\t},  {\n\t\t\t\ttitle: '<',\n\t\t\t\tvalue: 'lt'\n\t\t\t},\n\t\t\t {\n\t\t\t\ttitle: '<=',\n\t\t\t\tvalue: 'lte'\n\t\t\t},  {\n\t\t\t\ttitle: 'je iné ako',\n\t\t\t\tvalue: 'neq'\n\t\t\t}, {\n\t\t\t\ttitle: 'začína s',\n\t\t\t\tvalue: 'starts'\n\t\t\t},{\n\t\t\t\ttitle: 'obsahuje',\n\t\t\t\tvalue: 'contains'\n\t\t\t},\n\t\t\t {\n\t\t\t\ttitle: 'má vyplnené',\n\t\t\t\tvalue: 'ex'\n\t\t\t} ];\n\n\t\t\tcollectProperties('', schema,null, retval.attributes);\n\n\t\t\treturn retval;\n\n\t\t};\n\n\t\treturn service;\n\t} ]);\n\n}(window.angular));\n","(function(angular) {\n\t'use strict';\n\n\tangular.module('xpsui:services')\n\t/**\n\t * Factory for creation of HttpHandlers. Use as HttpHandlerFactory.newHandler();\n\t */\n\t.factory('xpsui:HttpHandlerFactory', ['$http', '$q', function($http, $q) {\n\t\t/**\n\t\t * Class handles http requests. Its main purpose is to guarantee\n\t\t * there is only one active http request at any time.\n\t\t *\n\t\t * It provides functionality to cancel pending request to prevent duplicate\n\t\t * event firing.\n\t\t *\n\t\t * @class HttpHandler\n\t\t */\n\t\tfunction HttpHandler() {\n\t\t\tthis.activeDeffered = null;\n\t\t}\n\n\t\t/**\n\t\t * Wraps functionality of $http service into own promise\n\t\t *\n\t\t * Api is identical to $http api\n\t\t */\n\t\tHttpHandler.prototype.http = function(config) {\n\t\t\tvar deffered = $q.defer(),\n\t\t\t\tself = this\n\t\t\t;\n\n\t\t\tif (this.activeDeffered) {\n\t\t\t\tthis.activeDeffered.reject('cancelled');\n\t\t\t\tthis.activeDeffered = null;\n\t\t\t}\n\n\t\t\t$http(config).then(\n\t\t\t\t// success\n\t\t\t\tfunction() {\n\t\t\t\t\tif (self.activeDeffered === deffered) {\n\t\t\t\t\t\tdeffered.resolve.apply(deffered, arguments);\n\t\t\t\t\t\tself.activeDeffered = null;\n\t\t\t\t\t}\n\n\t\t\t\t\t//self.activeDeffered = null;\n\t\t\t\t},\n\t\t\t\t// error\n\t\t\t\tfunction() {\n\t\t\t\t\tif (self.activeDeffered === deffered) {\n\t\t\t\t\t\tdeffered.reject.apply(deffered, arguments);\n\t\t\t\t\t\tself.activeDeffered = null;\n\t\t\t\t\t}\n\n\t\t\t\t\t//selfs.activeDeffered = null;\n\t\t\t\t},\n\t\t\t\t// notify\n\t\t\t\tfunction() {\n\t\t\t\t\tif (self.activeDeffered === deffered) {\n\t\t\t\t\t\tdeffered.notify.apply(deffered, arguments);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t);\n\n\t\t\tthis.activeDeffered = deffered;\n\n\t\t\treturn deffered.promise;\n\t\t};\n\n\t\treturn {\n\t\t\tnewHandler: function() {\n\t\t\t\treturn new HttpHandler();\n\t\t\t}\n\t\t};\n\t}]);\n}(window.angular));\n","(function(angular) {\n\t'use strict';\n\n\tangular.module('xpsui:services')\n\t.provider('xpsui:logging', [function() {\n\t\tvar level = 7;\n\n\t\tfunction Logger(loggingLevel) {\n\t\t\tthis.level = loggingLevel;\n\t\t\tthis.ERROR = 1;\n\t\t\tthis.WARN = 2;\n\t\t\tthis.INFO = 3;\n\t\t\tthis.DEBUG = 4;\n\t\t\tthis.TRACE = 5;\n\t\t}\n\n\t\tLogger.prototype.info = function() {\n\t\t\tif (this.level >= this.INFO) {\n\t\t\t\tconsole.info.apply(console, arguments);\n\t\t\t}\n\t\t};\n\t\tLogger.prototype.debug = function() {\n\t\t\tif (this.level >= this.DEBUG) {\n\t\t\t\tconsole.debug.apply(console, arguments);\n\t\t\t}\n\t\t};\n\n\t\tLogger.prototype.trace = function() {\n\t\t\tif (this.level >= this.TRACE) {\n\t\t\t\tconsole.trace.apply(console, arguments);\n\t\t\t}\n\t\t};\n\n\t\tLogger.prototype.warn = function() {\n\t\t\tif (this.level >= this.WARN) {\n\t\t\t\tconsole.warn.apply(console, arguments);\n\t\t\t}\n\t\t};\n\n\t\tLogger.prototype.error = function() {\n\t\t\tif (this.level >= this.ERROR) {\n\t\t\t\tconsole.error.apply(console, arguments);\n\t\t\t}\n\t\t};\n\n\t\tLogger.prototype.group = function() {\n\t\t\tif (this.level >= this.INFO) {\n\t\t\t\tconsole.groupCollapsed.apply(console, arguments);\n\t\t\t}\n\t\t};\n\n\t\tLogger.prototype.groupEnd = function() {\n\t\t\tif (this.level >= this.INFO) {\n\t\t\t\tconsole.groupEnd.apply(console, arguments);\n\t\t\t}\n\t\t};\n\n\t\tLogger.prototype.profile = function() {\n\t\t\tif (this.level >= this.INFO) {\n\t\t\t\tconsole.profile.apply(console, arguments);\n\t\t\t}\n\t\t};\n\n\t\tLogger.prototype.profileEnd = function() {\n\t\t\tif (this.level >= this.INFO) {\n\t\t\t\tconsole.profileEnd.apply(console, arguments);\n\t\t\t}\n\t\t};\n\n\t\tLogger.prototype.time = function() {\n\t\t\tif (this.level >= this.INFO) {\n\t\t\t\tconsole.time.apply(console, arguments);\n\t\t\t}\n\t\t};\n\n\t\tLogger.prototype.timeEnd = function() {\n\t\t\tif (this.level >= this.INFO) {\n\t\t\t\tconsole.timeEnd.apply(console, arguments);\n\t\t\t}\n\t\t};\n\n\t\tvar loggerSingleton = new Logger(level);\n\n\t\treturn {\n\t\t\tsetLevel: function(l) {\n\t\t\t\tlevel = l;\n\t\t\t},\n\t\t   $get: function() {\n\t\t\t   return loggerSingleton;\n\t\t   }\n\t\t};\n\t}]);\n\n}(window.angular));\n","(function(angular) {\n\t'use strict';\n\n\tangular.module('xpsui:services')\n\t.factory('xpsui:MassmailingFactory', [ '$http', function($http) {\n\t\tvar service = {};\n\t\tservice.sendMail = function(template,crits,users) {\n\n\t\t\treturn $http({\n\t\t\t\tmethod : 'POST',\n\t\t\t\turl : '/massmailing/send',\n\t\t\t\tdata : {\n\t\t\t\t\tcrits : crits,\n\t\t\t\t\ttemplate: template,\n\t\t\t\t\tusers: users\n\t\t\t\t}\n\t\t\t});\n\t\t};\n\n\t\treturn service;\n\t} ]);\n\n}(window.angular));\n","(function(angular) {\r\n\t'use strict';\r\n\r\n\t/**\r\n\t * @class xpsui:NavigationService\r\n\t * @module client\r\n\t * @submodule services\r\n\t */\r\n\tangular.module('xpsui:services')\r\n\t.factory('xpsui:NavigationService', ['$location', function($location) {\r\n\t\tvar service = { navigationStack: [] };\r\n\r\n\t\t/**\r\n\t\t * Checks the last item inserted into navigation and returns this item.\r\n\t\t * The item stays where it is in navigation.\r\n\t\t * \r\n\t\t * @return top of navigationStack or null, if empty\r\n\t\t * @method top\r\n\t\t * @private\r\n\t\t */\r\n\t\tvar top = function() {\r\n\t\t\tif (service.navigationStack.length > 0) {\r\n\t\t\t\treturn service.navigationStack[service.navigationStack.length-1];\r\n\t\t\t}\r\n\t\t\treturn null;\r\n\t\t};\r\n\r\n\t\t/**\r\n\t\t * Stores the current path from $location object and the context passed as method parameter.\r\n\t\t *\r\n\t\t * @param {Object} context Information about the state to be restored with current location.\r\n\t\t * \r\n\t\t * @return {undefined}\r\n\t\t * @method navigate\r\n\t\t */\r\n\t\tservice.navigate = function(context) {\r\n\t\t\tservice.navigationStack.push({ path: $location.path(), context: context });\r\n\t\t\tif (service.navigationStack.length > 10) {\r\n\t\t\t\tservice.navigationStack.splice(0, 1);\r\n\t\t\t}\r\n\t\t};\r\n\r\n\t\t/**\r\n\t\t * Stores path and context, both passed as method parameter.\r\n\t\t *\r\n\t\t * @param {String} the location to be stored with context information.\r\n\t\t * @param {Object} context information about the state to be restored with location param.\r\n\t\t * \r\n\t\t * @return {undefined}\r\n\t\t * @method navigateToPath\r\n\t\t */\r\n\t\tservice.navigateToPath = function(path, context) {\r\n\t\t\tservice.navigationStack.push({ path: path, context: context });\r\n\t\t\tif (service.navigationStack.length > 10) {\r\n\t\t\t\tservice.navigationStack.splice(0, 1);\r\n\t\t\t}\r\n\t\t};\r\n\r\n\t\t/**\r\n\t\t * Returns the last item inserted to navigation and removes this item from navigation,\r\n\t\t * or undefined.\r\n\t\t * The value is returned and then removed only, if the current location matches the stored location\r\n\t\t * for last item.\r\n\t\t *\r\n\t\t * @return {object} context from the last inserted item, or null.\r\n\t\t * @method restore\r\n\t\t */\r\n\t\tservice.restore = function() {\r\n\t\t\tif (service.navigationStack.length <= 0) {\r\n\t\t\t\treturn null;\r\n\t\t\t}\r\n\t\t\tvar topItem = top();\r\n\t\t\tif (topItem.path == $location.path()) {\r\n\t\t\t\tservice.navigationStack.pop();\r\n\t\t\t\treturn topItem.context;\r\n\t\t\t}\r\n\t\t\treturn null;\r\n\t\t};\r\n\r\n\t\t/**\r\n\t\t * Removes the last item inserted into navigation and sets its path into location path.\r\n\t\t *\r\n\t\t * @return {boolean} true, if there were items in navigation before the method started.\r\n\t\t * @method back\r\n\t\t */\r\n\t\tservice.back = function() {\r\n\t\t\tif (service.navigationStack.length <= 0) {\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t\tvar last = service.navigationStack.pop();\r\n\t\t\t$location.path(last.path);\r\n\r\n\t\t\treturn true;\r\n\t\t};\r\n\r\n\t\t/**\r\n\t\t * Removes all items stored inside navigation.\r\n\t\t *\r\n\t\t * @return {undefined}\r\n\t\t * @method clear\r\n\t\t */\r\n\t\tservice.clear = function() {\r\n\t\t\tservice.navigationStack = [];\r\n\t\t};\r\n\r\n\t\treturn service;\r\n\t} ]);\r\n\r\n}(window.angular));\r\n","(function(angular) {\r\n\t'use strict';\r\n\r\n\tangular.module('xpsui:services') \r\n\t.factory('xpsui:NotificationFactory', [ \"$rootScope\", function($rootScope){\r\n\t\t$rootScope.psuiNotification = ( $rootScope.psuiNotification || {} );\r\n\t\t$rootScope.psuiNotification.message = ( $rootScope.psuiNotification.message || [] );\r\n\t\t\r\n\t\tvar defaultMessage = {type:'info',text:'error',deletable : true, time:-1, timeout: null};\r\n\t\tvar factory = {};\r\n\t\t\r\n\t\tfactory.info = function (message){\r\n\t\t\tvar finalMessage = {};\r\n\t\t\tangular.copy(defaultMessage,finalMessage);\r\n\t\t\tif (typeof message == 'string'){\r\n\t\t\t\tfinalMessage.text = message;\r\n\t\t\t} else {\r\n\t\t\t\tif(message.text || message.translationCode){\r\n\t\t\t\t\tangular.extend(finalMessage,message);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tfinalMessage.text = \"!Nestrukturovana sprava!\" + JSON.stringify(message);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tfinalMessage.type = 'info';\r\n\t\t\t$rootScope.psuiNotification.message.push(finalMessage);\r\n\t\t}\r\n\t\t\r\n\t\tfactory.warn = function (message){\r\n\t\t\tvar finalMessage = {};\r\n\t\t\tangular.copy(defaultMessage,finalMessage);\r\n\t\t\tif (typeof message == 'string'){\r\n\t\t\t\tfinalMessage.text = message;\r\n\t\t\t} else {\r\n\t\t\t\tif(message.text || message.translationCode){\r\n\t\t\t\t\tangular.extend(finalMessage,message);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tfinalMessage.text = \"!Nestrukturovana sprava!\" + JSON.stringify(message);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tfinalMessage.type = 'warn';\r\n\t\t\t$rootScope.psuiNotification.message.push(finalMessage);\r\n\t\t}\r\n\t\t\r\n\t\tfactory.error = function (message){\r\n\t\t\tvar finalMessage = {};\r\n\t\t\tangular.copy(defaultMessage,finalMessage);\r\n\t\t\tif (typeof message == 'string'){\r\n\t\t\t\tfinalMessage.text = message;\r\n\t\t\t} else {\r\n\t\t\t\tif(message.text || message.translationCode){\r\n\t\t\t\t\tangular.extend(finalMessage,message);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tfinalMessage.text = \"!Nestrukturovana sprava!\" + JSON.stringify(message);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tfinalMessage.type = 'error';\r\n\t\t\t$rootScope.psuiNotification.message.push(finalMessage);\r\n\t\t}\r\n\t\t\r\n\t\tfactory.clear = function (){\r\n\t\t\tfor (var i = 0; i < $rootScope.psuiNotification.message.length; i++ ){\r\n\t\t\t\t$rootScope.psuiNotification.message[i].element.remove();\r\n\t\t\t}\r\n\t\t\t$rootScope.psuiNotification.message = [];\r\n\t\t}\r\n\t\t\r\n\t\treturn factory;\r\n\t}]);\r\n}(window.angular));","(function(angular) {\r\n\t'use strict';\r\n\r\n\tangular.module('xpsui:services')\r\n\t.factory('xpsui:ObjectTools', [function() {\r\n\t\tfunction ObjectTools() {\r\n\t\t}\r\n\r\n\t\tObjectTools.prototype.getSchemaFragmentByObjectPath = function(schema, path) {\r\n\t\t\tif (!schema) {\r\n\t\t\t\t// no schema\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tif (!path || !path.length || path.length < 1) {\r\n\t\t\t\t// no relevant path\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tvar propertiesFragment;\r\n\r\n\t\t\tif (schema.type === 'array') {\r\n\t\t\t\t// it is array def\r\n\t\t\t\tpropertiesFragment = schema.items;\r\n\t\t\t} else {\r\n\t\t\t\t// we assume schemafragment is object def\r\n\t\t\t\tpropertiesFragment = schema.properties;\r\n\t\t\t}\r\n\r\n\t\t\tif (!propertiesFragment) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tvar dotPosition = path.indexOf('.');\r\n\t\t\tif (dotPosition > -1) {\r\n\t\t\t\t// there is another fragment\r\n\t\t\t\tvar pathPropName = path.substring(0, dotPosition);\r\n\t\t\t\treturn this.getSchemaFragmentByObjectPath(propertiesFragment[pathPropName], path.substring(dotPosition+1));\r\n\t\t\t} else {\r\n\t\t\t\t// this is final fragment\r\n\t\t\t\treturn propertiesFragment[path];\r\n\t\t\t}\r\n\r\n\t\t};\r\n\r\n\t\treturn new ObjectTools();\r\n\t}]);\r\n\t\r\n}(window.angular));","(function(angular) {\n\t'use strict';\n\n\tangular.module('xpsui:services')\n\t/**\n\t *\n\t * @class xpsui:Objectlink2Factory\n\t * @module client\n\t * @submodule services\n\t */\n\t.factory('xpsui:Objectlink2Factory', ['xpsui:logging', '$timeout', '$translate', 'xpsui:SelectboxFactory', 'xpsui:DateUtil', '$parse',\n\tfunction(log, $timeout, $translate, selectbox, dateUtil, $parse) {\t\n\t\tfunction Objectlink2(element, options){\n\t\t\tselectbox.controller.call(this, element, options);\n\t\t}\n\n\t\tObjectlink2.prototype = Object.create(selectbox.controller.prototype);\n\n\t\tObjectlink2.prototype.controller = Objectlink2;\n\n\t\tObjectlink2.prototype.generateElement = function(data) {\n\t\t\tvar $item = angular.element('<div></div>'),\n\t\t\t\tfield \n\t\t\t;\n\n\t\t\tObjectlink2.renderElement(\n\t\t\t\t$item,\n\t\t\t\tthis.getDataset().getFieldsSchema(),\n\t\t\t\tdata\n\t\t\t);\n\n\t\t\treturn $item;\n\t\t};\n\n\n\t\t/**\n\t\t * Render visual content of element by fileds definition.\n\t\t *\n\t\t * @param {angular wrapped DOM element} wrapperElement\n\t\t * @param {object} fieldsSchema - map of fields schema fragments\n\t\t * @param {object} data - data to render\n\t\t *\n\t\t * @return {undefined}\n\t\t * @method renderElement\n\t\t * @static\n\t\t */\n\t\tObjectlink2.renderElement = function(wrapperElement, fieldsSchema, data) {\n\t\t\tif(!fieldsSchema){\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tvar field;\n\n\t\t\tfor (field in fieldsSchema) {\n\t\t\t\t// FIXME translations \n\t\t\t\tif (fieldsSchema[field]) {\n\t\t\t\t\tvar type = fieldsSchema[field].type,\n\t\t\t\t\t\tlabel = fieldsSchema[field].title,\n\t\t\t\t\t\tvalue = data.refData[field]\n\t\t\t\t\t;\n\n\t\t\t\t\tif (fieldsSchema[field].render && fieldsSchema[field].render.component == 'psui-datepicker') {\n\t\t\t\t\t\t//special hack to show date value correctly\n\t\t\t\t\t\ttype = 'date';\n\t\t\t\t\t}\n\n\t\t\t\t\twrapperElement.append(\n\t\t\t\t\t\tangular.element('<span title=\"' + label + '\">' +\n\t\t\t\t\t\t\tObjectlink2.getFormatedValue(type,value) +\n\t\t\t\t\t\t\t'</span>'\n\t\t\t\t\t\t)\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t}\n\n\t\t};\n\n\t\tObjectlink2.getFormatedValue = function(type, value){\n\t\t\tif (!value) {\n\t\t\t\treturn '';\n\t\t\t}\n\n\t\t\tvalue = (typeof value === 'object' && value.v) ? value.v : value;\n\t\t\tif (type === 'date'){\n\t\t\t\tvalue = dateUtil.formatter(value);\n\t\t\t}\n\t\t\treturn value;\n\t\t};\n\t\t\n\t\treturn {\n\t\t\tcontroller: Objectlink2,\n\t\t\tcreate : function(element, options) {\n\t\t\t\treturn new Objectlink2(element, options);\n\t\t\t},\n\t\t\trenderElement: Objectlink2.renderElement\n\t\t};\n\t}]);\n}(window.angular));\n","(function(angular) {\r\n\t'use strict';\r\n\r\n\tangular.module('xpsui:services')\r\n\t.factory('xpsui:RemoveButtonFactory', ['xpsui:logging', '$translate',   function(log, $translate) {\t\r\n\t\tvar keys = {\r\n\t            backspace: 8,\r\n\t            del: \t  46\r\n\t   };\r\n\r\n\t\tfunction RemoveButton($element, options){\r\n\t\t\tthis.$element = $element;\r\n\r\n\t\t\tthis.options = angular.extend({}, RemoveButton.DEFAULTS, options || {} );\r\n\t\t};\r\n\t\t\r\n\t\tRemoveButton.DEFAULTS = {\r\n\t\t\tinput: null,\r\n\t\t\tenabled: true,\r\n\t\t\tonClear: function(){}\r\n\t\t};\r\n\r\n\t\tRemoveButton.prototype.show = function(){\r\n\t\t\tthis.render();\r\n\t\t\tif(this.$actionEl){\r\n\t\t\t\tthis.$actionEl.addClass('x-show');\r\n\t\t\t}\r\n\t\t};\r\n\t\t\r\n\t\tRemoveButton.prototype.hide = function(){\r\n\t\t\tif(this.$actionEl){\r\n\t\t\t\tthis.$actionEl.removeClass('x-show');\r\n\t\t\t}\r\n\t\t};\r\n\r\n\t\tRemoveButton.prototype._handleKeyDown = function() {\r\n\t\t\tvar self = this;\r\n\r\n\t\t\t// bind a keydown handler\r\n\t\t\tif(this.options.input){\r\n\t\t\t\tthis.options.input.on('keydown', function(event) {\r\n\t\t\t\t\tswitch (event.keyCode) {\r\n\t\t\t\t\t\tcase keys.backspace:\r\n\t\t\t\t\t\t//case keys.del:\r\n\t\t\t\t\t\t\tevent.preventDefault();\r\n\t\t\t\t\t\t\tself._onClear();\r\n\t\t\t\t\t\t\tevent.stopPropagation();\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t};\r\n\r\n\t\tRemoveButton.prototype._onClear = function(){\r\n\t\t\tthis.options.onClear();\r\n\t\t\tthis.hide();\r\n\t\t}\r\n\r\n\t\tRemoveButton.prototype.renderInit = function(){\r\n\t\t\tvar self = this;\r\n\t\t\tif(!this.$actionEl && this.options.enabled){\r\n\t\t\t\tthis.$actionEl = angular.element('<div class=\"x-remove-button-action\"><span>' + $translate.instant('RemoveButton.remove') + '</span></div>');\r\n\t\t\t\tthis.$actionEl.on('click', function(){\r\n\t\t\t\t\tself._onClear();\r\n\t\t\t\t});\r\n\r\n\t\t\t\tself._handleKeyDown();\r\n\t\t\t\tthis.$element.append(this.$actionEl);\r\n\t\t\t\tthis.$element.addClass(\"x-remove-button\");\r\n\t\t\t}\r\n\t\t};\r\n\r\n\t\tRemoveButton.prototype.render = function(){\r\n\t\t\tthis.renderInit();\r\n\t\t};\r\n\r\n\r\n\t\treturn {\r\n\t\t\tcontroller: RemoveButton,\r\n\t\t\tcreate: function(element, options) {\r\n\t\t\t\treturn new RemoveButton(element, options);\r\n\t\t\t}\r\n\t\t}\r\n\t\r\n\t}]);\r\n}(window.angular));","(function(angular) {\r\n\t'use strict';\r\n\r\n\tangular.module('xpsui:services')\r\n\t.factory('xpsui:SchemaEditorService', [ '$http', '$rootScope', function($http, $rootScope) {\r\n\t\tvar service = {};\r\n\r\n\t\tservice.getSchemaList = function () {\r\n\t\t\treturn $http({\r\n\t\t\t\tmethod: 'GET',\r\n\t\t\t\turl: '/schema/ls/'\r\n\t\t\t})\r\n\t\t};\r\n\r\n\t\tservice.getFileContent = function (path) {\r\n\t\t\tvar pathContext = 'schema/get/' + path;\r\n\t\t\treturn $http({\r\n\t\t\t\tmethod: 'GET',\r\n\t\t\t\turl: pathContext,\r\n\t\t\t\tresponseType: 'text'\r\n\t\t\t})\r\n\t\t};\r\n\r\n\t\tservice.getPostContent = function (path, bytes) {\r\n\t\t\tvar pathContext = 'schema/replace/' + path;\r\n\t\t\treturn $http({\r\n\t\t\t\tmethod: 'PUT',\r\n\t\t\t\turl: pathContext,\r\n\t\t\t\tdata: bytes,\r\n\t\t\t\theaders: {\r\n\t\t\t\t\t'Content-Type': 'application/octet-stream'\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t};\r\n\r\n\r\n\t\treturn service;\r\n\t}]);\r\n\r\n}(window.angular));","(function(angular) {\n\t'use strict';\n\n\tangular.module('xpsui:services')\n\t/**\n\t * @class xpsui:SchemaUtil\n\t * @module client\n\t * @submodule services\n\t */\n\t.factory('xpsui:SchemaUtil', [  '$http', '$parse', 'xpsui:safeUrlEncoder', function($http, $parse, urlEncoder) {\n\n\t\tvar service = {};\n\n\t\t/**\n\t\t * Combines schemaUri and suffix to valid schema definition uri, does proper uri excaping\n\t\t * and returns $http promise to get data from server.\n\t\t *\n\t\t * Http object has cache enabled.\n\t\t *\n\t\t * @method getCompiledSchema\n\t\t * @static\n\t\t * @param schemaUri uri of schema\n\t\t * @param suffix\n\t\t *\n\t\t * @return {Object} fragment of schema\n\t\t *\n\t\t * @example\n\t\t * .getCompiledSchema('uri://registries/people/', 'view')\n\t\t * .success(...)\n\t\t * .error(...)\n\t\t */\n\t\tservice.getCompiledSchema = function(schemaUri, suffix) {\n\t\t\tvar _schemaUri = schemaUri;\n\n\t\t\t//FIXME this construction requires that schemaUri or suffix contains / at the end or beginning\n\t\t\tif (suffix) {\n\t\t\t _schemaUri = this.concatUri(schemaUri, suffix);\n\t\t\t}\n\n\t\t\treturn $http({\n\t\t\t\tmethod : 'GET',\n\t\t\t\tcache: true,\n\t\t\t\turl : '/schema/compiled/' + this.encodeUri(_schemaUri)\n\t\t\t});\n\n\t\t};\n\n\t\tservice.listBySchema = function(schemaUri) {\n\t\t\treturn $http({\n\t\t\t\tmethod : 'POST',\n\t\t\t\turl : '/search/'+service.encodeUri(schemaUri)\n\t\t\t});\n\t\t};\n\n\t\t/**\n\t\t * Gets schema defined by URI and extracts only required fields.\n\t\t *\n\t\t * @param {string} schema \te.g. uri//registries/componaies\n\t\t * @param {object} fields  \te.g. {\"name\": \"baseData.name\"}\n\t\t * @param {function(fields)} callback, where fields is map of fields schema fragments\n\t\t *\n\t\t * @return {undefined}\n\t\t * @method getFieldsSchemaFragment\n\t\t * @static\n\t\t * @async\n\t\t */\n\t\tservice.getFieldsSchemaFragment = function(schema, fields, callback) {\n\t\t\t// FIXME logging\n\t\t\tthis.getCompiledSchema(schema).success(function(data) {\n\t\t\t\tvar field, outFields = {};\n\n\t\t\t\tfor(field in fields){\n\t\t\t\t\tvar fieldProp = fields[field].split(\".\"),\n\t\t\t\t\t\t// FIXME very nasty way to handle object path to schema path transformation\n\t\t\t\t\t\tpath = [\n\t\t\t\t\t\t\t\"properties\",\n\t\t\t\t\t\t\tfieldProp[0],\n\t\t\t\t\t\t\t\"properties\",\n\t\t\t\t\t\t\tfieldProp[1]\n\t\t\t\t\t\t],\n\t\t\t\t\t\tgetter = $parse(path.join('.'))\n\t\t\t\t\t;\n\n\t\t\t\t\toutFields[field] = getter(data);\n\t\t\t\t}\n\n\t\t\t\tcallback(outFields);\n\t\t\t}).error(function(err) {\n\t\t\t\tcallback(null);\n\t\t\t});\n\t\t},\n\n\t\t/**\n\t\t * Generates empty object from schema\n\t\t *\n\t\t * @param {object} schema object to generate object by\n\t\t * @param {object} object that will be enriched by properties descripbed in schema\n\t\t */\n\t\tservice.generateObjectFromSchema = function generateObjectFromSchema(schema, obj) {\n\t\t\tvar _obj = obj;\n\t\t\tangular.forEach(schema.properties, function(value, key){\n\t\t\t\tif (value.type === 'object') {\n\t\t\t\t\t_obj[key] = {};\n\t\t\t\t\tgenerateObjectFromSchema(value, _obj[key]);\n\t\t\t\t} else if (value.type === 'array') {\n\t\t\t\t\t_obj[key] = [];\n\t\t\t\t} else {\n\t\t\t\t\tif (value.default) {\n\t\t\t\t\t\t_obj[key] = value.default;\n\t\t\t\t\t} else {\n\t\t\t\t\t\t_obj[key] = '';\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t};\n\n\t\t/**\n\t\t * Fills object in scopeToFill with path/value pairs form values parameter.\n\t\t *\n\t\t * @param {string} scopeToFill\tscope value to be filled.\n\t\t * @param {object} values\t\tvalues to fill, e.g. [ { 'path': 'model.obj.baseData.name', 'value': 'Peter' }, { 'path': 'model.obj.baseData.surName', 'value': 'Vaskovic' } ]\n\t\t *\n\t\t * @method fillObj\n\t\t */\n\t\tservice.fillObj = function fillObj(scopeToFill, values) {\n\t\t\tangular.forEach(values, function(value, key) {\n\t\t\t\t$parse(value.path).assign(scopeToFill, value.value);\n\t\t\t});\n\t\t};\n\n\t\t/**\n\t\t * concatenates schema uri and fragment in propper way\n\t\t */\n\t\tservice.concatUri = function(schemaUri, suffix) {\n\t\t\tconsole.log(schemaUri, suffix);\n\t\t\tvar _schemaUri = schemaUri || '';\n\t\t\tif (!/\\/$/.test(_schemaUri)) {\n\t\t\t\tif (/#/.test(_schemaUri)) {\n\t\t\t\t\t// does not end with slash\n\t\t\t\t\tif (!/#$/.test(_schemaUri)) {\n\t\t\t\t\t\t_schemaUri += '/';\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\t_schemaUri += '#';\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn _schemaUri + (suffix || '');\n\t\t};\n\n\t\t/**\n\t\t * encodes string to be uri compatible but not decoded by infrastructure itself\n\t\t */\n\t\tservice.encodeUri = function(schemaUri) {\n\t\t\treturn (urlEncoder.encode(schemaUri));\n\t\t};\n\n\t\t/**\n\t\t * decodes previously encoded string\n\t\t */\n\t\tservice.decodeUri = function(schemaUri) {\n\t\t\treturn (urlEncoder.decode(schemaUri));\n\t\t};\n\n\t\treturn service;\n\t} ]);\n\n}(window.angular));\n","(function(angular) {\n\t'use strict';\n\n\tangular.module('xpsui:services')\n\t.factory('xpsui:SecurityService', ['$http', '$rootScope','xpsui:SchemaUtil', function($http, $rootScope,schemaUtilFactory) {\n\t\tvar service = {};\n\n\t\tservice.getLogin = function(user, password) {\n\t\t\treturn $http({\n\t\t\t\tmethod : 'POST',\n\t\t\t\turl : '/login/',\n\t\t\t\tdata : {\n\t\t\t\t\tlogin : user,\n\t\t\t\t\tpassword : password\n\t\t\t\t}\n\t\t\t});\n\t\t};\n\t\tservice.selectProfile=function(profileId){\n\t\t\treturn $http({\n\t\t\t\tmethod : 'POST',\n\t\t\t\turl : '/user/profile/',\n\t\t\t\tdata : {\n\t\t\t\t\tprofileId : profileId\n\t\t\t\t}\n\t\t\t});\n\t\t};\n\n\t\tservice.getCurrentUser = function() {\n\t\t\treturn $http({\n\t\t\t\tmethod : 'GET',\n\t\t\t\turl : '/user/current'\n\t\t\t});\n\t\t};\n\n\t\tservice.getResetPassword = function(userId) {\n\t\t\treturn $http({\n\t\t\t\tmethod : 'POST',\n\t\t\t\turl : '/resetPassword/',\n\t\t\t\tdata : {\n\t\t\t\t\tuserId : userId\n\t\t\t\t}\n\t\t\t});\n\t\t};\n\n\t\tservice.getChangePassword = function(currentPassword, newPassword) {\n\t\t\treturn $http({\n\t\t\t\tmethod : 'POST',\n\t\t\t\turl : '/changePassword',\n\t\t\t\tdata : {\n\t\t\t\t\tcurrentPassword : currentPassword,\n\t\t\t\t\tnewPassword : newPassword\n\t\t\t\t}\n\t\t\t});\n\t\t};\n\n\t\tservice.getSecurityGroups = function() {\n\t\t\tvar entityUri='uri://registries/security#groupmaster/new';\n\t\t\treturn $http({\n\t\t\t\tmethod : 'POST',\n\t\t\t\turl : '/search/'+schemaUtilFactory.encodeUri(entityUri),\n\t\t\t});\n\n\t\t};\n\t\tservice.getForgotenToken = function(email,captcha) {\n\t\t\treturn $http({\n\t\t\t\tmethod : 'POST',\n\t\t\t\turl : '/forgotten/token/',\n\t\t\t\tdata : {\n\t\t\t\t\temail : email,\n\t\t\t\t\tcaptcha: captcha\n\t\t\t\t}\n\t\t\t});\n\t\t};\n\n\t\tservice.getForgotenPasswordReset = function(token) {\n\t\t\treturn $http({\n\t\t\t\tmethod : 'GET',\n\t\t\t\turl : '/forgotten/reset/'+token\n\t\t\t});\n\t\t};\n\t\tservice.getCaptchaKey = function(token) {\n\t\t\treturn $http({\n\t\t\t\tmethod : 'GET',\n\t\t\t\turl : '/captcha/sitekey/'\n\t\t\t});\n\t\t};\n\n\t\tservice.getLogout = function() {\n\t\t\treturn $http({\n\t\t\t\tmethod : 'GET',\n\t\t\t\turl : '/logout/',\n\t\t\t});\n\t\t};\n\n\t\tservice.getSecurityPermissions = function() {\n\n\t\t\treturn $http({\n\t\t\t\tmethod : 'GET',\n\t\t\t\turl : '/security/permissions',\n\n\t\t\t});\n\n\t\t};\n\t\tservice.getSecurityProfiles = function() {\n\n\t\t\treturn $http({\n\t\t\t\tmethod : 'GET',\n\t\t\t\turl : '/security/profiles',\n\n\t\t\t});\n\n\t\t};\n\t\tservice.getSecuritySearchSchemas= function() {\n\n\t\t\treturn $http({\n\t\t\t\tmethod : 'GET',\n\t\t\t\turl : '/security/search/schemas',\n\t\t\t});\n\n\t\t};\n\t\tservice.getUserPermissions = function(userId) {\n\n\t\t\treturn $http({\n\t\t\t\tmethod : 'GET',\n\t\t\t\turl : '/user/permissions/' + userId\n\t\t\t});\n\n\t\t};\n\n\t\tservice.updateUserSecurity = function(userId,loginName,email,profiles) {\n\n\t\t\treturn $http({\n\t\t\t\tmethod : 'POST',\n\t\t\t\turl : '/user/security/update',\n\t\t\t\tdata : {\n\t\t\t\t\tuserId : userId,\n\t\t\t\t\tloginName: loginName,\n\t\t\t\t\temail: email,\n\t\t\t\t\tprofiles : profiles\n\t\t\t\t}\n\t\t\t});\n\t\t};\n\n\t\tservice.updateProfileSecurity = function(profileId,profileName, permissions, groups,crits) {\n\n\t\t\treturn $http({\n\t\t\t\tmethod : 'POST',\n\t\t\t\turl : '/security/profile/update',\n\t\t\t\tdata : {\n\t\t\t\t\tprofileId : profileId,\n\t\t\t\t\tprofileName: profileName,\n\t\t\t\t\tpermissions : permissions,\n\t\t\t\t\tgroups : groups,\n\t\t\t\t\tcrits: crits\n\t\t\t\t}\n\t\t\t});\n\t\t};\n\n\t\tservice.updateSecurityGroup = function(oid, groupName, groupId, permissions, parent) {\n\n\t\t\treturn $http({\n\t\t\t\tmethod : 'POST',\n\t\t\t\turl : '/group/security/update',\n\t\t\t\tdata : {\n\t\t\t\t\toid : oid,\n\t\t\t\t\tpermissions : permissions,\n\t\t\t\t\tgroupName : groupName,\n\t\t\t\t\tgroupId : groupId,\n\t\t\t\t\tparent : parent\n\t\t\t\t}\n\t\t\t});\n\n\t\t};\n\n\t\t/**\n\t\t * checks if current user has all required permissions\n\t\t */\n\t\tservice.hasPermissions = function(requiredPermissions) {\n\t\t\tif (!requiredPermissions || requiredPermissions.length < 1) {\n\t\t\t\t// there are no permissions to check, so we have\n\t\t\t\t// permission\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\tif ($rootScope.security.currentUser && $rootScope.security.currentUser.systemCredentials && $rootScope.security.currentUser.systemCredentials.login &&\n\t\t\t $rootScope.security.currentUser.systemCredentials.permissions) {\n\t\t\t\tfor ( var i in requiredPermissions) {\n\t\t\t\t\tif ($rootScope.security.currentUser.systemCredentials.permissions[requiredPermissions[i]] !== true) {\n\t\t\t\t\t\t// missing permission\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\treturn true;\n\t\t\t} else {\n\t\t\t\t// non valid current user, no permissions\n\t\t\t\treturn false;\n\t\t\t}\n\t\t};\n\n\t\treturn service;\n\t} ]);\n\n}(window.angular));\n","(function(angular) {\n\t'use strict';\n\n\tangular.module('xpsui:services')\n\t.factory('xpsui:SelectboxFactory', ['xpsui:logging', '$timeout', '$translate','xpsui:SelectDataFactory',  function(log, $timeout, $translate, datafactory) {\t\n\t\tvar keys = {\n\t            tab:      9,\n\t            backspace:8,\n\t            enter:    13,\n\t            escape:   27,\n\t            space:    32,\n\t            pageup:   33,\n\t            pagedown: 34,\n\t            end:      35,\n\t            home:     36,\n\t            left:     37,\n\t            up:       38,\n\t            right:    39,\n\t            down:     40,\n\t            del: \t  46, \n\t            asterisk: 106\n\t   };\n\n\t\tfunction Selectbox($element, options){\n\t\t\tthis.$element = $element;\n\t\t\tthis.$inputElement  = null;\n\t\t\tthis.dataset = null;\n\t\t\tthis.isRendered = false;\n\t\t\tthis.$searchInput = null;\n\t\t\t// flag use for paging\n\t\t\tthis._startPaging = false;\n\t\t\tthis.selected = null;\n\n\t\t\tthis.options = angular.extend({}, Selectbox.DEFAULTS, options || {} );\n\t\t};\n\t\t\n\t\tSelectbox.DEFAULTS = {\n\t\t\t// show search input\n\t\t\tuseSearchInput: true,\n\t\t\t// shearch input keydown - waiting time\n\t\t\tfilterTimeout: 300,\n\t\t\t// info line:\n\t\t\tshowInfo: true,\n\t\t\t// callback\n\t\t\tonSelected: function(value){},\n\t\t\t// onBlur close\n\t\t\tcloseOnBlur: true,\n\t\t\t// paging scroll bufer\n\t\t\tpagingScrollBuffer: 40,\n\t\t\t//paging items buffer\n\t\t\tpagingItemsBuffer: 10,\n\t\t\t// allow custom text which can not be in collection\n\t\t\tfreeTextMode: false\n\t\t};\n\t\t\n\t\tSelectbox.prototype.getElement =  function(){\n\t\t\treturn this.$element;\n\t\t};\n\t\t\n\t\tSelectbox.prototype.setOptions = function(options){\n\t\t\tangular.extend(this.options, options || {});\n\t\t};\n\n\t\tSelectbox.prototype.setInput = function(element){\n\t\t\tvar self = this;\n\t\t\tthis.$inputElement = element;\n\t\t\t\n\t\t\tthis._bindInputEventHandlers();\n\n\t\t\treturn this;\n\t\t};\n\n\t\tSelectbox.prototype._bindInputEventHandlers = function() {\n\t\t\tvar self = this;\n\n\t\t\tthis.$inputElement.on('keypress', function(event) {\n\n\t\t\t\tif(!self.options.freeTextMode){\n\t\t\t\t\tevent.preventDefault();\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tif( self.options.useSearchInput && event.keyCode >= 48 ){\n\t\t\t\t\tself.dropdown && self.dropdown.open();\n\n\t\t\t\t\tif(self.$searchInput){\n\t\t\t\t\t\tvar keychar = self.getKeyChar(event);\n\t\t\t\t\t\tkeychar && self.$searchInput.val(keychar);\n\t\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\tself.actionFilter(self.$searchInput.val());\n\t\t\t\t\t\tself.$searchInput[0].blur();\n\t\t\t\t\t\tself.$searchInput[0].focus();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tthis.$inputElement.on('keydown', function(event) {\n\t\t\t\tif (self.options.useSearchInput && \n\t\t\t\t\t(event.keyCode === keys.backspace\n\t\t\t\t\t|| event.keyCode === keys.del)\n\t\t\t\t) {\n\t\t\t\t\tevent.preventDefault();\n\t\t\t\t};\n\t\t\t});\n\t\t}\n\n\t\tSelectbox.prototype.getKeyChar = function(event) {\n\t\t\tif (event.which == null) {\n\t\t\t\treturn String.fromCharCode(event.keyCode) // IE\n\t\t\t} else if (event.which!=0 && event.charCode!=0) {\n\t\t\t\treturn String.fromCharCode(event.which)   // the rest\n\t\t\t} else {\n\t\t\t\treturn null // special key\n\t\t\t}\n\t\t}\n\n\n\t\tSelectbox.prototype.getInput = function(){\t\n\t\t\treturn this.$inputElement;\n\t\t};\n\n\t\tSelectbox.prototype.setDataset = function(dataset){\n\t\t\tvar self = this;\n\t\t\tthis.dataset = dataset;\n\n\t\t\tthis.dataset.setOptions({\n\t\t\t\tbeforeLoad: function(dataSet){\n\t\t\t\t\tself.onBeforeLoad();\n\t\t\t\t},\n\t\t\t\tloaded: function(dataSet, newData){\n\t\t\t\t\tself.onLoaded(newData);\n\t\t\t\t},\n\t\t\t\treset: function(){\n\t\t\t\t\tself.onReset();\n\t\t\t\t}\n\t\t\t});\n\n\t\t\treturn this;\n\t\t};\n\n\t\tSelectbox.prototype.getDataset = function(dataset){\n\t\t\treturn this.dataset ;\n\t\t};\n\n\t\tSelectbox.prototype.setDropdown = function(dropdown){\n\t\t\tvar self = this;\n\t\t\tthis.dropdown = dropdown;\n\t\t\t\n\t\t\tdropdown.afterOpen = function(){\n\t\t\t\tself.open();\n\t\t\t};\n\t\t};\n\n\t\t// open selectbox\n\t\tSelectbox.prototype.open = function(){\n\t\t\tvar isRendered = this.isRendered;\n\n\t\t\tthis.renderTo(this.dropdown.getContentElement());\n\n\t\t\tif(this.options.useSearchInput && this.$searchInput.val()){\n\t\t\t\tthis.$searchInput.val('');\n\t\t\t\tthis.doReset();\n\t\t\t\tthis.doLoad();\n\t\t\t}\n\n\t\t\tif(this.options.useSearchInput){\n\t\t\t\tthis.$searchInput[0].focus();\n\t\t\t} else if(!this.options.freeTextMode) {\n\t\t\t\tthis.$selectboxElement[0].focus();\n\t\t\t}\n\t\t\t\t\t\t\t\n\t\t\tthis.$itemsElement[0].scrollTop = 0;\n\t\t\tthis.$itemsElement[0].scrollLeft = 0;\t\n\t\t\tthis.unselectItem();\n\t\t};\n\n\t\tSelectbox.prototype.loading = function(){\n\t\t\tthis.dataset.getData();\n\t\t};\n\n\n\t\tSelectbox.prototype.unselectItem = function(){\n\t\t\tangular.element(\n\t\t\t\tthis.$element[0].querySelector('.x-selected')\n\t\t\t).removeClass('x-selected');\n\t\t};\n\n\t\tSelectbox.prototype.selectItem = function($el){\n\t\t\tthis.unselectItem();\n\t\t\tthis.selected = $el.data('index');\n\t\t\t$el.addClass('x-selected');\n\n\t\t\tconsole.log('selected: ' + this.selected );\n\t\t\tconsole.log('item min =<' + (this.dataset.data.length - this.options.pagingItemsBuffer));\n\t\t\tif( this.selected >= this.dataset.data.length - this.options.pagingItemsBuffer ){\n\t\t\t\tthis.doPaging();\n\t\t\t} \n\t\t};\n\n\t\t// container where selectbox is rendered. \n\t\t// e.g. dropdown popup\n\t\tSelectbox.prototype.setRootElement = function(element){\n\t\t\treturn this.$rootElement = element;\n\t\t};\n\n\t\tSelectbox.prototype.getRootElement = function(element){\n\t\t\treturn this.$rootElement;\n\t\t};\n\t\t\n\t\tSelectbox.prototype.renderInit = function(){\n\t\t\tvar self = this;\n\n\t\t\tif(!this.isRendered){\n\t\t\t\tthis.isRendered = true;\n\t\t\t\t\n\t\t\t\tthis.$selectboxElement = angular.element('<div class=\"x-selectbox\"></div>');\n\t\t\t\tthis.$selectboxElement.attr('tabindex', -1);\n\t\t\t\tthis._bindEventHandlers(this.$selectboxElement);\n\n\t\t\t\tthis.renderSearch();\n\n\t\t\t\tthis.$itemsElement = angular.element('<div class=\"x-selectbox-items\"></section>');\n\t\t\t\tthis.$selectboxElement.append(this.$itemsElement);\n\t\t\t\tthis._handleScrollEvent();\n\n\t\t\t\tthis.renderInfo();\n\n\t\t\t\tthis.getRootElement().append(this.$selectboxElement);\n\n\t\t\t\tthis.doLoad();\n\t\t\t}\n\t\t};\n\n\t\tSelectbox.prototype._handleScrollEvent = function(){\n\t\t\tvar self = this;\n\t\t\tthis.$itemsElement.on('scroll',function(){\n\t\t\t\tif (this.scrollHeight - this.scrollTop <= this.offsetHeight + self.options.pagingScrollBuffer) {\n\t\t\t\t\tself.doPaging();\n\t\t\t\t}\n\t\t\t});\n\t\t};\n\n\t\tSelectbox.prototype.doPaging = function(){\n\t\t\tif(!this._startPaging){\n\t\t\t\tthis._startPaging = true;\n\t\t\t\tthis.doLoad();\n\t\t\t}\n\t\t};\n\n\t\tSelectbox.prototype.doLoad = function(){\n\t\t\tthis.dataset.load();\n\t\t};\n\n\t\tSelectbox.prototype.doReset = function(){\n\t\t\tthis.dataset.reset();\n\t\t};\n\n\t\tSelectbox.prototype.onBeforeLoad = function(){\n\t\t\tthis.setInfoText($translate.instant('psui.selectbox.loading'));\n\t\t\tthis.setInfoNumFromText('');\n\t\t\tthis.$element.addClass('x-loading');\n\t\t};\n\n\t\tSelectbox.prototype.onLoaded = function(newData){\n\t\t\tthis.renderItems(newData);\n\t\t\tthis.$element.removeClass('x-loading');\n\t\t\tthis.setInfoNum();\n\t\t\tthis._startPaging = false;\n\t\t};\n\n\t\tSelectbox.prototype.onReset = function(){\n\t\t\tthis.selected = null;\n\t\t\tthis._startPaging = false;\n\t\t\tif( this.$itemsElement.length ){\n\t\t\t\tthis.$itemsElement.empty();\n\t\t\t}\n\t\t};\n\n\t\tSelectbox.prototype.renderSearch = function(){\n\t\t\tif(this.options.useSearchInput){\n\t\t\t\tthis.$element.addClass('x-selectobx-search-enabled');\n\t\t\t\tvar $header = angular.element('<header></header>');\n\t\t\t\tthis.$searchInput = angular.element('<input></input>');\n\t\t\t\tthis.$searchInput.attr('tabindex', -1);\n\t\t\t\tthis._bindEventHandlers(this.$searchInput);\n\t\t\t\t$header.append(this.$searchInput);\n\t\t\t\tthis.$selectboxElement.append($header);\n\t\t\t}\n\t\t};\n\n\t\tSelectbox.prototype.renderInfo = function(){\n\t\t\tif(this.options.showInfo){\n\t\t\t\tvar $footer= angular.element('<footer></footer>');\n\n\t\t\t\tthis.$infoTextElement = angular.element('<span></span>');\n\t\t\t\t$footer.append(this.$infoTextElement);\n\t\t\t\tthis.$infoElement = angular.element('<span></span>');\n\t\t\t\t$footer.append(this.$infoElement);\n\t\t\t\tthis.$selectboxElement.append($footer);\n\t\t\t}\n\t\t};\n\n\t\tSelectbox.prototype.setInfoText = function(text){\n\t\t\tif (this.$infoTextElement) {\n\t\t\t\tthis.$infoTextElement.text(text);\n\t\t\t}\n\t\t};\n\n\t\tSelectbox.prototype.setInfoNumFromText = function(value){\n\t\t\tif (this.$infoElement) {\n\t\t\t\tthis.$infoElement.text(value);\n\t\t\t}\n\t\t};\n\t\t\n\t\tSelectbox.prototype.setInfoNum = function(){\n\t\t\tif (this.$infoElement) {\n\t\t\t\tthis.setInfoText($translate.instant('psui.selectbox.rows'));\n\t\t\t\tthis.$infoElement.text(this.dataset.data.length + \n\t\t\t\t\t(!this.dataset.loadDone ? \"+\" : \"\")\n\t\t\t\t);\n\t\t\t}\n\t\t};\n\n\t\tSelectbox.prototype.renderItems = function(data){\n\t\t\tvar self = this;\n\t\t\tvar offset = this.dataset.getOffset();\n\t\t\tfor (var i = 0; i < data.length; i++) {\n\t\t\t\tvar $item = this.generateElement(data[i]);\n\t\t\t\t$item.addClass('x-item');\n\t\t\t\t$item.data('index', offset++);\n\t\t\t\t$item.attr('tabindex', -1);\n\t\t\t\t\n\t\t\t\tthis.$itemsElement.append($item);\n\t\t\t\tthis._bindEventHandlers($item);\n\t\t\t}\n\t\t};\n\n\t\tSelectbox.prototype.generateElement = function(item) {\n\t\t\tif (typeof item === 'string') {\n\t\t\t\treturn angular.element('<div>' + item + '</div>');\n\t\t\t} else if ((typeof item === 'object') && (typeof item.k !== 'undefined') && (typeof item.v !== 'undefined')) {\n\t\t\t\treturn angular.element('<div>'+ item.v + '</div>');\n\t\t\t}\n\t\t};\n\n\t\tSelectbox.prototype._bindEventHandlers = function($items) {\n\t\t\tvar self = this;\n\n\t\t\t// bind a mouseover handler\n\t\t\t$items.on('mouseover', function(e) {\n\t\t\t\treturn self._handleMouseover(angular.element(this), e);\n\t\t\t});\n\n\n\t\t\t// bind a click handler\n\t\t\t$items.on('click', function(e) {\n\t\t\t\treturn self._handleClick(angular.element(this), e);\n\t\t\t});\n\n\t\t\t// bind a keydown handler\n\t\t\t$items.on('keydown', function(e) {\n\t\t\t\treturn self._handleKeyDown(angular.element(this), e);\n\t\t\t});\n\n\t\t\t// bind a focus handler\n\t\t\t$items.on('focus', function(e) {\n\t\t\t\treturn self._handleFocus(angular.element(this), e);\n\t\t\t});\n\n\t\t\t// bind a blur handler\n\t\t\t$items.on('blur', function(e) {\n\t\t\t\treturn self._handleBlur(angular.element(this), e);\n\t\t\t});\n\t\t};\n\n\t\tSelectbox.prototype._handleFocus = function($el, event){\n\t\t\tthis.dropdown && this.dropdown.cancelClosing();\n\t\t\tif($el.hasClass('x-item')){\n\t\t\t\tthis.selectItem($el);\n\t\t\t}\n\t\t};\n\t\t\n\t\tSelectbox.prototype._handleBlur = function($el, event){\n\t\t\tif(this.options.closeOnBlur){\n\t\t\t\tthis.dropdown && this.dropdown.close();\t\n\t\t\t}\n\t\t};\n\n\t\tSelectbox.prototype._handleMouseover = function($el, event){\n\t\t\tif($el.hasClass('x-item')){\n\t\t\t\t//this.selectItem($el);\n\t\t\t\t$el[0].focus();\n\t\t\t}\n\t\t};\n\n\t\tSelectbox.prototype._handleClick = function($el, event){\n\t\t\tif($el.hasClass('x-item')){\n\t\t\t\tthis.selectItem($el);\n\t\t\t\tthis.actionSelected();\n\t\t\t}\n\t\t\tevent.stopPropagation();\n\t\t};\n\n\t\tSelectbox.prototype._fixScroller = function($el){\n\t\t\tvar selectedItem = $el[0];\n\t\t\tvar itemsElement = this.$itemsElement[0];\n\t\t\t\n\t\t\t// fix from top\n\t\t\tif( selectedItem.offsetTop < itemsElement.scrollTop ) {\n\t\t\t\titemsElement.scrollTop = selectedItem.offsetTop;\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// fix form bottom\n\t\t\tvar bottomBorderSelectedItem = selectedItem.offsetTop + selectedItem.offsetHeight;\n\t\t\tvar bottomBorderItemsEl = itemsElement.scrollTop + itemsElement.clientHeight;\n\n\t\t\tif( bottomBorderSelectedItem > bottomBorderItemsEl ) {\n\t\t\t\titemsElement.scrollTop += bottomBorderSelectedItem - bottomBorderItemsEl;\n\t\t\t}\n\t\t};\n\n\t\tSelectbox.prototype._handleKeyDown = function($el, event){\n\t\t\tvar self = this;\n\n\t\t\tswitch (event.keyCode) {\n\t\t\t\tcase keys.up:\n\t\t\t\t\tevent.preventDefault();\n\n\t\t\t\t\tif(this.selected === null) {\n\t\t\t\t\t\tthis.selected = this.dataset.data.length;\n\t\t\t\t\t} else if(this.selected <= 0 ){\n\t\t\t\t\t\treturn \"\";\n\t\t\t\t\t}\n\n\t\t\t\t\tvar $selectedItem = angular.element(this.$itemsElement.children()[this.selected - 1]);\n\t\t\t\t\tthis.selectItem($selectedItem);\n\t\t\t\t\tthis._fixScroller($selectedItem);\n\n\t\t\t\t\tevent.stopPropagation();\n\t\t\t\t\tbreak;\n\t\t\t\tcase keys.down: //keys.down\n\t\t\t\t\tevent.preventDefault();\n\n\t\t\t\t\tif(this.selected === null) {\n\t\t\t\t\t\tthis.selected = -1;\n\t\t\t\t\t} else if(this.selected + 1 >= this.dataset.data.length ){\n\t\t\t\t\t\treturn \"\";\n\t\t\t\t\t}\n\n\t\t\t\t\tvar $selectedItem = angular.element(this.$itemsElement.children()[this.selected + 1]);\n\t\t\t\t\tthis.selectItem($selectedItem);\n\t\t\t\t\tthis._fixScroller($selectedItem);\n\n\t\t\t\t\tevent.stopPropagation();\n\t\t\t\t\tbreak;\n\t\t\t\tcase keys.enter: \n\t\t\t\t\tthis.actionSelected();\n\t\t\t\t\tevent.stopPropagation();\n\t\t\t\t\tbreak\n\t\t\t\tcase keys.escape:\n\t\t\t\t\tthis.getInput()[0].focus();\n\t\t\t\t\tevent.stopPropagation();\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tif(this.$searchInput && $el[0] === this.$searchInput[0]) {\n\t\t\t\t\t\tthis.__filterTimeout && $timeout.cancel(this.__filterTimeout);\n\n\t\t\t\t\t\tthis.__filterTimeout = $timeout(function(){\n\t\t\t\t\t\t\tself.actionFilter(self.$searchInput.val());\n\t\t\t\t\t\t}, this.options.filterTimeout);\n\t\t\t\t\t\tevent.stopPropagation();\n\t\t\t\t\t}\n\t\t\t}\n\t\t};\n\n\t\tSelectbox.prototype.actionFilter = function(value){\n\t\t\tthis.dataset.setSearchValue(value);\n\t\t\tthis.doLoad();\n\t\t};\n\n\n\t\t// the item is selected\n\t\tSelectbox.prototype.actionSelected = function(){\n\t\t\tif(this.selected !== null){\n\t\t\t\tvar val = this.dataset.data[this.selected];\n\t\t\t\tthis.options.onSelected(val);\n\t\t\t}\n\t\t\t\n\t\t\tthis.$inputElement[0].focus();\n\t\t};\n\n\t\tSelectbox.prototype.renderTo = function(element){\n\t\t\tthis.setRootElement(element);\n\t\t\tthis.render();\n\t\t};\n\t\t\t\n\t\tSelectbox.prototype.render = function(){\n\t\t\tthis.renderInit();\n\t\t};\n\t\t\n\n\t\treturn {\n\t\t\tcontroller: Selectbox,\n\t\t\tcreate : function(element, options) {\n\t\t\t\treturn new Selectbox(element, options);\n\t\t\t}\n\t\t}\n\t\n\t}]);\n}(window.angular));","(function(angular) {\n\t'use strict';\n\n\tangular.module('xpsui:services')\n\t.factory('xpsui:SelectDataFactory', ['xpsui:logging', '$timeout', '$translate','$http', '$parse', 'xpsui:SchemaUtil',  'xpsui:HttpHandlerFactory',\n\tfunction(log, $timeout, $translate, $http,$parse, schemaUtil, httpHandlerFactory) {\n\t\t/**\n\t\t * DataSet\n\t\t */\n\n\t\t// FIXME change to use queryfilter \n\t\tfunction DataSet(store, options){\n\t\t\tthis.store = store;\n\t\t\tthis.options = angular.extend({}, DataSet.DEFAULTS, options || {} );\n\n\t\t\tthis.data = [];\n\n\t\t\t// offset of paging  \n\t\t\t// e.g. n * this.option.limit\n\t\t\tthis.offset = 0;\n\t\t\t// serach value\n\t\t\tthis.serachValue = null;\n\t\t\t// load paging\n\t\t\tthis.loadDone = false;\n\t\t};\n\n\t\tDataSet.DEFAULTS = {\n\t\t\tlimit: 16,\n\t\t\tbeforeLoad: function(dataSet){},\n\t\t\tloaded: function(dataSet, newData){},\n\t\t\treset: function(){},\n\t\t};\n\n\t\tDataSet.prototype.setOptions = function(options){\n\t\t\tthis.options = angular.extend({}, this.options, options || {} );\n\t\t\treturn this;\n\t\t};\n\n\n\t\t// get limit plus one\n\t\tDataSet.prototype.getLimit = function(value){\n\t\t\treturn this.options.limit + 1;\n\t\t};\n\n\t\tDataSet.prototype.getOffset = function(value){\n\t\t\treturn this.offset * this.options.limit;\n\t\t};\n\n\t\tDataSet.prototype.getSearchValue = function(){\n\t\t\treturn this.serachValue;\n\t\t};\n\n\t\tDataSet.prototype.setSearchValue = function(value){\n\t\t\tthis.reset();\n\t\t\tthis.serachValue = value;\n\t\t\treturn this;\n\t\t};\n\n\t\tDataSet.prototype.reset = function(){\n\t\t\tthis.data = [];\n\t\t\tthis.loadDone = false;\n\t\t\tthis.offset = 0;\n\t\t\tthis.serachValue = null;\n\t\t\tthis.options.reset();\n\t\t\treturn this;\n\t\t};\n\n\t\tDataSet.prototype.load = function(){\n\t\t\tvar self = this;\n\t\t\tif (!this.loadDone) {\n\t\t\t\t\n\t\t\t\tthis.options.beforeLoad(this);\n\n\t\t\t\tthis.store.load(this, function(data){\n\t\t\t\t\tself.loaded(data);\n\t\t\t\t});\n\t\t\t}\n\t\t};\n\n\t\tDataSet.prototype.loaded = function(data){\n\t\t\tif(data.length <= this.options.limit){\n\t\t\t\tthis.loadDone = true;\n\t\t\t} else {\n\t\t\t\t// remove limit plus one element\n\t\t\t\tdata.pop();\n\t\t\t}\n\t\t\t\n\t\t\tthis.data = this.data.concat(data);\n\t\t\tthis.options.loaded(this,data);\n\t\t\tthis.offset++;\n\t\t}\n\n\t\t/**\n\t\t * ArrayStore\n\t\t */\n\n\t\tfunction ArrayStore(){\n\t\t\tthis.data = [];\n\t\t};\n\n\t\tArrayStore.prototype.setData = function(data, translateCode){\n\t\t\tif (translateCode) {\n\t\t\t\t// there are transCodes\n\t\t\t\tfor (var i = 0; i < data.length; i++) {\n\t\t\t\t\tthis.data.push({\n\t\t\t\t\t\tv: $translate.instant(translateCode[i]),\n\t\t\t\t\t\tk: data[i]\n\t\t\t\t\t})\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tfor (var i = 0; i < data.length; i++) {\n\t\t\t\t\tthis.data.push({\n\t\t\t\t\t\tv: data[i],\n\t\t\t\t\t\tk: data[i]\n\t\t\t\t\t})\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\n\t\tArrayStore.prototype.getValueByKey = function(key){\n\t\t\tfor (var i = 0; i < this.data.length; i++) {\n\t\t\t\tif(this.data[i]['k'] === key){\n\t\t\t\t\treturn this.data[i]['v'];\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn false;\n\t\t};\n\n\t\tArrayStore.prototype.load = function(dataset, callback){\n\t\t\tvar self = this;\n\n\t\t\tthis.timeout && $timeout.cancel(this.timeout);\n\n\t\t\tthis.timeout = $timeout(function(){\n\t\t\t\tvar data = [];\n\n\t\t\t\tvar regExp = new RegExp('^' + (dataset.getSearchValue() || '') ,'i');\n\t\t\t\tfor (var i = 0; i < self.data.length; ++i) {\n\t\t\t\t\tif (regExp.test(self.data[i].v)) {\n\t\t\t\t\t\tdata.push(self.data[i]);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tcallback(\n\t\t\t\t\tdata.slice(dataset.getOffset(), dataset.getLimit() + dataset.getOffset())\n\t\t\t\t);\n\t\t\t}, 0);\n\t\t};\n\n\t\t/**\n\t\t *\n\t\t */\n\t\tfunction ObjectDataSet(store, options){\n\t\t\tDataSet.call(this, store, options);\n\t\t}\n\n\t\tObjectDataSet.prototype = Object.create(DataSet.prototype);\n\n\t\tObjectDataSet.prototype.loaded = function(data) {\n\t\t\tif(data.length <= this.options.limit){\n\t\t\t\tthis.loadDone = true;\n\t\t\t} else {\n\t\t\t\t// remove limit plus one element\n\t\t\t\tdata.pop();\n\t\t\t}\n\t\t\t\n\t\t\tthis.data = this.data.concat(data);\n\t\t\tthis.options.loaded(this,data);\n\t\t\tthis.offset++;\n\t\t};\n\t\t\n\t\tObjectDataSet.prototype.getFieldsSchema = function(index){\n\t\t\treturn this.store.fields;\n\t\t};\n\n\n\t\t/**\n\t\t * ObjectLinkStore\n\t\t */\n\t\tfunction ObjectLinkStore(options){\n\t\t\tthis.options = angular.extend({}, ObjectLinkStore.DEFAULTS, options || {} );\n\t\t\tthis.schema = {};\n\t\t\tthis.crits = null;\n\t\t\tthis.fields = null;\n\t\t\tthis.http = null;\n\t\t}\n\n\t\tObjectLinkStore.DEFAULTS = {\n\t\t\tsearchCondition: 'starts',\n\t\t\torderBySort: 'asc'\n\t\t};\n\n\t\tObjectLinkStore.prototype.initFieldsSchema = function(callback){\n\t\t\tvar self = this;\n\t\t\tif(!this.fields){\n\t\t\t\tschemaUtil.getFieldsSchemaFragment(\n\t\t\t\t\tthis.schema.schema, \n\t\t\t\t\tthis.schema.fields, \n\t\t\t\t\tfunction(fields){\n\t\t\t\t\t\tself.fields = fields;\n\t\t\t\t\t\tcallback();\n\t\t\t\t\t}\n\t\t\t\t);\n\n\t\t\t\treturn ;\n\t\t\t}\n\t\t\tcallback();\n\t\t};\n\n\t\tObjectLinkStore.prototype.getHttp = function(){\n\t\t\tif(!this.http){\n\t\t\t\tthis.http = httpHandlerFactory.newHandler();\n\t\t\t}\n\t\t\treturn this.http ;\n\t\t};\n\n\t\t// ref to schema objectLink2ForcedCriteria\n\t\tObjectLinkStore.prototype.setForcedCriteria = function(crits){\n\t\t\tthis.crits = crits;\n\t\t\treturn this;\n\t\t};\n\n\t\t// ref to schema objectLink2\n\t\tObjectLinkStore.prototype.setSchema = function(schema){\n\t\t\tthis.schema = schema;\n\t\t\treturn this;\n\t\t};\n\n\t\tObjectLinkStore.prototype.getHttpConfing = function(dataset){\n\t\t\tvar config = {\n\t\t\t\t\tmethod : 'POST',\n\t\t\t\t\turl: '/search/' + schemaUtil.encodeUri(this.schema.schema),\n\t\t\t\t\tdata: {\n\t\t\t\t\t\tcrits: [], \n\t\t\t\t\t\tlimit: dataset.getLimit() , \n\t\t\t\t\t\tskip: dataset.getOffset(), \n\t\t\t\t\t\tsorts:[]\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\torderByName = null\n\t\t\t;\n\n\t\t\t// orderBy\n\t\t\tif (!this._orderByName) {\n\t\t\t\tfor (var field in this.schema.fields){\n\t\t\t\t\tthis._orderByName = this.schema.fields[field];\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tconfig.data.sorts.push({\n\t\t\t\t\"f\": this._orderByName,\n\t\t\t\t\"o\": this.options.orderBySort\n\t\t\t});\n\n\t\t\t// search criteria\n\t\t\t// for (var field in this.schema.fields){\n\t\t\t// \tconfig.data.criteria.push({\n\t\t\t// \t\tf: this.schema.fields[field],\n\t\t\t// \t\tv: dataset.getSearchValue() ? dataset.getSearchValue() : '',\n\t\t\t// \t\top: this.options.searchCondition\n\t\t\t// \t});\n\t\t\t// }\n\t\t\t\n\t\t\t//FIXME make sure this.criteria is always array never null\n\t\t\tif (this.crits && angular.isArray(this.crits)) {\n\t\t\t\tconfig.data.crits.concat(this.crits);\n\t\t\t}\n\n\t\t\tvar _searchVal = dataset.getSearchValue();\n\n\t\t\t//FIXME make sure that getSearchValue is always string and always non null\n\t\t\tif (_searchVal && angular.isString(_searchVal) && _searchVal.length > 0) {\n\t\t\t\tfor (field in this.schema.fields) {\n\t\t\t\t\tconfig.data.crits.push({\n\t\t\t\t\t\tf: this.schema.fields[field],\n\t\t\t\t\t\tv: _searchVal,\n\t\t\t\t\t\top: this.options.searchCondition\n\t\t\t\t\t});\n\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\treturn config;\n\t\t};\n\n\t\tObjectLinkStore.prototype.load = function(dataset, callback){\n\t\t\tvar self = this;\n\n\t\t\tthis.initFieldsSchema(function(){\n\t\t\t\tvar promise = self.getHttp().http(\n\t\t\t\t\tself.getHttpConfing(dataset)\n\t\t\t\t);\n\n\t\t\t\tpromise.then(\n\t\t\t\t\t// success\n\t\t\t\t\tfunction(args){\n\t\t\t\t\t\tvar data = [];\n\n\t\t\t\t\t\tif(args.data && args.data instanceof Array){\n\t\t\t\t\t\t\tfor (var i = 0; i < args.data.length; i++) {\n\t\t\t\t\t\t\t\tdata.push(\n\t\t\t\t\t\t\t\t\tObjectLinkStore.getData(\n\t\t\t\t\t\t\t\t\t\tself.schema,\n\t\t\t\t\t\t\t\t\t\targs.data[i]\n\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tcallback(data);\n\t\t\t\t\t},\n\n\t\t\t\t\t// error\n\t\t\t\t\tfunction(){\n\t\t\t\t\t\targuments;\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t});\n\n\t\t};\n\n\t\t/**\n\t\t * Get data from schema or model\n\t\t *\n\t\t * @param objectLink schema definition of object link (under objectLink2 keyword)\n\t\t * @param data data value of object link (data in model)\n\t\t *\n\t\t * @return data from model (if refData exists) or try to parse it form model\n\t\t */\n\t\tObjectLinkStore.getData = function(objectLink, data) {\n\t\t\tif( data && typeof data === 'object'){\n\t\t\t\t// if there are refData in object (objectLink)\n\t\t\t\tif(data.refData){\n\t\t\t\t\treturn data;\n\t\t\t\t}\n\n\n\t\t\t\t// if there is no refData, try to parse fields form model\n\t\t\t\t// FIXME does this make sense???\n\t\t\t\tvar field,\n\t\t\t\t\toutData = {\n\t\t\t\t\t\tschema: objectLink.schema,\n\t\t\t\t\t\toid: data.id,\n\t\t\t\t\t\trefData: {}\n\t\t\t\t\t};\n\t\t\t\t\n\t\t\t\tfor (field in objectLink.fields) {\n\t\t\t\t\tvar getter = $parse(objectLink.fields[field]);\n\t\t\t\t\t// FIXME what is this?\n\t\t\t\t\toutData.refData[field] = getter(data);\n\t\t\t\t}\n\n\t\t\t\treturn outData;\n\t\t\t}\n\t\t\t\n\t\t\treturn null;\n\t\t};\n\n\t\t/**\n\t\t * HttpStoreTest\n\t\t */\n\n\t\tfunction HttpStoreTest(){\n\t\t\t// this.options = angular.extend({}, HttpStoreTest.DEFAULTS, options || {} );\n\t\t\tthis.data = [];\n\t\t\tthis.fields = {};\n\t\t\tthis.fieldsIndex = [];\n\n\t\t\tthis._fieldsSchemaFragment = {};\n\t\t\tthis._lables = {};\n\t\t};\n\n\t\tHttpStoreTest.DEFAULTS = {\n\t\t\t// url: null\n\t\t};\n\n\t\t// ref to schema objectlink2.fields\n\t\tHttpStoreTest.prototype.setFields = function(fields){\n\t\t\tvar field;\n\n\t\t\tthis.fields = fields;\n\t\t\tfor( field in this.fields){\n\t\t\t\tthis.fieldsIndex.push(field);\n\t\t\t}\n\t\t\treturn this;\n\t\t};\n\n\t\tHttpStoreTest.prototype.setScope = function(scope){\n\t\t\tthis.scope = scope;\n\t\t\treturn this;\n\t\t};\n\n\t\t// ref to schema objectlink2.schema\n\t\tHttpStoreTest.prototype.setSchema = function(schema){\n\t\t\tthis.schema = schema;\n\t\t\treturn this;\n\t\t};\n\n\t\tHttpStoreTest.prototype.getFieldSchemaFragment = function(index){\n\t\t\tvar fieldName = typeof index === \"string\" ? index : this.fieldsIndex[index];\n\t\t\tif(!this._fieldsSchemaFragment[fieldName]){\n\t\t\t \tthis._fieldsSchemaFragment[fieldName] = HttpStoreTest.getFieldSchemaFragment(\n\t\t\t \t\tthis.schema, this.fields[fieldName], this.scope\n\t\t \t\t);\n\t\t\t}\n\t\t\treturn this._fieldsSchemaFragment[fieldName];\n\t\t}\n\n\n\t\t//@todo use schemaUtil instead\n\t\tHttpStoreTest.getFieldSchemaFragment = function(schema, field, scope){\n\t\t\tvar fieldProp = field.split(\".\"),\n\t\t\t\tpath = [\n\t\t\t\t\tschema,\n\t\t\t\t\t\"properties\",\n\t\t\t\t\tfieldProp[0],\n\t\t\t\t\t\"properties\",\n\t\t\t\t\tfieldProp[1]\n\t\t\t\t],\n\t\t\t\tgetter = $parse(path.join('.'))\n\t\t\t;\n\n\t\t \treturn getter(scope);\n\t\t}\n\n\n\t\tHttpStoreTest.prototype.getLabel = function(index){\n\t\t\tvar fieldName = typeof index === \"string\" ? index : this.fieldsIndex[index];\n\n\t\t\tif(!this._lables[fieldName]){\n\t\t\t \tthis._lables[fieldName] = this.getFieldSchemaFragment(fieldName).title;\n\t\t\t}\n\t\t\treturn this._lables[fieldName];\n\t\t};\n\n\t\tHttpStoreTest.prototype.setTestData = function(count){\n\t\t\tfunction randomString(length, chars) {\n\t\t\t    var mask = '';\n\t\t\t    if (chars.indexOf('a') > -1) mask += 'abcdefghijklmnopqrstuvwxyz';\n\t\t\t    if (chars.indexOf('A') > -1) mask += 'ABCDEFGHIJKLMNOPQRSTUVWXYZ';\n\t\t\t    if (chars.indexOf('#') > -1) mask += '0123456789';\n\t\t\t    if (chars.indexOf('D') > -1) mask += '123456789';\n\t\t\t    if (chars.indexOf('!') > -1) mask += '~`!@#$%^&*()_+-={}[]:\";\\'<>?,./|\\\\';\n\t\t\t    var result = '';\n\t\t\t    for (var i = length; i > 0; --i) result += mask[Math.round(Math.random() * (mask.length - 1))];\n\t\t\t    return result;\n\t\t\t}\n\n\t\t\tfor( var i = 0 ; i < count; i++){\n\t\t\t\tvar item = {\n\t\t\t\t\tschema:\"uri://\",\n\t\t\t\t\toid:i,\n\t\t\t\t\trefdata:{}\n\t\t\t\t};\n\t\t\t\tfor(var j = 0; j < this.fieldsIndex.length; j++){\n\t\t\t\t\t//var setter = $parse(this.fields[j]).assign;\n\t\t\t\t\t// item.refdata[this.fieldsIndex[j]]\n\n\t\t\t\t\tswitch(this.getFieldSchemaFragment(j).type){\n\t\t\t\t\t\tcase \"date\":\n\t\t\t\t\t\t\titem.refdata[this.fieldsIndex[j]] = '20140' + randomString(1, 'D') +'1' + randomString(1, 'D');\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\titem.refdata[this.fieldsIndex[j]] = randomString(10, '#aA');\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tthis.data.push(item);\n\t\t\t}\n\t\t};\n\n\t\tHttpStoreTest.prototype.load = function(dataset, callback){\n\t\t\tvar self = this;\n\n\t\t\tthis.timeout && $timeout.cancel(this.timeout);\n\n\t\t\tthis.timeout = $timeout(function(){\n\t\t\t\tvar data = [];\n\n\t\t\t\tdata = self.data;\n\n\t\t\t\tcallback(\n\t\t\t\t\tdata.slice(dataset.getOffset(), dataset.getLimit() + dataset.getOffset())\n\t\t\t\t);\n\t\t\t}, 3000);\n\t\t\tconsole.log('HttpStoreTest::load');\n\t\t};\n\n\t\treturn {\n\t\t\tdataSetController: DataSet,\n\t\t\tarrayStoreController: DataSet,\n\t\t\tcreateArrayDataset: function(key, values){\n\t\t\t\tvar store = new ArrayStore();\n\t\t\t\tstore.setData(key, values);\n\n\t\t\t\treturn new DataSet(store);\n\t\t\t},\n\t\t\tcreateObjectDataset: function(schemaFragment){\n\t\t\t\tvar store = new ObjectLinkStore();\n\n\t\t\t\tstore.setSchema(schemaFragment.objectLink2)\n\t\t\t\t\t.setForcedCriteria(schemaFragment.objectLink2ForcedCriteria)\n\t\t\t\t;\n\n\t\t\t\treturn new ObjectDataSet(store);\n\t\t\t},\n\t\t\tcreateTestDataset: function(scope, schemaFragment, itemLenght){\n\t\t\t\tvar store = new HttpStoreTest();\n\t\t\t\tstore.setFields(schemaFragment.objectLink2.fields)\n\t\t\t\t\t.setScope(scope)\n\t\t\t\t\t.setSchema(schemaFragment.objectLink2.schema)\n\t\t\t\t\t.setTestData(itemLenght ? itemLenght: 4000)\n\t\t\t\t;\n\n\t\t\t\treturn new ObjectDataSet(store);\n\t\t\t},\n\t\t\tgetFieldSchemaFragment: HttpStoreTest.getFieldSchemaFragment,\n\t\t\tgetObjectLinkData: ObjectLinkStore.getData\n\t\t}\n\t\n\t}]);\n}(window.angular));\n","(function(angular) {\r\n\t'use strict';\r\n\r\n\tangular.module('xpsui:services')\r\n\t.factory('xpsui:StatisticsServiceFactory', ['$http','$rootScope','xpsui:SchemaUtil', function($http, $rootScope,schemaUtilFactory) {\r\n\t\tvar service = {};\r\n\r\n\t\tservice.getStatisticsData = function() {\r\n\t\t\treturn $http({\r\n\t\t\t\tmethod : 'get',\r\n\t\t\t\turl : '/statistics/',\r\n\t\t\t});\r\n\t\t};\r\n\t\treturn service;\r\n\t}]);\r\n\r\n}(window.angular));","(function(angular) {\n\t'use strict';\n\n\tangular.module('xpsui:directives', []);\n}(angular));\n\n","(function(angular) {\r\n\t'use strict';\r\n\r\n\tangular.module('xpsui:directives')\r\n\t.directive('xpsuiFormActionLink', ['xpsui:SchemaUtil',\r\n\t\t\tfunction(schemaUtilFactory) {\r\n\t\treturn {\r\n\t\t\trestrict: 'A',\r\n\t\t\tlink: function(scope, elm, attrs, ctrls) {\r\n\t\t\t\tvar options = scope.$eval(attrs.psuiOptions);\r\n\t\t\t\tvar modelPath = scope.$eval(attrs.psuiModel);\r\n\r\n\t\t\t\telm.append('<span>'+(options.title)+'</span>');\r\n\r\n\t\t\t\tscope.$watch(attrs.psuiModel+'.id', function(nv, ov) {\r\n\t\t\t\t\tif (nv) {\r\n\t\t\t\t\t\tattrs.$set('href', '/#/registry/custom/' + options.template + '/' + schemaUtilFactory.encodeUri(options.schema) + '/' +nv);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\r\n\t\t\t}\r\n\t\t};\r\n\t}]);\r\n\r\n}(window.angular));\r\n","(function(angular) {\n\t'use strict';\n\n\tangular.module('xpsui:directives')\n\t.directive('xpsuiArrayControlEdit', ['$compile', function($compile) {\n\n\t\tvar  objectLinkTemplate='<div ng-repeat=\"ae in ngModel track by $id(ae)\">'\n\t\t\t\t+ ' <div class=\"x-array-control-item\">'\n\t\t\t\t+ '  <div  xpsui-objectlink2-edit xpsui-validity-mark xpsui-schema=\"xpsuiSchema.items\" ng-model=\"ngModel[$index]\"></div>'\n\t\t\t\t+ '  <button ng-click=\"removeByIndex($index);\" class=\"btn-clear floating\">'\n\t\t\t\t+ '   <i class=\"icon-minus\"></i> {{\\'generic.search.remove\\' | translate}}'\n\t\t\t\t+ '  </button>'\n\t\t\t\t+ ' </div>'\n\t\t\t\t+ '</div>'\n\t\t\t\t+ '<div class=\"pull-right\">'\n\t\t\t\t+ '<button ng-click=\"appendNew();\" class=\"btn-clear\"><i class=\"icon-add\"></i> {{\"generic.search.add\" | translate}}</button>'\n\t\t\t\t+ '</div>';\n\n\t\tvar uploadablefileTemplate = '<div ng-repeat=\"ae in ngModel track by $id(ae)\" class=\"xpsui-uploadable-file-edit\">'\n\t\t\t\t\t\t+ ' <div class=\"psui-attachment-remove\">'\n\t\t\t\t\t\t+ '  <button ng-click=\"removeByIndex($index);\" class=\"btn-clear\">'\n\t\t\t\t\t\t+ '   <i class=\"icon-remove\"></i> {{\\'generic.search.remove\\' | translate}}'\n\t\t\t\t\t\t+ '  </button>'\n\t\t\t\t\t\t+ ' </div>'\n\t\t\t\t\t\t+ '<div xpsui-uploadable-file xpsui-validity-mark class=\"xpsui-uploadable-file-edit-item\"'\n\t\t\t\t\t\t+ '     xpsui-schema=\"xpsuiSchema.items\" ng-model=\"ngModel[$index]\"> '\n\t\t\t\t\t\t+ '</div>'\n\t\t\t\t\t\t+ '</div>'\n\t\t\t\t\t\t+ '<div class=\"pull-right clear\">'\n\t\t\t\t\t\t+ '<button ng-click=\"appendNew();\" class=\"btn-clear\"><i class=\"icon-add\"></i> {{\"generic.search.add\"| translate}}</button>'\n\t\t\t\t\t\t+ '</div>';\n\n\t\tfunction getTemplate(renderComponent) {\n\t\t\treturn (renderComponent===\"xpsui-uploadable-file\")?uploadablefileTemplate:objectLinkTemplate;\n\t\t}\n\n\t\treturn {\n\t\t\trestrict: 'A',\n\t\t\tscope: {\n\t\t\t\t'ngModel' : '=',\n\t\t\t\t'xpsuiSchema' : '='\n\t\t\t},\n\n\t\t\t\tlink: function(scope, element, attrs, controller) {\n\t\t\t\tconsole.log(scope.psuiModel);\n\t\t\t\tconsole.log(scope.xpsuiSchema);\n\n\t\t\t\telement.html(getTemplate(attrs.xpsuiArrayControlEdit));\n\t\t\t\t$compile(element.contents())(scope);\n\n\t\t\t\tvar modelChanged = function() {\n\t\t\t\t\tconsole.log('model changed', scope.ngModel);\n\t\t\t\t};\n\n\t\t\t\tscope.$watchCollection('ngModel', modelChanged);\n\n\n\n\t\t\t\tscope.removeByIndex = function(idx) {\n\t\t\t\t\tscope.ngModel.splice(idx,1);\n\t\t\t\t};\n\n\t\t\t\tfunction isEmptyObj(obj) {\n\t\t\t\t\tif (!obj) {\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\n\t\t\t\t\tfor (var key in obj) {\n\t\t\t\t\t\tif (key && key.indexOf('$') != 0\n\t\t\t\t\t\t\t\t&& obj.hasOwnProperty(key)) {\n\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t            return true;\n\t\t\t\t}\n\n\t\t\t\tscope.appendNew = function() {\n\t\t\t\t\tif (!(scope.ngModel instanceof Array)) {\n\t\t\t\t\t\tscope.ngModel = [];\n\t\t\t\t\t}\n\t\t\t\t\tif ((scope.ngModel instanceof Array)\n\t\t\t\t\t\t\t&& (scope.ngModel.length == 0 \n\t\t\t\t\t\t\t\t\t|| !isEmptyObj(scope.ngModel[scope.ngModel.length-1]))) {\n\t\t\t\t\t\tscope.ngModel.push({});\n\t\t\t\t\t}\n\t\t\t\t};\n\n\t\t\t}\n\n\t\t};\n\t}]);\n\n}(window.angular));\n","(function(angular) {\r\n\t'use strict';\r\n\r\n\tangular.module('xpsui:directives')\r\n\t.directive('xpsuiArrayControlView', ['$compile', function($compile) {\r\n\r\n\t\tvar  objectLinkTemplate='<div ng-repeat=\"ae in ngModel track by $id(ae)\">'\r\n\r\n\t\t\t\t+ '<div  xpsui-objectlink2-view xpsui-validity-mark xpsui-schema=\"xpsuiSchema.items\" ng-model=\"ngModel[$index]\"></div>'\r\n\t\t\t\t+ '</div>';\r\n\t\t\t\t// + '<button ng-click=\"appendNew();\"><i></i>{{\"generic.search.add\" | translate}}</button>';\r\n\r\n\t\tvar  uploadablefileTemplate='<div ng-repeat=\"ae in ngModel track by $id(ae)\" class=\"xpsui-uploadable-file-view\">'\r\n\t\t\t\t\t+ '<div  xpsui-uploadable-file xpsui-validity-mark '\r\n\t\t\t\t\t+ '   xpsui-schema=\"xpsuiSchema.items\" '\r\n\t\t\t\t\t+ '   ng-model=\"ngModel[$index]\"></div>'\r\n\t\t\t\t+ '</div><div class=\"xpsui-uploadable-file-nofiles\" ng-show=\"!ngModel || ngModel.length==0\">{{\"generic.nofiles.label\" | translate}}</div>';\r\n\r\n\t\tfunction getTemplate(renderComponent){\r\n\t\t\treturn (renderComponent===\"xpsui-uploadable-file\")?uploadablefileTemplate:objectLinkTemplate;\r\n\t\t}\r\n\r\n\t\tfunction isEmptyObj(obj) {\r\n\t\t\tif (obj && obj.hasOwnProperty('fileId')) {\r\n                return false;\r\n\t\t\t}\r\n            return true;\r\n\t\t}\r\n\r\n\t\treturn {\r\n\t\t\trestrict: 'A',\r\n\t\t\tscope: {\r\n\t\t\t\t'ngModel' : '=',\r\n\t\t\t\t'xpsuiSchema' : '='\r\n\t\t\t},\r\n\t\t\tlink: function(scope, element, attrs, controller) {\r\n\t\t\t\tconsole.log(scope.psuiModel);\r\n\t\t\t\tconsole.log(scope.xpsuiSchema);\r\n\r\n\t\t\t\telement.html(getTemplate(attrs.xpsuiArrayControlView));\r\n\t\t\t\t$compile(element.contents())(scope);\r\n\r\n\r\n\t\t\t\tvar modelChanged = function() {\r\n\t\t\t\t\tconsole.log('model changed', scope.ngModel);\r\n\t\t\t\t};\r\n\r\n\t\t\t\tscope.$watchCollection('ngModel', modelChanged);\r\n\r\n\r\n\t\t\t}\r\n\r\n\t\t};\r\n\t}]);\r\n\r\n}(window.angular));\r\n","(function(angular) {\r\n\t'use strict';\r\n\r\n\tangular.module('xpsui:directives')\r\n\t.directive('xpsuiArray', ['xpsui:log', 'xpsui:ComponentGenerator', '$compile', function(log, componentGenerator, $compile) {\r\n\t\treturn {\r\n\t\t\trestrict: 'E',\r\n\t\t\tlink: function(scope, elm, attrs, ctrls) {\r\n\t\t\t\tlog.group('xpsui-array Link');\r\n\r\n\t\t\t\tvar modelPath = attrs.xpsuiModel;\r\n\t\t\t\tvar schemaPath = attrs.xpsuiSchema;\r\n\r\n\r\n\t\t\t\tif (modelPath && schemaPath) {\r\n\t\t\t\t} else {\r\n\t\t\t\t\tlog.warn('Attributes xpsui-model and xpsui-schema have to be set, skipping fieldset generation');\r\n\t\t\t\t\tlog.groupEnd();\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tvar itemsHolder = angular.element('<div></div>');\r\n\r\n\t\t\t\telm.append(itemsHolder);\r\n\t\t\t\tfunction generateArrayElements() {\r\n\t\t\t\t\titemsHolder.empty();\r\n\r\n\t\t\t\t\tvar schema = scope.$eval(schemaPath.concat('.items'));\r\n\t\t\t\t\tangular.forEach(scope.$eval(modelPath), function(val, key) {\r\n\t\t\t\t\t\tvar arrayItem = angular.element('<div></div>');\r\n\t\t\t\t\t\tangular.forEach(schema.properties, function(v, k) {\r\n\t\t\t\t\t\t\tvar component = componentGenerator.generate(schema.properties[k], schemaPath.concat('.items.properties.', k), modelPath.concat('.',key, '.', k));\r\n\t\t\t\t\t\t\tarrayItem.append(component);\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\titemsHolder.append(arrayItem);\r\n\t\t\t\t\t\t$compile(arrayItem)(scope);\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\r\n\t\t\t\tgenerateArrayElements();\r\n\t\t\t\tlog.groupEnd();\r\n\t\t\t}\r\n\t\t};\r\n\t}]);\r\n\r\n}(window.angular));","(function(angular) {\n\t'use strict';\n\n\tangular.module('xpsui:directives')\n\t.directive('xpsuiBySchemaFieldEdit', ['xpsui:logging', 'xpsui:FormGenerator', '$compile', '$parse', function(log, formGenerator, $compile, $parse) {\n\t\treturn {\n\t\t\trestrict: 'A',\n\t\t\trequire: [],\n\t\t\tlink: function(scope, elm, attrs, ctrls) {\n\t\t\t\tlog.group('By Schema Field edit Link');\n\n\t\t\t\tvar modelPath = attrs.xpsuiModel;\n\n\t\t\t\tattrs.$observe('xpsuiSchema', function(v) {\n\t\t\t\t\tconsole.log(v);\n\t\t\t\t\tif (v) {\n\t\t\t\t\t\tregenerateField();\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\tfunction regenerateField() {\n\t\t\t\t\tvar schemaPath = attrs.xpsuiSchema;\n\t\t\t\t\tvar schemaFragment = scope.$eval(schemaPath);\n\t\t\t\t\tvar modelPath = attrs.xpsuiModel;\n\n\t\t\t\t\tvar field = formGenerator.generateField(schemaFragment, schemaPath, modelPath, formGenerator.MODE.EDIT);\n\n\t\t\t\t\telm.empty();\n\t\t\t\t\t$parse(modelPath).assign(scope, null);\n\n\t\t\t\t\telm.append(field);\n\t\t\t\t\t$compile(field)(scope);\n\t\t\t\t}\n\t\t\t\tlog.groupEnd();\n\t\t\t}\n\t\t};\n\t}]);\n\n}(window.angular));\n\n","(function(angular) {\n\t'use strict';\n\n\tangular.module('xpsui:directives')\n\t.directive('xpsuiBySchemaFieldView', ['xpsui:logging', 'xpsui:FormGenerator', '$compile', function(log, formGenerator, $compile) {\n\t\treturn {\n\t\t\trestrict: 'A',\n\t\t\trequire: [],\n\t\t\tlink: function(scope, elm, attrs, ctrls) {\n\t\t\t\tlog.group('By Schema Field view Link');\n\n\t\t\t\tvar modelPath = attrs.xpsuiModel;\n\n\t\t\t\tattrs.$observe('xpsuiSchema', function(v) {\n\t\t\t\t\tconsole.log(v);\n\t\t\t\t\tif (v) {\n\t\t\t\t\t\tregenerateField();\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\tfunction regenerateField() {\n\t\t\t\t\tvar schemaPath = attrs.xpsuiSchema;\n\t\t\t\t\tvar schemaFragment = scope.$eval(schemaPath);\n\t\t\t\t\tvar modelPath = attrs.xpsuiModel;\n\n\t\t\t\t\tvar field = formGenerator.generateField(schemaFragment, schemaPath, modelPath, formGenerator.MODE.VIEW);\n\n\t\t\t\t\telm.empty();\n\n\t\t\t\t\telm.append(field);\n\t\t\t\t\t$compile(field)(scope);\n\t\t\t\t}\n\t\t\t\tlog.groupEnd();\n\t\t\t}\n\t\t};\n\t}]);\n\n}(window.angular));\n\n","(function(angular) {\n\t'use strict';\n\n\tangular.module('xpsui:directives')\n\t.directive('xpsuiCalendar',['xpsui:logging', 'xpsui:DateUtil', '$translate', 'xpsui:DropdownFactory', function(log, dateUtil, $translate, dropdownFactory) {\n\t\tvar keys = {\n\t            tab:      9,\n\t            enter:    13,\n\t            escape:   27,\n\t            space:    32,\n\t            pageup:   33,\n\t            pagedown: 34,\n\t            end:      35,\n\t            home:     36,\n\t            left:     37,\n\t            up:       38,\n\t            right:    39,\n\t            down:     40,\n\t            asterisk: 106\n\t   };\n\t   \n\t\tvar component = function(){\n\t\t\tthis.options = angular.extend({}, component.DEFAULTS);\n\t\t\t// selected date - date from input\n\t\t\tthis.value;\n\t\t\t\n\t\t\t// date for render layout - date is using layout functions\n\t\t\tthis.date;\n\t\t\t\n\t\t\tthis.isRendered = false;\n\t\t\t\n\t\t\tthis.dropdown = false;\n\t\t};\n\t\t\n\t\tcomponent.DEFAULT = {\n\t\t\t/**\n\t\t\t * callback when date is selected\n\t\t\t *\n\t\t\t * @param date Date\n\t\t\t */\n\t\t\tonSelected: function(date){}\n\t\t};\n\n\t\tcomponent.prototype.setOptions = function(options){\n\t\t\tangular.extend(this.options, options || {});\n\t\t};\n\t\t\n\t\tcomponent.prototype.setInput = function(element){\n\t\t\tvar self = this;\n\t\t\tthis.$inputElement = element;\n\t\t\t\n\t\t\tthis.$inputElement.on('change',function(){\n\t\t\t\tvar value = dateUtil.parser(\n\t\t\t\t\tangular.element(this).val()\n\t\t\t\t);\n\n\t\t\t\tif (value) {\n\t\t\t\t\tself.setValue(value);\n\t\t\t\t\tself.render();\n\t\t\t\t}\n\t\t\t});\n\t\t\t\n\t\t\treturn this;\n\t\t};\n\t\t\n\t\tcomponent.prototype.getInput = function(){\n\t\t\treturn this.$inputElement;\n\t\t};\n\t\t\n\t\tcomponent.prototype.setDate = function(value){\n\t\t\tthis.date = new Date(value.getTime()) ;\n\t\t};\n\t\t\n\t\tcomponent.prototype.getDate = function(value){\n\t\t\tif(this.date === null || this.date === undefined){\n\t\t\t\tthis.setDate(this.value ? this.value : new Date());\n\t\t\t}\n\t\t\treturn this.date;\n\t\t};\n\t\t\n\t\tcomponent.prototype.setValue = function(value){\n\t\t\tif(angular.isUndefined(value)){\n\t\t\t\treturn this;\n\t\t\t}\n\t\t\t\n\t\t\tif(typeof value === 'string'){\n\t\t\t\tvalue = dateUtil.getDateFromYYYYMMDD(value);\n\t\t\t}\n\t\t\tthis.value = new Date(value.getTime()) ;\n\t\t\treturn this;\n\t\t};\n\t\t\n\t\tcomponent.prototype.setRootElement = function(element){\n\t\t\tthis.$rootElement = element\n\t\t\treturn this;\n\t\t};\n\t\t\n\t\tcomponent.prototype.getRootElement = function(){\n\t\t\treturn this.$rootElement;\n\t\t};\n\t\t\n\t\tcomponent.prototype.setDropdown = function(dropdown){\n\t\t\tvar self = this;\n\t\t\tthis.dropdown = dropdown;\n\t\t\t\n\t\t\tdropdown.afterOpen = function(){\n\t\t\t\tself.renderTo(dropdown.getContentElement());\n\t\t\t\tself.setFocus(self.$element);\n\t\t\t};\n\t\t};\n\t\t\n\t\tcomponent.prototype.setFocus = function($el){\n\t\t\t$el[0].focus();\n\t\t\tif (this.$element[0] === $el[0]) {\n\t\t\t\tthis.$focusElement = null;\n\t\t\t} else {\n\t\t\t\tthis.$focusElement = $el;\n\t\t\t}\n\t\t};\n\t\t\n\t\t/**\n\t\t * \n\t\t * @returns Date\n\t\t */\n\t\tcomponent.prototype.getValue = function(){\n\t\t\treturn this.value;\n\t\t};\n\t\t\n\t\tcomponent.prototype._bindHandlers = function($items) {\n\t\t\tvar self = this;\n\n\t\t\t// bind a mouseover handler\n\t\t\t$items.on('mouseover', function(e) {\n\t\t\t\treturn self._handleMouseover(angular.element(this), e);\n\t\t\t});\n\n\t\t\t// bind a click handler\n\t\t\t$items.on('click', function(e) {\n\t\t\t\treturn self._handleClick(angular.element(this), e);\n\t\t\t});\n\n\t\t\t// bind a keydown handler\n\t\t\t$items.on('keydown', function(e) {\n\t\t\t\treturn self._handleKeyDown(angular.element(this), e);\n\t\t\t});\n\n\t\t\t// bind a focus handler\n\t\t\t$items.on('focus', function(e) {\n\t\t\t\treturn self._handleFocus(angular.element(this), e);\n\t\t\t});\n\n\t\t\t// bind a blur handler\n\t\t\t$items.on('blur', function(e) {\n\t\t\t\treturn self._handleBlur(angular.element(this), e);\n\t\t\t});\n\t\t\t\n\t\t\tthis.resetTabElemens();\n\t\t};\n\n\t\tcomponent.prototype._handleMouseover = function($el, event){\n\t\t\tthis.setFocus($el);\n\t\t\tevent.stopPropagation();\n\t\t};\n\t\t\n\t\tcomponent.prototype._handleClick = function($el, event){\n\t\t\tthis._handleActions($el);\n\t\t\tevent.stopPropagation();\n\t\t};\n\t\t\n\t\tcomponent.prototype._handleKeyDown = function($el, event){\n\t\t\tswitch (event.keyCode) {\n\t\t\t\tcase keys.up:\n\t\t\t\t\tthis.previousAction();\n\t\t\t\t\tthis.setFocus(this.$element);\n\t\t\t\t\tevent.stopPropagation();\n\t\t\t\t\tbreak;\n\t\t\t\tcase keys.down: //keys.down\n\t\t\t\t\tthis.nextAction();\n\t\t\t\t\tthis.setFocus(this.$element);\n\t\t\t\t\tevent.stopPropagation();\n\t\t\t\t\tbreak;\n\t\t\t\tcase keys.right: //keys.right\n\t\t\t\t\tif(!this.$focusElement){\n\t\t\t\t\t\tthis.setFocus(\n\t\t\t\t\t\t\tangular.element(this.getTabElements()[0])\n\t\t\t\t\t\t);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tvar index = this.indexOfTabElements(this.$focusElement[0]);\n\t\t\t\t\t\tif(index === this.getTabElements().length - 1 ){\n\t\t\t\t\t\t\tindex = 0;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tindex++;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tthis.setFocus(\n\t\t\t\t\t\t\tangular.element( \n\t\t\t\t\t\t\t\tthis.getTabElements()[index]\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t\tevent.stopPropagation();\n\t\t\t\t\tbreak;\n\t\t\t\tcase keys.left://keys.left\n\t\t\t\t\tif(!this.$focusElement){\n\t\t\t\t\t\tthis.setFocus(\n\t\t\t\t\t\t\tangular.element(this.getTabElements()[0])\n\t\t\t\t\t\t);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tvar index = this.indexOfTabElements(this.$focusElement[0]);\n\t\t\t\t\t\tif(!index){\n\t\t\t\t\t\t\tindex = this.getTabElements().length - 1;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tindex--;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tthis.setFocus(\n\t\t\t\t\t\t\tangular.element( \n\t\t\t\t\t\t\t\tthis.getTabElements()[index]\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\tevent.stopPropagation();\n\t\t\t\t\tbreak;\n\t\t\t\tcase keys.enter: \n\t\t\t\t\tthis._handleActions($el);\n\t\t\t\t\tevent.stopPropagation();\n\t\t\t\t\tbreak\n\t\t\t\tcase keys.escape:\n\t\t\t\t\tthis.getInput()[0].focus();\n\t\t\t\t\tevent.stopPropagation();\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t};\n\t\t\n\t\tcomponent.prototype._handleFocus = function($el, event){\n\t\t\tthis.dropdown && this.dropdown.cancelClosing();\n\t\t};\n\t\t\n\t\tcomponent.prototype._handleBlur = function($el, event){\n\t\t\tthis.dropdown && this.dropdown.close();\n\t\t};\n\t\t\n\t\tcomponent.prototype._handleActions = function($el){\n\t\t\tswitch($el[0]){\n\t\t\t\tcase this.$previousActionElement[0]:\n\t\t\t\t\tthis.previousAction();\n\t\t\t\t\t//this.setFocus(this.$element);\n\t\t\t\t\tbreak;\n\t\t\t\tcase this.$nextActionElement[0]:\n\t\t\t\t\tthis.nextAction();\n\t\t\t\t\t//this.setFocus(this.$element);\n\t\t\t\t\tbreak;\n\t\t\t\tcase this.$currentDayActionElement[0]:\n\t\t\t\t\tthis.currentDayAction();\n\t\t\t\t\t//this.setFocus(this.$element);\n\t\t\t\t\tbreak;\n\t\t\t\tcase this.$headerActionElement[0]:\n\t\t\t\t\tthis.headerAction();\n\t\t\t\t\tif(this.doLayout === this.yearlyLayout){\n\t\t\t\t\t\tthis.setFocus(this.getFirstTabElement());\n\t\t\t\t\t}\n\t\t\t\t\t//this.setFocus(this.$element);\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tif($el.hasClass('x-year')){\n\t\t\t\t\t\tthis.date.setFullYear($el.data('date').getFullYear());\n\t\t\t\t\t\tthis.monthlyLayout();\n\t\t\t\t\t\tthis.setFocus(this.getFirstTabElement());\n\t\t\t\t\t} else if($el.hasClass('x-month')){\n\t\t\t\t\t\tthis.date.setMonth($el.data('date').getMonth());\n\t\t\t\t\t\tthis.dailyLayout();\n\t\t\t\t\t\tthis.setFocus(this.getFirstTabElement());\n\t\t\t\t\t} else if($el.hasClass('x-day') && $el.data('date')){\n\t\t\t\t\t\t// this.getInput().val(\n\t\t\t\t\t\t// \tdateUtil.formatter($el.data('date'))\n\t\t\t\t\t\t// );\n\t\t\t\t\t\tthis.setValue($el.data('date'));\n\t\t\t\t\t\tthis.options.onSelected($el.data('date'));\n\n\t\t\t\t\t\tthis.getInput()[0].focus();\n\t\t\t\t\t}\n\t\t\t}\n\t\t};\n\t\t\n\t\tcomponent.prototype._renderInit =  function(){\n\t\t\tvar self = this;\n\t\t\tif(!this.isRendered){\n\t\t\t\tthis.isRendered = true;\n\t\t\t\t\n\t\t\t\tthis.$element = angular.element('<div class=\"x-calendar\"></div>');\n\t\t\t\t\n\t\t\t\tthis.$element.attr('tabindex', '0');\n\t\t\t\tif(this.dropdown){\n\t\t\t\t\tthis.$element.attr('tabindex', '-1');\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tthis.getRootElement().append(this.$element);\n\t\t\t\tthis._bindHandlers(this.$element);\n\n\t\t\t\tthis._controllsInit();\n\n\t\t\t\tthis.$contentElement =  angular.element('<table></table>');\n\t\t\t\tthis.$element.append(this.$contentElement);\n\t\t\t}\n\t\t};\n\t\t\n\t\tcomponent.prototype.resetTabElemens =  function(){\n\t\t\tthis.$tabElements = angular.element(\n\t\t\t\tthis.$element[0].querySelectorAll('[tabindex]')\n\t\t\t);\n\t\t};\n\t\t\n\t\tcomponent.prototype.indexOfTabElements = function(value){\n\t\t\tvar index = 0;\n\t\t\tangular.forEach(this.getTabElements(),function(val, key){\n\t\t\t\tif (val === value) {\n\t\t\t\t\tindex =  key;\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t});\n\t\t\treturn index;\n\t\t};\n\t\t\n\t\tcomponent.prototype.getTabElements = function(){\n\t\t\treturn this.$tabElements;\n\t\t};\n\t\t\n\t\tcomponent.prototype.getFirstTabElement = function(){\n\t\t\treturn angular.element(this.$contentElement[0].querySelector('[tabindex]'));\n\t\t};\n\t\t\n\t\tcomponent.prototype._controllsInit = function(){\n\t\t\tvar self = this;\n\t\t\tthis.$controllElement =  angular.element('<div class=\"x-controlls\"></div>');\n\t\t\tthis.$element.append(this.$controllElement);\n\t\t\t\n\t\t\t\n\t\t\tvar $container =  angular.element('<div class=\"x-controlls-header\"></div>');\n\t\t\tthis.$controllElement.append($container);\n\t\t\t\n\t\t\tthis.$previousActionElement = angular.element(\n\t\t\t\t'<div class=\"x-action-previous\" tabindex=\"-1\"><span>' + $translate.instant('date.previous.day') + '</span></div>'\n\t\t\t);\n\t\t\t$container.append(this.$previousActionElement );\n\t\t\t\n\t\t\tthis.$headerActionElement = angular.element('<div class=\"x-action-header\"  tabindex=\"-1\"></td>'); \n\t\t\t$container.append(this.$headerActionElement);\n\t\t\t\n\t\t\tthis.$nextActionElement = angular.element(\n\t\t\t\t'<div  class=\"x-action-next\" tabindex=\"-1\"><span>' + $translate.instant('date.next.day') + '</span></div>'\n\t\t\t); \n\t\t\t$container.append(this.$nextActionElement);\n\t\t\t\n\t\t\tthis.$currentDayActionElement = angular.element(\n\t\t\t\t'<div class=\"x-action-current-day\" tabindex=\"-1\"><span>' + $translate.instant('date.current.day') + '</span></div>'\n\t\t\t);\n\t\t\tthis.$controllElement.append(this.$currentDayActionElement);\n\t\t\t\n\t\t\tthis._bindHandlers(\n\t\t\t\tangular.element(this.$controllElement[0].querySelectorAll('[tabindex]'))\n\t\t\t);\n\t\t};\n\t\t\n\t\tcomponent.prototype.setHeaderText = function(text){\n\t\t\tthis.$headerActionElement.html(text);\n\t\t};\n\t\t\n\t\tcomponent.prototype.nextAction = function(){\n\t\t\tif(this.doLayout === this.dailyLayout ){\n\t\t\t\tvar month = this.getDate().getMonth() + 1;\n\t\t\t\tthis.date.setMonth(month);\n\t\t\t} else if( this.doLayout === this.monthlyLayout){\n\t\t\t\tthis.date.setFullYear(this.date.getFullYear() + 1);\n\t\t\t} else if( this.doLayout === this.yearlyLayout){\n\t\t\t\tthis.date.setFullYear(this.date.getFullYear() + 9);\n\t\t\t}\n\t\t\t\n\t\t\tthis.doLayout();\n\t\t};\n\t\t\n\t\tcomponent.prototype.previousAction = function(){\n\t\t\tif(this.doLayout === this.dailyLayout ){\n\t\t\t\tthis.date.setMonth(this.getDate().getMonth() - 1);\n\t\t\t} else if( this.doLayout === this.monthlyLayout){\n\t\t\t\tthis.date.setFullYear(this.date.getFullYear() - 1);\n\t\t\t} else if( this.doLayout === this.yearlyLayout){\n\t\t\t\tthis.date.setFullYear(this.date.getFullYear() - 9);\n\t\t\t}\n\t\t\t\n\t\t\tthis.doLayout();\n\t\t};\n\t\t\n\t\tcomponent.prototype.currentDayAction = function(){\n\t\t\tthis.setDate(new Date());\n\t\t\tthis.doLayout = this.dailyLayout;\n\t\t\tthis.doLayout();\n\t\t};\n\t\t\n\t\tcomponent.prototype.headerAction = function(){\n\t\t\tif(this.doLayout === this.dailyLayout){\n\t\t\t\tthis.monthlyLayout();\n\t\t\t} else if(this.doLayout === this.monthlyLayout){\n\t\t\t\tthis.yearlyLayout();\n\t\t\t}\n\t\t};\n\t\t\n\t\tcomponent.prototype.doLayout = function(){};\n\t\t\n\t\tcomponent.prototype.yearlyLayout = function(){\n\t\t\tvar currentDate = new Date(),\n\t\t\t\tselectedDate = this.getValue(),\n\t\t\t\ttr, td,\n\t\t\t\tdate = new Date(this.getDate().getTime())\n\t\t\t;\n\t\t\t\n\t\t\tthis.setHeaderText('');\n\t\t\tthis.$contentElement.empty();\n\t\t\tthis.$headerActionElement.addClass('x-deactive');\n\t\t\t\t\t\n\t\t\tvar year = date.getFullYear() - 4;\n\n\t\t\tfor (var i = 0; i<3; i++){\n\t\t\t\ttr = angular.element('<tr></tr>');\n\t\t\t\tfor (var j = 0; j<3; j++){\n\t\t\t\t\ttd = angular.element('<td>' + year + '</td>');\n\t\t\t\t\ttd.attr('tabindex', '-1');\n\t\t\t\t\tdate.setFullYear(year++);\n\t\t\t\t\ttd.addClass('x-year');\n\t\t\t\t\t\n\t\t\t\t\tif (currentDate.getFullYear() === date.getFullYear()){\n\t\t\t\t\t\ttd.addClass('x-current');\n\t\t\t\t\t} \n\n\t\t\t\t\tif (selectedDate\n\t\t\t\t\t\t&& date.getFullYear() === selectedDate.getFullYear()\n\t\t\t\t\t){\n\t\t\t\t\t\ttd.addClass('x-selected');\n\t\t\t\t\t} \n\t\t\t\t\ttd.data(\"date\",new Date(date.getTime()));\n\t\t\t\t\ttr.append(td);\n\t\t\t\t}\n\t\t\t\tthis.$contentElement.append(tr);\n\t\t\t}\n\t\t\t\n\t\t\tthis._bindHandlers(\n\t\t\t\tangular.element(this.$contentElement[0].querySelectorAll('[tabindex]'))\n\t\t\t);\n\t\t\t\n\t\t\tthis.doLayout = this.yearlyLayout;\n\t\t};\n\t\t\n\t\tcomponent.prototype.monthlyLayout = function(){\n\t\t\tvar currentDate = new Date(),\n\t\t\t\tselectedDate = this.getValue(),\n\t\t\t\ttr, td,\n\t\t\t\tdate = new Date(this.getDate().getTime())\n\t\t\t;\n\t\t\t\n\t\t\tthis.setHeaderText(\n\t\t\t\t date.getFullYear()\n\t\t\t);\n\t\t\tthis.$contentElement.empty();\n\t\t\tthis.$headerActionElement.removeClass('x-deactive');\n\t\t\t\n\t\t\tvar month = 0;\n\t\t\tfor (var i = 0; i<3; i++){\n\t\t\t\ttr = angular.element('<tr></tr>');\n\t\t\t\tfor (var j = 0; j<4; j++){\n\t\t\t\t\ttd = angular.element('<td>' + dateUtil.getNameOfMonth(month) + '</td>');\n\t\t\t\t\ttd.attr('tabindex', '-1');\n\t\t\t\t\tdate.setMonth(month++);\n\t\t\t\t\ttd.addClass('x-month');\n\t\t\t\t\t\n\t\t\t\t\tif (currentDate.getMonth() === date.getMonth() \n\t\t\t\t\t\t&& currentDate.getFullYear() === date.getFullYear()\n\t\t\t\t\t){\n\t\t\t\t\t\ttd.addClass('x-current');\n\t\t\t\t\t} \n\n\t\t\t\t\tif (selectedDate\n\t\t\t\t\t\t&& date.getMonth() === selectedDate.getMonth() \n\t\t\t\t\t\t&& date.getFullYear() === selectedDate.getFullYear()\n\t\t\t\t\t){\n\t\t\t\t\t\ttd.addClass('x-selected');\n\t\t\t\t\t} \n\t\t\t\t\t\t\n\t\t\t\t\ttd.data(\"date\",new Date(date.getTime()));\n\t\t\t\t\ttr.append(td);\n\t\t\t\t}\n\t\t\t\tthis.$contentElement.append(tr);\n\t\t\t}\n\t\t\t\n\t\t\tthis._bindHandlers(\n\t\t\t\tangular.element(this.$contentElement[0].querySelectorAll('[tabindex]'))\n\t\t\t);\n\t\t\tthis.doLayout = this.monthlyLayout;\n\t\t};\n\t\t\n\t\tcomponent.prototype.dailyLayout = function(){\n\t\t\tvar currentDate = new Date(),\n\t\t\t\tselectedDate = this.getValue(),\n\t\t\t\twhichDay,\n\t\t\t\ttr, td,\n\t\t\t\tdate = new Date(this.getDate().getTime()),\n\t\t\t\tmonth = date.getMonth()\n\t\t\t;\n\t\t\t\n\t\t\tthis.setHeaderText(\n\t\t\t\tdateUtil.getNameOfMonth(date.getMonth()) \n\t\t\t\t+ ' '\n\t\t\t\t+ date.getFullYear()\n\t\t\t);\n\t\t\t \n\n\t\t\tthis.$contentElement.empty();\n\t\t\tthis.$headerActionElement.removeClass('x-deactive');\n\t\t\t\n\t\t\tdate.setDate(1);\n\t\t\twhichDay = date.getDay() - 1;\n\t\t\tif (whichDay === -1){\n\t\t\t\twhichDay = 6;\n\t\t\t}\n\n\t\t\tif (whichDay === 0){\n\t\t\t\tdate.setDate(date.getDate()-7);\n\t\t\t}else {\n\t\t\t\tdate.setDate(date.getDate()- whichDay);\n\t\t\t}\n\t\t\t\n\t\t\ttr = angular.element('<tr class=\"x-labels\"></tr>');\n\t\t\ttd = angular.element('<th>' + $translate.instant('date.monday') + '</th>'); \n\t\t\ttr.append(td);\n\t\t\ttd = angular.element('<th>' + $translate.instant('date.tuesday') + '</th>'); \n\t\t\ttr.append(td);\n\t\t\ttd = angular.element('<th>' + $translate.instant('date.wednesday') + '</th>');\n\t\t\ttr.append(td);\n\t\t\ttd = angular.element('<th>' + $translate.instant('date.thursday') + '</th>'); \n\t\t\ttr.append(td);\n\t\t\ttd = angular.element('<th>' + $translate.instant('date.friday') + '</th>'); \n\t\t\ttr.append(td);\n\t\t\ttd = angular.element('<th>' + $translate.instant('date.saturday') + '</th>'); \n\t\t\ttr.append(td);\n\t\t\ttd = angular.element('<th>' + $translate.instant('date.sunday') + '</th>');\n\t\t\ttr.append(td);\n\n\t\t\tthis.$contentElement.append(tr);\n\t\t\t\n\t\t\tfor (var i = 0; i<6; i++){\n\t\t\t\ttr = angular.element('<tr></tr>');\n\t\t\t\tfor (var j = 0; j<7; j++){\n\t\t\t\t\ttd = angular.element('<td>' + date.getDate() + '</td>');\n\t\t\t\t\ttd.addClass('x-day');\n\t\t\t\t\t\n\t\t\t\t\tif (month == date.getMonth()){\n\t\t\t\t\t\ttd.attr('tabindex', '-1');\n\t\t\t\t\t\t\n\t\t\t\t\t\tif (date.getDate() === currentDate.getDate() \n\t\t\t\t\t\t\t&& currentDate.getMonth() === date.getMonth() \n\t\t\t\t\t\t\t&& currentDate.getFullYear() === date.getFullYear()\n\t\t\t\t\t\t){\n\t\t\t\t\t\t\ttd.addClass('x-current');\n\t\t\t\t\t\t} \n\t\t\t\t\t\t\n\t\t\t\t\t\tif (selectedDate && date.getDate() === selectedDate.getDate() \n\t\t\t\t\t\t\t&& date.getMonth() === selectedDate.getMonth() \n\t\t\t\t\t\t\t&& date.getFullYear() === selectedDate.getFullYear()\n\t\t\t\t\t\t){\n\t\t\t\t\t\t\ttd.addClass('x-selected');\n\t\t\t\t\t\t} \n\t\t\t\t\t\ttd.data(\"date\",new Date(date.getTime()));\n\t\t\t\t\t} else {\n\t\t\t\t\t\ttd.addClass('x-other');\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\ttr.append(td);\n\t\t\t\t\tdate.setDate(date.getDate() + 1);\n\t\t\t\t}\n\t\t\t\tthis.$contentElement.append(tr);\n\t\t\t}\n\t\t\t\n\t\t\tthis._bindHandlers(\n\t\t\t\tangular.element(this.$contentElement[0].querySelectorAll('[tabindex]'))\n\t\t\t);\n\t\t\tthis.doLayout = this.dailyLayout;\n\t\t};\n\t\t\n\t\tcomponent.prototype.renderTo = function(element){\n\t\t\tthis.setRootElement(element);\n\t\t\tthis.render();\n\t\t};\n\t\t\n\t\tcomponent.prototype.render = function(){\n\t\t\tthis.reset();\n\t\t\tthis._renderInit();\n\t\t\tthis.doLayout();\n\t\t};\n\t\t\n\t\tcomponent.prototype.reset = function(){\n\t\t\t// reset date\n\t\t\tif (this.value) {\n\t\t\t\tthis.setDate(this.value);\n\t\t\t} else {\n\t\t\t\tthis.setDate(new Date());\n\t\t\t}\n\t\t\t\n\t\t\t// set daily render layout\n\t\t\tthis.doLayout = this.dailyLayout;\n\t\t}\n\t\t\n\t\treturn {\n\t\t\trestrict: 'A',\n\t\t\trequire: ['?ngModel','xpsuiCalendar','xpsuiDateEdit'],\n\t\t\tcontroller: component,\n\t\t\tlink: function(scope, elm, attrs, ctrls) {\n\t\t\t\t// var xpsuiCtrl = ctrls[0];\n\t\t\t\tvar ngModel = ctrls[0];\n\t\t\t\tvar xpsuiDatapickerCtrl = ctrls[1];\n\t\t\t\tvar xpsuiTextInputCtrl = ctrls[2];\n\t\t\t\tvar schemaFragment = scope.$eval(attrs.xpsuiSchema);\n\t\t\t\tvar dropdown = dropdownFactory.create(elm,{\n\t\t\t\t\ttitleTransCode: (schemaFragment ? schemaFragment.transCode : 'label.date')\n\t\t\t\t});\n\n\t\t\t\tdropdown.setInput(xpsuiTextInputCtrl.getInput())\n\t\t\t\t\t.render()\n\t\t\t\t;\n\n\t\t\t\telm.addClass('x-calendar-wrapper');\n\n\t\t\t\txpsuiDatapickerCtrl.setRootElement(elm);\n\t\t\t\txpsuiDatapickerCtrl.setInput(xpsuiTextInputCtrl.getInput());\n\t\t\t\t\n\t\t\t\tif(dropdown){\n\t\t\t\t\txpsuiDatapickerCtrl.setDropdown(dropdown);\n\t\t\t\t} else {\n\t\t\t\t\txpsuiDatapickerCtrl.render();\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tif (ngModel) {\n\t\t\t\t\txpsuiDatapickerCtrl.setOptions({\n\t\t\t\t\t\tonSelected: function(date){\n\t\t\t\t\t\t\txpsuiTextInputCtrl.getInput().val(\n\t\t\t\t\t\t\t\tdateUtil.formatter(date)\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\tscope.$apply(function() {\n\t\t\t\t\t\t\t\tngModel.$setViewValue(\n\t\t\t\t\t\t\t\t\tdateUtil.formatter(date)\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\n\t\t\t\t\tngModel.$render = function() {\n\t\t\t\t\t\txpsuiDatapickerCtrl.setValue(\n\t\t\t\t\t\t\tdateUtil.parser(ngModel.$viewValue)\n\t\t\t\t\t\t);\n\t\t\t\t\t\tif(xpsuiDatapickerCtrl.isRendered){\n\t\t\t\t\t\t\txpsuiDatapickerCtrl.render();\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t\txpsuiTextInputCtrl.getInput().val(ngModel.$viewValue || '');\n\t\t\t\t\t};\n\t\t\t\t\t\n\t\t\t\t\tngModel.$formatters.push(\n\t\t\t\t\t\tdateUtil.formatter\t\n\t\t\t\t\t);\n\t\t\t\t\tngModel.$parsers.push(\n\t\t\t\t\t\tdateUtil.parser\t\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t}\n\t\t};\t\n\t}]);\n}(window.angular));\n","(function(angular) {\n\t'use strict';\n\n\tangular.module('xpsui:directives')\n\t.directive('xpsuiConfirmClick', [\n\t\tfunction(){\n\t\t\treturn {\n\t\t\t\tlink: function (scope, element, attr) {\n\t\t\t\t\tvar msg = attr.xpsuiConfirmClick || \"Are you sure?\";\n\t\t\t\t\tvar clickAction = attr.xpsuiConfirmedClick;\n\t\t\t\t\telement.bind('click',function (event) {\n\t\t\t\t\t\tif ( window.confirm(msg) ) {\n\t\t\t\t\t\t\tscope.$eval(clickAction);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t};\n\t\t}]);\n\n}(window.angular));\n","(function(angular) {\n\t'use strict';\n\n\tangular.module('xpsui:directives')\n\t.directive('xpsuiContenteditable', ['xpsui:logging', '$compile', '$animate', '$timeout', function(log, $compile, $animate, $timeout) {\n\t\treturn {\n\t\t\trestrict: 'A',\n\t\t\trequire: ['ngModel'],\n\t\t\tlink: function(scope, elm, attrs, ctrls) {\n\t\t\t\tlog.group('contenteditable Link');\n\t\t\t\tvar ngModel = ctrls[0];\n\n\t\t\t\telm.addClass('x-contenteditable');\n\n\t\t\t\tvar buttonsHolder = angular.element('<div class=\"x-contenteditable-buttons-holder x-zero-height\"></div>');\n\t\t\t\tvar content = angular.element('<div class=\"x-contenteditable-content\" contenteditable=\"true\"><div>');\n\n\t\t\t\tngModel.$render = function() {\n\t\t\t\t\tif (typeof ngModel.$viewValue === 'string' ) {\t\n\t\t\t\t\t\tcontent.html(ngModel.$viewValue || '');\n\t\t\t\t\t} else {\n\t\t\t\t\t\tcontent.html('');\n\t\t\t\t\t}\n\t\t\t\t};\n\n\t\t\t\tvar commitData = function() {\n\t\t\t\t\tngModel.$setViewValue(content.html());\n\t\t\t\t};\n\n\t\t\t\t\n\t\t\t\telm.append(buttonsHolder);\n\t\t\t\telm.append(content);\n\n\n\t\t\t\tvar buttonLeft = angular.element('<button class=\"x-contenteditable-left\"></button>');\n\t\t\t\tvar buttonCenter = angular.element('<button class=\"x-contenteditable-center\"></button>');\n\t\t\t\tvar buttonRight = angular.element('<button class=\"x-contenteditable-right\"></button>');\n\t\t\t\tvar buttonJustify = angular.element('<button class=\"x-contenteditable-justify\"></button>');\n\t\t\t\tvar buttonBold = angular.element('<button class=\"x-contenteditable-bold\"></button>');\n\t\t\t\tvar buttonItalic = angular.element('<button class=\"x-contenteditable-italic\"></button>');\n\t\t\t\tvar buttonRemoveFormat = angular.element('<button class=\"x-contenteditable-remove-format\"></button>');\n\n\t\t\t\tvar buttonLink = angular.element('<button class=\"x-contenteditable-link\"></button>');\n\t\t\t\tvar buttonImage = angular.element('<button class=\"x-contenteditable-image\"></button>');\n\t\t\t\tvar buttonUndo = angular.element('<button class=\"x-contenteditable-undo\"></button>');\n\t\t\t\tvar buttonRedo = angular.element('<button class=\"x-contenteditable-redo\"></button>');\n\t\t\t\tvar buttonRemoveHeading = angular.element('<button class=\"x-contenteditable-h\">0</button>');\n\t\t\t\tvar buttonH1 = angular.element('<button class=\"x-contenteditable-h\">1</button>');\n\t\t\t\tvar buttonH2 = angular.element('<button class=\"x-contenteditable-h\">2</button>');\n\t\t\t\tvar buttonH3 = angular.element('<button class=\"x-contenteditable-h\">3</button>');\n\t\t\t\tvar buttonOL = angular.element('<button class=\"x-contenteditable-ol\"></button>');\n\t\t\t\tvar buttonUL = angular.element('<button class=\"x-contenteditable-ul\"></button>');\n\t\t\t\tvar buttonOutdent = angular.element('<button class=\"x-contenteditable-outdent\"></button>');\n\t\t\t\tvar buttonIndent = angular.element('<button class=\"x-contenteditable-indent\"></button>');\n\t\t\t\tvar buttonTable = angular.element('<button class=\"x-contenteditable-table\"></button>');\n\n\t\t\t\tbuttonsHolder.append(buttonLeft);\n\t\t\t\tbuttonsHolder.append(buttonCenter);\n\t\t\t\tbuttonsHolder.append(buttonRight);\n\t\t\t\tbuttonsHolder.append(buttonJustify);\n\t\t\t\tbuttonsHolder.append(buttonBold);\n\t\t\t\tbuttonsHolder.append(buttonItalic);\n\t\t\t\tbuttonsHolder.append(buttonRemoveFormat);\n\n\t\t\t\tbuttonsHolder.append(buttonLink);\n\t\t\t\tbuttonsHolder.append(buttonImage);\n\t\t\t\tbuttonsHolder.append(buttonUndo);\n\t\t\t\tbuttonsHolder.append(buttonRedo);\n\t\t\t\tbuttonsHolder.append(buttonRemoveHeading);\n\t\t\t\tbuttonsHolder.append(buttonH1);\n\t\t\t\tbuttonsHolder.append(buttonH2);\n\t\t\t\tbuttonsHolder.append(buttonH3);\n\t\t\t\tbuttonsHolder.append(buttonOL);\n\t\t\t\tbuttonsHolder.append(buttonUL);\n\t\t\t\tbuttonsHolder.append(buttonOutdent);\n\t\t\t\tbuttonsHolder.append(buttonIndent);\n\t\t\t\tbuttonsHolder.append(buttonTable);\n\n\t\t\t\tbuttonCenter.on('click', function(evt) {\n\t\t\t\t\tdocument.execCommand('justifyCenter', false, null);\n\t\t\t\t});\n\n\t\t\t\tbuttonLeft.on('click', function(evt) {\n\t\t\t\t\tdocument.execCommand('justifyLeft', false, null);\n\t\t\t\t\t//var htmlNodes = rangy.getSelection().getRangeAt(0).getNodes([1]);\n\n\t\t\t\t});\n\n\t\t\t\tbuttonRight.on('click', function(evt) {\n\t\t\t\t\tdocument.execCommand('justifyRight', false, null);\n\t\t\t\t});\n\n\t\t\t\tbuttonJustify.on('click', function(evt) {\n\t\t\t\t\tdocument.execCommand('justifyFull', false, null);\n\t\t\t\t});\n\n\t\t\t\tbuttonBold.on('click', function(evt) {\n\t\t\t\t\tdocument.execCommand('bold', false, null);\n\t\t\t\t});\n\n\t\t\t\tbuttonItalic.on('click', function(evt) {\n\t\t\t\t\tdocument.execCommand('italic', false, null);\n\t\t\t\t});\n\n\t\t\t\tbuttonRemoveFormat.on('click', function(evt) {\n\t\t\t\t\tdocument.execCommand('removeFormat', false, null);\n\t\t\t\t});\n\n\t\t\t\tbuttonRemoveHeading.on('click', function(evt) {\n\t\t\t\t\tdocument.execCommand('formatBlock', false, 'div');\n\t\t\t\t});\n\n\n\t\t\t\tbuttonImage.on('click', function(evt) {\n\t\t\t\t\t//TODO propper image url selection dialog\n\t\t\t\t\t//TODO handle if image is already selected, we should edit it instead inserting one\n\t\t\t\t\tvar url = prompt('Please enter URL');\n\n\t\t\t\t\tif (url) {\n\t\t\t\t\t\tdocument.execCommand('insertHTML', false, '<img xpsui-contenteditable/>');\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\tbuttonLink.on('click', function(evt) {\n\t\t\t\t\t//TODO proper link url selection dialog\n\t\t\t\t\t//TODO handle if link is already selected, we should edit it instead inserting one\n\t\t\t\t\tvar url = prompt('Please enter URL');\n\n\t\t\t\t\tif (url) {\n\t\t\t\t\t\tdocument.execCommand('createLink', false, url);\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\tbuttonUndo.on('click', function(evt) {\n\t\t\t\t\tdocument.execCommand('undo', false, null);\n\t\t\t\t});\n\n\t\t\t\tbuttonRedo.on('click', function(evt) {\n\t\t\t\t\tdocument.execCommand('redo', false, null);\n\t\t\t\t});\n\n\t\t\t\tbuttonH1.on('click', function(evt) {\n\t\t\t\t\tdocument.execCommand('formatBlock', false, \"H1\");\n\t\t\t\t});\n\n\t\t\t\tbuttonH2.on('click', function(evt) {\n\t\t\t\t\tdocument.execCommand('formatBlock', false, \"H2\");\n\t\t\t\t});\n\n\t\t\t\tbuttonH3.on('click', function(evt) {\n\t\t\t\t\tdocument.execCommand('formatBlock', false, \"H3\");\n\t\t\t\t});\n\n\t\t\t\tbuttonOL.on('click', function(evt) {\n\t\t\t\t\tdocument.execCommand('insertOrderedList', false, null);\n\t\t\t\t});\n\n\t\t\t\tbuttonUL.on('click', function(evt) {\n\t\t\t\t\tdocument.execCommand('insertUnorderedList', false, null);\n\t\t\t\t});\n\n\t\t\t\tbuttonOutdent.on('click', function(evt) {\n\t\t\t\t\tdocument.execCommand('outdent', false, null);\n\t\t\t\t});\n\n\t\t\t\tbuttonIndent.on('click', function(evt) {\n\t\t\t\t\tdocument.execCommand('indent', false, null);\n\t\t\t\t});\n\n\t\t\t\tfunction pasteHtmlAtCaret(html, selectPastedContent) {\n\t\t\t\t\tvar sel, range;\n\t\t\t\t\tif (window.getSelection) {\n\t\t\t\t\t\t// IE9 and non-IE\n\t\t\t\t\t\tsel = window.getSelection();\n\t\t\t\t\t\tif (sel.getRangeAt && sel.rangeCount) {\n\t\t\t\t\t\t\trange = sel.getRangeAt(0);\n\t\t\t\t\t\t\trange.deleteContents();\n\n\t\t\t\t\t\t\t// Range.createContextualFragment() would be useful here but is\n\t\t\t\t\t\t\t// only relatively recently standardized and is not supported in\n\t\t\t\t\t\t\t// some browsers (IE9, for one)\n\t\t\t\t\t\t\tvar el = document.createElement(\"div\");\n\t\t\t\t\t\t\tel.innerHTML = html;\n\t\t\t\t\t\t\tvar frag = document.createDocumentFragment(), node, lastNode;\n\t\t\t\t\t\t\twhile ( (node = el.firstChild) ) {\n\t\t\t\t\t\t\t\tlastNode = frag.appendChild(node);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tvar firstNode = frag.firstChild;\n\t\t\t\t\t\t\trange.insertNode(frag);\n\n\t\t\t\t\t\t\t// Preserve the selection\n\t\t\t\t\t\t\tif (lastNode) {\n\t\t\t\t\t\t\t\trange = range.cloneRange();\n\t\t\t\t\t\t\t\trange.setStartAfter(lastNode);\n\t\t\t\t\t\t\t\tif (selectPastedContent) {\n\t\t\t\t\t\t\t\t\trange.setStartBefore(firstNode);\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\trange.collapse(true);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tsel.removeAllRanges();\n\t\t\t\t\t\t\t\tsel.addRange(range);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t} else if ( (sel = document.selection) && sel.type != \"Control\") {\n\t\t\t\t\t\t// IE < 9\n\t\t\t\t\t\tvar originalRange = sel.createRange();\n\t\t\t\t\t\toriginalRange.collapse(true);\n\t\t\t\t\t\tsel.createRange().pasteHTML(html);\n\t\t\t\t\t\tif (selectPastedContent) {\n\t\t\t\t\t\t\trange = sel.createRange();\n\t\t\t\t\t\t\trange.setEndPoint(\"StartToStart\", originalRange);\n\t\t\t\t\t\t\trange.select();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tbuttonTable.on('click', function(evt) {\n\t\t\t\t\tvar rowstext = prompt(\"enter rows\");\n\t\t\t\t\tvar colstext = prompt(\"enter cols\");\n\t\t\t\t\tvar rows = parseInt(rowstext);\n\t\t\t\t\tvar cols = parseInt(colstext);\n\t\t\t\t\tvar table,tbody,tr,td,br;\n\t\t\t\t\tif ((rows > 0) && (cols > 0)) {\n\t\t\t\t\t\ttable = angular.element(\"<table></table>\");\n\t\t\t\t\t\ttbody = angular.element(\"<tbody></tbody>\");\n\t\t\t\t\t\tfor (var i = 0; i < rows; i++) {\n\t\t\t\t\t\t\ttr = angular.element(\"<tr></tr>\");\n\t\t\t\t\t\t\tfor (var j = 0; j < cols; j++) {\n\t\t\t\t\t\t\t\ttd = angular.element(\"<td></td>\");\n\t\t\t\t\t\t\t\tbr = angular.element(\"</br>\");\n\t\t\t\t\t\t\t\ttd.append(br);\n\t\t\t\t\t\t\t\ttr.append(td);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\ttbody.append(tr);\n\t\t\t\t\t\t}\n\t\t\t\t\t\ttable.append(tbody);\n\n\n\t\t\t\t\t\tpasteHtmlAtCaret(table[0].outerHTML, content);\n\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\tvar buttonsHide = function() {\n\t\t\t\t\tbuttonsHolder.addClass('x-zero-height');\n\t\t\t\t\tconsole.log('dddd');\n\t\t\t\t};\n\n\t\t\t\tvar buttonsShow = function() {\n\t\t\t\t\tbuttonsHolder.removeClass('x-zero-height');\n\t\t\t\t};\n\n\t\t\t\tvar buttonsHideTimeout = $timeout(buttonsHide, 5000, false);\n\n\t\t\t\telm.on('mousemove', function(evt) {\n\t\t\t\t\t$timeout.cancel(buttonsHideTimeout);\n\t\t\t\t\tbuttonsHideTimeout = null;\n\t\t\t\t\tbuttonsHolder.removeClass('x-zero-height');\n\t\t\t\t\tbuttonsHideTimeout = $timeout(buttonsHide, 5000, false);\n\t\t\t\t});\n\n\t\t\t\tcontent.on('blur keyup', function(evt) {\n\t\t\t\t\tscope.$apply(commitData);\n\t\t\t\t});\n\n\t\t\t\tcontent.on('mouseup keyup', function(evt){\n\t\t\t\t\tvar ua = window.navigator.userAgent;\n\t\t\t\t\tvar msie = ua.indexOf('MSIE ');\n\t\t\t\t\tvar trident = ua.indexOf('Trident/');\n\t\t\t\t\tif (!(msie > 0 || trident > 0)) {\n\t\t\t\t\t\tvar htmlNodes = rangy.getSelection();\n\n\t\t\t\t\t\tvar htmlElements = [];\n\t\t\t\t\t\tif (!htmlNodes.containsNode(content[0],false)){\n\t\t\t\t\t\t\thtmlNodes = htmlNodes.getAllRanges();\n\t\t\t\t\t\t\tif (htmlNodes.length > 0){\n\t\t\t\t\t\t\t\thtmlNodes = htmlNodes[0].startContainer;\n\t\t\t\t\t\t\t\twhile (htmlNodes != content[0] && htmlNodes.parentElement != content[0]){\n\t\t\t\t\t\t\t\t\thtmlNodes = htmlNodes.parentElement;\n\t\t\t\t\t\t\t\t\tif (htmlNodes.getAttribute('align')){\n\t\t\t\t\t\t\t\t\t\thtmlElements.push(htmlNodes.getAttribute('align'));\n\n\t\t\t\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\t\t\t\thtmlElements.push(htmlNodes.nodeName);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\thtmlNodes = rangy.getSelection().getAllRanges();\n\t\t\t\t\t\t\tvar htmlElements2 = [];\n\t\t\t\t\t\t\tif (htmlNodes.length > 0) {\n\t\t\t\t\t\t\t\thtmlNodes = htmlNodes[0].endContainer;\n\t\t\t\t\t\t\t\twhile (htmlNodes != content[0] && htmlNodes.parentElement != content[0]) {\n\t\t\t\t\t\t\t\t\thtmlNodes = htmlNodes.parentElement;\n\n\t\t\t\t\t\t\t\t\tif (getComputedStyle(htmlNodes).getPropertyValue('font-weight')) {\n\t\t\t\t\t\t\t\t\t\thtmlElements.push(getComputedStyle(htmlNodes).getPropertyValue('font-weight'));\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tif (getComputedStyle(htmlNodes).getPropertyValue('font-style')) {\n\t\t\t\t\t\t\t\t\t\thtmlElements.push(getComputedStyle(htmlNodes).getPropertyValue('font-style'));\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tif (htmlNodes.getAttribute('align')) {\n\t\t\t\t\t\t\t\t\t\thtmlElements.push(htmlNodes.getAttribute('align'));\n\t\t\t\t\t\t\t\t\t} else if(getComputedStyle(htmlNodes).getPropertyValue('text-align')) {\n\t\t\t\t\t\t\t\t\t\thtmlElements.push(getComputedStyle(htmlNodes).getPropertyValue('text-align'));\n\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\thtmlElements2.push(htmlNodes.nodeName);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\thtmlElements = htmlElements.concat(htmlElements2);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tvar isBold = false;\n\t\t\t\t\t\tvar isItalic = false;\n\t\t\t\t\t\tvar isH1 = false;\n\t\t\t\t\t\tvar isH2 = false;\n\t\t\t\t\t\tvar isH3 = false;\n\t\t\t\t\t\tvar align = 0;\n\t\t\t\t\t\tvar isOL = false;\n\t\t\t\t\t\tvar isUL = false;\n\t\t\t\t\t\tvar isTable = false;\n\n\t\t\t\t\t\tfor (var i = 0; i < htmlElements.length; i++){\n\n\t\t\t\t\t\t\tif (htmlElements[i] == \"B\") {\n\t\t\t\t\t\t\t\tisBold = true;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (htmlElements[i] == \"I\") {\n\t\t\t\t\t\t\t\tisItalic = true;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (htmlElements[i] == \"H1\") {\n\t\t\t\t\t\t\t\tisH1 = true;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (htmlElements[i] == \"H2\") {\n\t\t\t\t\t\t\t\tisH2 = true;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (htmlElements[i] == \"H3\") {\n\t\t\t\t\t\t\t\tisH3 = true;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (htmlElements[i] == \"left\") {\n\t\t\t\t\t\t\t\talign = 0;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (htmlElements[i] == \"right\") {\n\t\t\t\t\t\t\t\talign = 1;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (htmlElements[i] == \"center\") {\n\t\t\t\t\t\t\t\talign = 2;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (htmlElements[i] == \"justify\") {\n\t\t\t\t\t\t\t\talign = 3;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (htmlElements[i] == \"OL\") {\n\t\t\t\t\t\t\t\tisOL = true;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (htmlElements[i] == \"UL\") {\n\t\t\t\t\t\t\t\tisUL = true;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (htmlElements[i] == \"TABLE\") {\n\t\t\t\t\t\t\t\tisTable = true;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (isBold) {\n\t\t\t\t\t\t\tbuttonBold.addClass(\"chosen\");\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tbuttonBold.removeClass(\"chosen\");\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (isItalic) {\n\t\t\t\t\t\t\tbuttonItalic.addClass(\"chosen\");\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tbuttonItalic.removeClass(\"chosen\");\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (isH1) {\n\t\t\t\t\t\t\tbuttonH1.addClass(\"chosen\");\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tbuttonH1.removeClass(\"chosen\");\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (isH2) {\n\t\t\t\t\t\t\tbuttonH2.addClass(\"chosen\");\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tbuttonH2.removeClass(\"chosen\");\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (isH3) {\n\t\t\t\t\t\t\tbuttonH3.addClass(\"chosen\");\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tbuttonH3.removeClass(\"chosen\");\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (align === 0) {\n\t\t\t\t\t\t\tbuttonLeft.addClass(\"chosen\");\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tbuttonLeft.removeClass(\"chosen\");\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (align === 1) {\n\t\t\t\t\t\t\tbuttonRight.addClass(\"chosen\");\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tbuttonRight.removeClass(\"chosen\");\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (align === 2) {\n\t\t\t\t\t\t\tbuttonCenter.addClass(\"chosen\");\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tbuttonCenter.removeClass(\"chosen\");\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (align === 3) {\n\t\t\t\t\t\t\tbuttonJustify.addClass(\"chosen\");\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tbuttonJustify.removeClass(\"chosen\");\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (isOL) {\n\t\t\t\t\t\t\tbuttonOL.addClass(\"chosen\");\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tbuttonOL.removeClass(\"chosen\");\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (isUL) {\n\t\t\t\t\t\t\tbuttonUL.addClass(\"chosen\");\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tbuttonUL.removeClass(\"chosen\");\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (isTable) {\n\t\t\t\t\t\t\tbuttonTable.addClass(\"chosen\");\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tbuttonTable.removeClass(\"chosen\");\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\t//commitData();\n\n\t\t\t\tlog.groupEnd();\n\t\t\t}\n\t\t};\n\t}]);\n}(window.angular));\n","(function(angular) {\n\t'use strict';\n\n\tangular.module('xpsui:directives')\n\t.directive('xpsuiDashboardWidgetEmpty', ['xpsui:logging', '$compile', function(log, $compile) {\n\t\treturn {\n\t\t\tlink: function(scope, elm, attrs, ctrls) {\n\t\t\t\tlog.group('xpsui-dashboard-widget-empty Widget');\n\t\t\t\tconsole.log('hello!');\n\n\t\t\t\telm.empty();\n\n\t\t\t\telm.addClass('dashboard-widget-container');\n\t\t\t\tvar titleBar = angular.element('<div class=\"dashboard-widget-title\">Empty widget</div>');\n\t\t\t\tvar content = angular.element(\n\t\t\t\t\t'<div class=\"dashboard-widget-content\">'\n\t\t\t\t\t+ 'Empty widget content.<br/>'\n\t\t\t\t\t+ '</div>');\n\n\t\t\t\telm.append(titleBar);\n\t\t\t\telm.append(content);\n\n\t\t\t\t$compile(titleBar)(scope);\n\t\t\t\t$compile(content)(scope);\n\n\t\t\t\tlog.groupEnd();\n\t\t\t}\n\t\t};\n\t}]);\n\n}(window.angular));\n","(function(angular) {\n\t'use strict';\n\n\tfunction createWidgetBlock(title, content) {\n\t\tvar block = angular.element('<div class=\"dashboard-widget-block\">'\n\t\t\t\t+ '<div class=\"dashboard-widget-block-title\">' + title + '<div>'\n\t\t\t\t+ '</div>');\n\t\tvar contentDiv = angular.element('<div class=\"dashboard-widget-block-content\"><div>');\n\t\tcontentDiv.append(content);\t\n\t\tblock.append(contentDiv);\n\t\treturn block;\n\t}\n\n\tangular.module('xpsui:directives')\n\t.directive('xpsuiDashboardWidgetRequests', \n\t\t\t['xpsui:logging', '$compile', '$translate', '$http', '$location', 'xpsui:SchemaUtil', 'xpsui:NotificationFactory',\n\t\t\t 'xpsui:NavigationService',\n\t        function(log, $compile, $translate, $http, $location, schemaUtilFactory, notificationFactory, navigationService) {\n\t\treturn {\n\t\t\tcontroller: function($scope, $element, $attrs) {\n\t\t\t},\n\t\t\tlink: function(scope, elm, attrs, ctrls) {\n\t\t\t\tscope.showRegistrations = function() {\n\t\t\t\t\tnavigationService.navigateToPath(\n\t\t\t\t\t\t\t'/registry/search/uri~3A~2F~2Fregistries~2Frequests~23views~2FpeopleRegistrationApplicant~2Fsearch', \n\t\t\t\t\t\t\t'search');\n\t\t\t\t\t$location.path('/registry/search/uri~3A~2F~2Fregistries~2Frequests~23views~2FpeopleRegistrationApplicant~2Fsearch');\n\t\t\t\t};\n\n\t\t\t\tscope.showDataChanges = function() {\n\t\t\t\t\tnavigationService.navigateToPath(\n\t\t\t\t\t\t\t'/registry/search/uri~3A~2F~2Fregistries~2Frequests~23views~2FdataChangeApplicant~2Fsearch',\n\t\t\t\t\t\t\t'search');\n\t\t\t\t\t$location.path('/registry/search/uri~3A~2F~2Fregistries~2Frequests~23views~2FdataChangeApplicant~2Fsearch');\n\t\t\t\t}\n\n\t\t\t\tscope.showTransfers = function() {\n\t\t\t\t\tnavigationService.navigateToPath(\n\t\t\t\t\t\t\t'/registry/search/uri~3A~2F~2Fregistries~2Frequests~23views~2FtransferApplicant~2Fsearch',\n\t\t\t\t\t\t\t'search');\n\t\t\t\t\t$location.path('/registry/search/uri~3A~2F~2Fregistries~2Frequests~23views~2FtransferApplicant~2Fsearch');\n\t\t\t\t}\n\n\t\t\t\tscope.showRegistrationsSolver = function(){\n\t\t\t\t\tnavigationService.navigateToPath(\n\t\t\t\t\t\t\t'/registry/search/uri~3A~2F~2Fregistries~2Frequests~23views~2FpeopleRegistrationSolver~2Fsearch', \n\t\t\t\t\t\t\t'search');\n\t\t\t\t\t$location.path('/registry/search/uri~3A~2F~2Fregistries~2Frequests~23views~2FpeopleRegistrationSolver~2Fsearch');\n\t\t\t\t}\n\n\t\t\t\tscope.showDataChangesSolver = function(){\n\t\t\t\t\tnavigationService.navigateToPath(\n\t\t\t\t\t\t\t'/registry/search/uri~3A~2F~2Fregistries~2Frequests~23views~2FdataChangeSolver~2Fsearch', \n\t\t\t\t\t\t\t'search');\n\t\t\t\t\t$location.path('/registry/search/uri~3A~2F~2Fregistries~2Frequests~23views~2FdataChangeSolver~2Fsearch');\n\t\t\t\t}\n\n\t\t\t\tscope.showTransfersSolver = function(){\n\t\t\t\t\tnavigationService.navigateToPath(\n\t\t\t\t\t\t\t'/registry/search/uri~3A~2F~2Fregistries~2Frequests~23views~2FtransferSolver~2Fsearch', \n\t\t\t\t\t\t\t'search');\n\t\t\t\t\t$location.path('/registry/search/uri~3A~2F~2Fregistries~2Frequests~23views~2FtransferSolver~2Fsearch');\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\t// Gets the number of results for a search query specified by the URI.\n\t\t\t\tvar getCount = function (uri, block, onClick){\n\t\t\t\t\t$http({ method : 'POST',\n\t\t\t\t\t\turl: '/search/' + schemaUtilFactory.encodeUri(uri)})\n\t\t\t\t\t.success(function(data, status, headers, config) {\n\t\t\t\t\t\tblock.empty();\n\t\t\t\t\t\tif (data) {\n\t\t\t\t\t\t\tblock.html(\n\t\t\t\t\t\t\t\t\t'<span>' + data.length + '</span><br/>'\n\t\t\t\t\t\t\t\t\t+ ' <a ng-click=\" ' + onClick + ' \">' + $translate.instant('generic.more') + '</a>');\n\t\t\t\t\t\t\t$compile(block)(scope);\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tvar label_noOpenRequests = $translate.instant('dashboard.widget.members.noOpenRequests');\n\t\t\t\t\t\tblock.text(label_noOpenRequests);\n\t\t\t\t\t}).error(function(err) {\n\t\t\t\t\t\tnotificationFactory.error(err);\n\t\t\t\t\t});\t\t\n\t\t\t\t}\n\n\t\t\t\tlog.group('xpsui-dashboard-widget-requests Widget');\n\n\t\t\t\telm.empty();\n\n\t\t\t\telm.addClass('dashboard-widget-container');\n\t\t\t\tvar title = $translate.instant('dashboard.widget.notifications.title');\n\t\t\t\tvar titleBar = angular.element('<div class=\"dashboard-widget-title\">' + title + '</div>');\n\n\t\t\t\tvar content = angular.element(\n\t\t\t\t\t'<div class=\"dashboard-widget-content\">'\n\t\t\t\t\t+ '</div>');\n\t\t\t\tvar blocks = angular.element('<div class=\"dashboard-widget-blocks\"></div>');\n\t\t\t\tcontent.append(blocks);\n\n\t\t\t\tvar label_loading = $translate.instant('generic.loading');\n\n\t\t\t\tvar contentBlock1Elm = angular.element('<div>' + label_loading + '</div>');\n\t\t\t\tvar contentBlock2Elm = angular.element('<div>' + label_loading + '</div>');\n\t\t\t\tvar contentBlock3Elm = angular.element('<div>' + label_loading + '</div>');\n\t\t\t\t\n\t\t\t\t//If the user can solve requests, the request solver search results are used\n\t\t\t\tif (scope.hasPermissions(['Registry - read'])){\n\t\t\t\t\tvar contentBlock1Title = $translate.instant('dashboard.widget.members.openRequests');\n\t\t\t\t\tvar contentBlock2Title = $translate.instant('dashboard.widget.data.openRequests');\n\t\t\t\t\tvar contentBlock3Title = $translate.instant('dashboard.widget.transfer.openRequests');\n\n\t\t\t\t\tgetCount('uri://registries/requests#views/peopleRegistrationSolver/search', contentBlock1Elm, 'showRegistrationsSolver()');\n\t\t\t\t\tgetCount('uri://registries/requests#views/dataChangeSolver/search', contentBlock2Elm, 'showDataChangesSolver()');\n\t\t\t\t\tgetCount('uri://registries/requests#views/transferSolver/search', contentBlock3Elm, 'showTransfersSolver()');\n\t\t\t\t} \n\t\t\t\t// If the user can only create requests, the request applicant search results are used\n\t\t\t\telse if (scope.hasPermissions(['Registry Requests'])){\n\t\t\t\t\tvar contentBlock1Title = $translate.instant('dashboard.widget.members.openRequests');\n\t\t\t\t\tvar contentBlock2Title = $translate.instant('dashboard.widget.data.openRequests');\n\t\t\t\t\tvar contentBlock3Title = $translate.instant('dashboard.widget.transfer.openRequests');\n\n\t\t\t\t\tgetCount('uri://registries/requests#views/peopleRegistrationApplicant/search', contentBlock1Elm, 'showRegistrations()');\n\t\t\t\t\tgetCount('uri://registries/requests#views/dataChangeApplicant/search', contentBlock2Elm,'showDataChanges()');\n\t\t\t\t\tgetCount('uri://registries/requests#views/transferApplicant/search', contentBlock3Elm, 'showTransfers()');\n\t\t\t\t} \n\n\t\t\t\tvar block1 = createWidgetBlock(contentBlock1Title, contentBlock1Elm)\n\t\t\t\tblocks.append(block1);\n\n\t\t\t\tvar block2 = createWidgetBlock(contentBlock2Title, contentBlock2Elm)\n\t\t\t\tblocks.append(block2);\n\n\t\t\t\tvar block3 = createWidgetBlock(contentBlock3Title, contentBlock3Elm)\n\t\t\t\tblocks.append(block3);\n\n\t\t\t\telm.append(titleBar);\n\t\t\t\telm.append(content);\n\n\t\t\t\tlog.groupEnd();\n\t\t\t}\n\t\t};\n\t}]);\n\n}(window.angular));\n","(function(angular) {\n\t'use strict';\n\n\tangular.module('xpsui:directives')\n\t.directive('xpsuiDateEdit', ['xpsui:logging', function(log) {\n\t\treturn {\n\t\t\trestrict: 'A',\n\t\t\trequire: ['ngModel', '?^xpsuiFormControl', 'xpsuiDateEdit'],\n\t\t\tcontroller: function($scope, $element, $attrs) {\n\t\t\t\tthis.setup = function(){\n\t\t\t\t\tthis.$input = angular.element('<input></input>');\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tthis.getInput = function(){\n\t\t\t\t\treturn this.$input;\n\t\t\t\t}\n\n\t\t\t\tthis.$input = null;\n\t\t\t\tthis.setup();\n\t\t\t\t\n\t\t\t},\n\t\t\tlink: function(scope, elm, attrs, ctrls) {\n\t\t\t\tlog.group('String edit Link');\n\n\t\t\t\tvar ngModel = ctrls[0];\n\t\t\t\tvar formControl = ctrls[1] || {};\n\t\t\t\tvar selfControl = ctrls[2];\n\n\t\t\t\tvar input = selfControl.getInput();\n\n\t\t\t\telm.addClass('x-control');\n\t\t\t\telm.addClass('x-date-edit');\n\n\t\t\t\tngModel.$render = function() {\n\t\t\t\t\tinput.val(ngModel.$viewValue || '');\n\t\t\t\t\tformControl.oldValue = ngModel.$modelValue;\n\t\t\t\t};\n\n\t\t\t\telm.append(input);\n\n\t\t\t\tinput.on('change', function(evt) {\n\t\t\t\t\tscope.$apply(function() {\n\t\t\t\t\t\tngModel.$setViewValue(input.val());\n\t\t\t\t\t});\n\t\t\t\t});\n\n\t\t\t\telm.bind('focus', function(evt) {\n\t\t\t\t\tinput[0].focus();\n\t\t\t\t});\n\n\t\t\t\tlog.groupEnd();\n\t\t\t}\n\t\t};\n\t}]);\n\n}(window.angular));\n\n","(function(angular) {\n\t'use strict';\n\n\tangular.module('xpsui:directives')\n\t.directive('xpsuiDateView', ['xpsui:logging','xpsui:DateUtil', function(log, dateUtil) {\n\t\treturn {\n\t\t\trestrict: 'A',\n\t\t\trequire: ['ngModel'],\n\t\t\tlink: function(scope, elm, attrs, ctrls) {\n\t\t\t\tlog.group('String view Link');\n\n\t\t\t\tvar ngModel = ctrls[0];\n\t\t\t\tvar view = angular.element('<div></div>');\n\n\t\t\t\telm.addClass('x-control');\n\t\t\t\telm.addClass('x-date-view');\n\n\t\t\t\tngModel.$render = function() {\n\t\t\t\t\tview.text(dateUtil.formatter(ngModel.$viewValue) || ' ');\t\n\t\t\t\t};\n\n\t\t\t\telm.append(view);\n\t\t\t\tlog.groupEnd();\n\t\t\t}\n\t\t};\n\t}]);\n\n}(window.angular));\n","(function(angular) {\r\n\t'use strict';\r\n\r\n\tangular.module('xpsui:directives')\r\n\t.directive('xpsuiDefaultSrc', ['xpsui:logging', function (log) {\r\n\t\treturn {\r\n\t\t\trestrict: 'A',\r\n\t\t\tlink: function(scope, elm, attrs) {\r\n\t\t\t\tif (attrs.ngSrc) {\r\n\t\t\t\t\t// ngSrc is set so lets watch its expression and set default src if ngSrc value is empty\r\n\t\t\t\t\t// TODO handle attribute change by $observe\r\n\t\t\t\t\tscope.$watch(function() {\r\n\t\t\t\t\t\treturn attrs.ngSrc;\r\n\t\t\t\t\t}, function(newVal) {\r\n\t\t\t\t\t\tconsole.log(newVal + attrs.ngSrc);\r\n\t\t\t\t\t\tif (newVal === null || newVal.length < 1) {\r\n\t\t\t\t\t\t\t// src is not set, lets use default src\r\n\t\t\t\t\t\t\telm.attr('src', attrs.xpsuiDefaultSrc);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t} else {\r\n\t\t\t\t\telm.attr('src', attrs.xpsuiDefaultSrc);\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// handle 404 and other error states by default inmage\r\n\t\t\t\telm.bind('error', function() {\r\n\t\t\t\t\telm.attr('src', attrs.xpsuiDefaultSrc);\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t};\r\n\t}]);\r\n\r\n}(window.angular));","(function(angular) {\n\t'use strict';\n\n\tangular.module('xpsui:directives')\n\n\t/**\n\t * Renders and manages block of form components. Mainly used for schema render.\n\t *\n\t * @module client\n\t * @submodule directives\n\t * @class xpsui-fieldset\n\t */\n\t.directive('xpsuiFieldset', ['xpsui:logging', 'xpsui:FormGenerator', '$translate', \n\t\tfunction(log, formGenerator, $translate) {\n\t\t\treturn {\n\t\t\t\trestrict: 'A',\n\t\t\t\tlink: function(scope, elm, attrs, ctrls) {\n\t\t\t\t\tlog.group('FieldSet Link');\n\n\t\t\t\t\t/**\n\t\t\t\t\t * NgModel binding for fieldset\n\t\t\t\t\t * @default false\n\t\t\t\t\t * @required true\n\t\t\t\t\t * @attribute xpsui-model\n\t\t\t\t\t */\n\t\t\t\t\tvar modelPath = attrs.xpsuiModel;\n\n\t\t\t\t\t/**\n\t\t\t\t\t * Options used for directive processing. It can consume schema fragment\n\t\t\t\t\t * @default false\n\t\t\t\t\t * @required true\n\t\t\t\t\t * @attribute xpsui-options\n\t\t\t\t\t */\n\t\t\t\t\tvar options = attrs.xpsuiOptions;\n\n\t\t\t\t\telm.addClass('x-fieldset');\n\n\t\t\t\t\tif (modelPath && options) {\n\t\t\t\t\t} else {\n\t\t\t\t\t\tlog.warn('Attributes xpsui-model and xpsui-options have to be set, skipping fieldset generation');\n\t\t\t\t\t\tlog.groupEnd();\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tvar schema = scope.$eval(options);\n\t\t\t\t\tvar mode = attrs.xpsuiFieldset;\n\n\t\t\t\t\tif (schema) {\n\t\t\t\t\t\t/**\n\t\t\t\t\t\t * full screen render\n\t\t\t\t\t\t */\n\t\t\t\t\t\tif (schema.render && schema.render.width) {\n\t\t\t\t\t\t\tswitch (schema.render.width) {\n\t\t\t\t\t\t\t\tcase 'full': \n\t\t\t\t\t\t\t\t\telm.addClass('x-fieldset-full');\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif (schema && (schema.title || schema.transCode)) {\n\t\t\t\t\t\t// TODO translation\n\t\t\t\t\t\telm.append('<div class=\"x-fieldset-title\">' \n\t\t\t\t\t\t\t+ (schema.transCode ? $translate.instant(schema.transCode) : schema.title)\n\t\t\t\t\t\t\t+ '</div>'\n\t\t\t\t\t\t);\n\n\t\t\t\t\t} else {\n\t\t\t\t\t\telm.append('<div class=\"x-fieldset-title\"></div>');\n\t\t\t\t\t}\n\n\t\t\t\t\tvar content = angular.element('<div class=\"x-fieldset-content\"></div>');\n\t\t\t\t\telm.append(content);\n\t\t\t\t\tformGenerator.generateForm(scope, content, schema, options, modelPath, mode || formGenerator.MODE.VIEW);\n\n\t\t\t\t\tlog.groupEnd();\n\t\t\t\t}\n\t\t\t};\n\t\t}\n\t]);\n\n}(window.angular));\n","(function(angular) {\n\t'use strict';\n\n\tangular.module('xpsui:directives')\n\t.directive('xpsuiFormControl', ['xpsui:logging', function(log) {\n\t\treturn {\n\t\t\trestrict: 'A',\n\t\t\tcontroller: function() {\n\t\t\t\tthis.form = null;\n\t\t\t\tthis.focusedElm = null;\n\t\t\t\tthis.oldValue = null;\n\n\t\t\t\tthis.acquireFocus = function(e) {\n\t\t\t\t\treturn this.form.acquireFocus(e);\n\t\t\t\t};\n\n\t\t\t\tthis.releaseFocus = function(e) {\n\t\t\t\t\tthis.form.releaseFocus(e);\n\t\t\t\t};\n\n\t\t\t\tthis.commit = function() {\n\t\t\t\t};\n\n\t\t\t\tthis.rollback = function() {\n\t\t\t\t};\n\n\t\t\t},\n\t\t\trequire: ['xpsuiFormControl', '^xpsuiForm', '?ngModel'],\n\t\t\tlink: function(scope, elm, attrs, ctrls) {\n\t\t\t\tvar formControl = ctrls[0];\n\t\t\t\tvar form = ctrls[1];\n\t\t\t\tvar ngModel = ctrls[2];\n\n\t\t\t\tformControl.form = form;\n\n\t\t\t\t// Check if this field is calculation\n\t\t\t\tvar schema = scope.$eval(attrs.xpsuiSchema);\n\t\t\t\tif (schema.calculation && form) {\n\t\t\t\t\tlog.debug(\"Registering calculation\");\n\t\t\t\t\t// Register calculation using the form controller\n\t\t\t\t\tvar unregister = form.registerCalculation(attrs.xpsuiModel, schema.calculation);\n\t\t\t\t\t// Deregister calculation on $destroy\n\t\t\t\t\tscope.$on('destroy', unregister);\n\t\t\t\t}\n\n\t\t\t}\n\t\t};\n\t}]);\n\n}(window.angular));\n\n\n","(function(angular) {\n\t'use strict';\n\n\tangular.module('xpsui:directives')\n\t.directive('xpsuiForm', [\n\t\t'$compile', '$parse', 'xpsui:logging', 'xpsui:FormGenerator', 'xpsui:Calculator', '$translate',\n\t\tfunction($compile, $parse, log, formGenerator, calculator, $translate) {\n\t\t\treturn {\n\t\t\t\trestrict: 'A',\n\t\t\t\trequire: '^form',\n\t\t\t\tcontroller: [ '$scope', '$element', '$attrs', function($scope, $element, $attrs) {\n\t\t\t\t\tthis.focusedElm = null;\n\n\t\t\t\t\tthis.acquireFocus = function(e) {\n\t\t\t\t\t\tif (this.focusedElm === null || this.focusedElm === e) {\n\t\t\t\t\t\t\tthis.focusedElm = e;\n\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t};\n\n\t\t\t\t\tthis.releaseFocus = function(e) {\n\t\t\t\t\t\tif (this.focusedElm === e) {\n\t\t\t\t\t\t\tthis.focusedElm = null;\n\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t};\n\n\t\t\t\t\t/**\n\t\t\t\t\t * Registers a calculation for the `model` based on the `scheam`\n\t\t\t\t\t *\n\t\t\t\t\t * @param {string} model\n\t\t\t\t\t * @param {object} schema\n\t\t\t\t\t * @returns {function()} Returns a deregistration function for this listener\n\t\t\t\t\t */\n\t\t\t\t\tthis.registerCalculation = function(model, schema) {\n\t\t\t\t\t\t// Create new Computed property\n\t\t\t\t\t\tvar property = calculator.createProperty(schema),\n\t\t\t\t\t\t\t// getter for the form model\n\t\t\t\t\t\t\tformModelGetter = $parse($attrs.xpsuiModel),\n\t\t\t\t\t\t\t// getter for the current model\n\t\t\t\t\t\t\tmodelGetter = $parse(model);\n\n\t\t\t\t\t\t// Get form model\n\t\t\t\t\t\tvar formModel = formModelGetter($scope);\n\n\t\t\t\t\t\tfunction calculate() {\n\t\t\t\t\t\t\t// Get model value\n\t\t\t\t\t\t\tvar modelValue = modelGetter($scope);\n\t\t\t\t\t\t\t// Check 'onlyEmpty' flag - run calculation only if the this flag is not set or\n\t\t\t\t\t\t\t// current model value is empty\n\t\t\t\t\t\t\t// NOTE: Do not use !model because \"false\" can be allowed value\n\t\t\t\t\t\t\tif (!schema.onlyEmpty || modelValue === undefined || modelValue === \"\") {\n\t\t\t\t\t\t\t\t// Run first calculation\n\t\t\t\t\t\t\t\tproperty.getter(formModel).then(function (result) {\n\t\t\t\t\t\t\t\t\tmodelGetter.assign($scope, result);\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tcalculate();\n\n\t\t\t\t\t\t// Register property watcher\n\t\t\t\t\t\treturn $scope.$watch(property.watcher(formModel), function(newValue, oldValue) {\n\t\t\t\t\t\t\tif (newValue != oldValue) {\n\t\t\t\t\t\t\t\tcalculate();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}, true); // NOTE: Always use TRUE for computedProperty.watcher\n\t\t\t\t\t};\n\t\t\t\t}],\n\t\t\t\tlink: function(scope, elm, attrs, ctrls) {\n\t\t\t\t\tlog.group('xpsuiForm Link');\n\t\t\t\t\tlog.time('xpsuiForm Link');\n\n\t\t\t\t\tvar formCtrl = ctrls;\n\n\t\t\t\t\tformCtrl.xpsui = formCtrl.xpsui || {\n\t\t\t\t\t\tsubmitPrepare: false,\n\t\t\t\t\t\tprepareForSubmit: function() {\n\t\t\t\t\t\t\tformCtrl.xpsui.submitPrepare = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t};\n\n\t\t\t\t\telm.addClass('x-form');\n\n\t\t\t\t\tif (attrs.xpsuiModel && attrs.xpsuiSchema) {\n\t\t\t\t\t} else {\n\t\t\t\t\t\tlog.warn('Attributes xpsui-model and xpsui-schema have to be set, skipping form generation');\n\t\t\t\t\t\tlog.timeEnd('xpsuiForm Link');\n\t\t\t\t\t\tlog.groupEnd();\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tscope.$watchCollection( attrs.xpsuiSchema, function() {\n\t\t\t\t\t\tlog.info('xpsuiForm generate');\n\t\t\t\t\t\tvar schema = scope.$eval(attrs.xpsuiSchema);\n\t\t\t\t\t\tvar mode = attrs.xpsuiForm;\n\n\n\t\t\t\t\t\t// ACTIONS\n\t\t\t\t\t\tif ( \"viewedit\"===mode && schema.clientActions ) {\n\t\t\t\t\t\t\tvar contentActionsHolder = angular.element('<div class=\"content-actions pull-right\"></div>');\n\t\t\t\t\t\t\telm.append(contentActionsHolder);\n\n\t\t\t\t\t\t\tfor (var actionIndex in schema.clientActions) {\n\t\t\t\t\t\t\t\tvar action = schema.clientActions[actionIndex];\n\n\t\t\t\t\t\t\t\tvar actionElm;\n\t\t\t\t\t\t\t\tconsole.log('xxxxxxx'+action.__DIRECTIVE__);\n\t\t\t\t\t\t\t\tswitch (action.__DIRECTIVE__){\n\t\t\t\t\t\t\t\t\tcase 'action-link':\n\t\t\t\t\t\t\t\t\t\tactionElm = angular.element('<a xpsui-form-action-link psui-options=\"schemaFormOptions.schema.clientActions['+actionIndex+']\" psui-model=\"'+attrs.xpsuiModel+'\" class=\"btn-primary\"></a>');\n\t\t\t\t\t\t\t\t\t\t$compile(actionElm)(scope);\n\t\t\t\t\t\t\t\t\t\tcontentActionsHolder.append(actionElm);\n\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t\tcase 'generate-action-link':\n\t\t\t\t\t\t\t\t\t\tactionElm = angular.element('<a xpsui-form-generate-action-link psui-options=\"schemaFormOptions.schema.clientActions['+actionIndex+']\" psui-model=\"'+attrs.xpsuiModel+'\" class=\"btn-primary\"></a>');\n\t\t\t\t\t\t\t\t\t\t$compile(actionElm)(scope);\n\t\t\t\t\t\t\t\t\t\tcontentActionsHolder.append(actionElm);\n\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\t\t\tconsole.error('Unknown directive value',action.__DIRECTIVE__);\n\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif(schema.properties){\n\t\t\t\t\t\t\telm.append('<div class=\"x-form-title\">'\n\t\t\t\t\t\t\t\t+ (schema.transCode ? $translate.instant(schema.transCode) : schema.title)\n\t\t\t\t\t\t\t\t+ '</div>'\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\tformGenerator.generateForm(scope, elm, schema, attrs.xpsuiSchema, attrs.xpsuiModel, mode || formGenerator.MODE.VIEW);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tlog.info('xpsuiForm schema does not exist');\n\t\t\t\t\t\t}\n\n\n\t\t\t\t\t});\n\n\t\t\t\t\tlog.timeEnd('xpsuiForm Link');\n\t\t\t\t\tlog.groupEnd();\n\t\t\t\t}\n\t\t\t};\n\t\t}\n\t]);\n\n\n}(window.angular));\n","(function(angular) {\r\n\t'use strict';\r\n\r\n\tangular.module('xpsui:directives')\r\n\t.directive('xpsuiFormGenerateActionLink', ['xpsui:SchemaUtil',\r\n\t\t\tfunction(schemaUtilFactory) {\r\n\t\treturn {\r\n\t\t\trestrict: 'A',\r\n\t\t\tlink: function(scope, elm, attrs, ctrls) {\r\n\t\t\t\tvar options = scope.$eval(attrs.psuiOptions);\r\n\t\t\t\tvar modelPath = scope.$eval(attrs.psuiModel);\r\n\r\n\t\t\t\telm.append('<span>'+(options.title)+'</span>');\r\n\r\n\t\t\t\tscope.$watch(attrs.psuiModel+'.id', function(nv, ov) {\r\n\t\t\t\t\tif (nv) {\r\n\t\t\t\t\t\tattrs.$set('href', '/#/registry/generated/' + schemaUtilFactory.encodeUri(options.schemaFrom)+ '/' +nv+ '/' +options.generateBy+'/'+options.template);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\r\n\t\t\t}\r\n\t\t};\r\n\t}]);\r\n\r\n}(window.angular));\r\n","(function(angular) {\n\t'use strict';\n\n\tangular.module('xpsui:services')\n\t.factory('xpsui:GenericSearchFactory', [ '$http', 'xpsui:SchemaUtil', '$translate', function($http, schemaUtilFactory, $translate) {\n\t\tvar service = {};\n\n\t\tservice.getSearch = function(searchSchema, crits,sortBy,skip,limit) {\n\n\t\t\treturn $http({\n\t\t\t\tmethod : 'POST',\n\t\t\t\turl : '/search/' + schemaUtilFactory.encodeUri(schemaUtilFactory.concatUri(searchSchema,'search')),\n\t\t\t\tdata : {\n\t\t\t\t\tcrits : crits,\n\t\t\t\t\tsorts: sortBy,\n\t\t\t\t\tlimit: limit,\n\t\t\t\t\tskip: skip\n\t\t\t\t}\n\t\t\t});\n\t\t};\n\n\n\t\tservice.getSearchCount = function(searchSchema, crits) {\n\n\t\t\treturn $http({\n\t\t\t\tmethod : 'POST',\n\t\t\t\turl : '/search/count/' + schemaUtilFactory.encodeUri(schemaUtilFactory.concatUri(searchSchema,'search')),\n\t\t\t\tdata : {\n\t\t\t\t\tcrits : crits\n\t\t\t\t}\n\t\t\t});\n\t\t};\n\n\t\tservice.parseSearchDef = function(schema) {\n\n\t\t\tvar retval = {};\n\n\t\t\tfunction collectProperties(pathPrefix, objectDef,group,resultArr) {\n\t\t\t\tfor ( var pr in objectDef.properties) {\n\n\t\t\t\t\t\tif (objectDef.properties[pr].objectLink2) {\n\t\t\t\t\t\t\tresultArr.push({\n\t\t\t\t\t\t\t\tpath: pathPrefix + pr+'.oid',\n\t\t\t\t\t\t\t\ttype: objectDef.properties[pr].type,\n\t\t\t\t\t\t\t\trender:{objectLink2:objectDef.properties[pr].objectLink2},\n\t\t\t\t\t\t\t\tschemaFragment:objectDef.properties[pr],\n\t\t\t\t\t\t\t\tgroup:group,\n\t\t\t\t\t\t\t\ttitle: (objectDef.properties[pr].transCode ? $translate.instant(objectDef.properties[pr].transCode) : objectDef.properties[pr].title)\n\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\n\t\t\t\t\t//FIXME: change to datetype\n\t\t\t\t\tif ('render' in objectDef.properties[pr] && objectDef.properties[pr].render.component==='psui-datepicker' ) {\n\t\t\t\t\t\t\tresultArr.push({\n\t\t\t\t\t\t\t\tpath: pathPrefix + pr,\n\t\t\t\t\t\t\t\ttype: objectDef.properties[pr].type,\n\t\t\t\t\t\t\t\trender:{datepicker:true},\n\t\t\t\t\t\t\t\tschemaFragment:objectDef.properties[pr],\n\t\t\t\t\t\t\t\tgroup:group,\n\t\t\t\t\t\t\t\ttitle: (objectDef.properties[pr].transCode ? $translate.instant(objectDef.properties[pr].transCode) : objectDef.properties[pr].title)\n\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\n\n\t\t\t\t\tif (objectDef.properties[pr].type === 'object') {\n\n\n\n\t\t\t\t\t\tcollectProperties(pr + '.', objectDef.properties[pr],objectDef.properties[pr].transCode ? $translate.instant(objectDef.properties[pr].transCode) :objectDef.properties[pr].title, resultArr);\n\n\n\n\t\t\t\t\t} else {\n\t\t\t\t\t\tresultArr.push({\n\t\t\t\t\t\t\tpath: pathPrefix + pr,\n\t\t\t\t\t\t\ttype: objectDef.properties[pr].type,\n\t\t\t\t\t\t\tgroup:group,\n\t\t\t\t\t\t\ttitle: objectDef.properties[pr].transCode ? $translate.instant(objectDef.properties[pr].transCode) : objectDef.properties[pr].title\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t}\n\n\n\t\t\tretval.schema = schema.url;\n\t\t\tretval.attributes = [];\n\t\t\tretval.operators = [ {\n\t\t\t\ttitle: '=',\n\t\t\t\tvalue: 'eq'\n\t\t\t}, {\n\t\t\t\ttitle: '>',\n\t\t\t\tvalue: 'gt'\n\t\t\t},\n\t\t\t{\n\t\t\t\ttitle: '>=',\n\t\t\t\tvalue: 'gte'\n\t\t\t},  {\n\t\t\t\ttitle: '<',\n\t\t\t\tvalue: 'lt'\n\t\t\t},\n\t\t\t {\n\t\t\t\ttitle: '<=',\n\t\t\t\tvalue: 'lte'\n\t\t\t},  {\n\t\t\t\ttitle: 'je iné ako',\n\t\t\t\tvalue: 'neq'\n\t\t\t}, {\n\t\t\t\ttitle: 'začína s',\n\t\t\t\tvalue: 'starts'\n\t\t\t},{\n\t\t\t\ttitle: 'obsahuje',\n\t\t\t\tvalue: 'contains'\n\t\t\t},\n\t\t\t {\n\t\t\t\ttitle: 'má vyplnené',\n\t\t\t\tvalue: 'ex'\n\t\t\t} ];\n\n\t\t\tcollectProperties('', schema,null, retval.attributes);\n\n\t\t\treturn retval;\n\n\t\t};\n\n\t\treturn service;\n\t} ]);\n\n}(window.angular));\n","(function(angular) {\r\n\t'use strict';\r\n\r\n\tangular.module('xpsui:directives')\r\n\t.directive('xpsuiImageresizor', ['$compile', '$translate', function ($compile, $translate) {\r\n\t\treturn {\r\n\t\t\trestrict: 'A',\r\n\t\t\trequire: ['?xpsuiUploadableImage'],\r\n\t\t\tlink: function(scope, elm, attrs, ctrls) {\r\n\t\t\t\tvar wrapper = elm;\r\n\t\t\t\t\r\n\t\t\t\t// // create base html elements\r\n\t\t\t\t// if (elm.parent().hasClass('psui-wrapper')) {\r\n\t\t\t\t// \t// element is wrapped, we are going to use this wrapper\r\n\t\t\t\t// \twrapper = elm.parent();\r\n\t\t\t\t// } else {\r\n\t\t\t\t// \t// there is no wrapper, we have to create one\r\n\t\t\t\t// \twrapper = angular.element('<div class=\"psui-wrapper\"></div>');\r\n\t\t\t\t// \telm.wrap(wrapper);\r\n\t\t\t\t// }\r\n\t\t\t\t\r\n\t\t\t\telm.addClass('xpsui-imageresizor');\r\n\t\t\t\t\r\n\t\t\t\tvar imgCtrl = ctrls[0];\r\n\r\n\t\t\t\tvar resultImgWidth = attrs.psuiWidth || 0;\r\n\t\t\t\tvar resultImgHeight = attrs.psuiHeight || 0;\r\n\r\n\t\t\t\tvar imgWidth = attrs.psuiWidth || 0;\r\n\t\t\t\tvar imgHeight = attrs.psuiHeight || 0;\r\n\t\t\t\tvar resize = 1;\r\n\t\t\t\tvar width = imgWidth*2;\r\n\t\t\t\tvar height = imgHeight*2;\r\n\t\t\t\tvar state = 0;\r\n\t\t\t\tvar pomer;\r\n\t\t\t\tvar x,y;\r\n\t\t\t\tvar tmp;\r\n\t\t\t\tvar difX = 0;\r\n\t\t\t\tvar difY = 0;\r\n\t\t\t\tvar originImgWidth;\r\n\t\t\t\tvar originImgHeight;\r\n\r\n\t\t\t\tif (window.innerWidth < width) {\r\n\t\t\t\t\tvar resizeRatio = (window.innerWidth/width);\r\n\t\t\t\t\theight = Math.round(height * resizeRatio);\r\n\t\t\t\t\twidth = window.innerWidth;\r\n\t\t\t\t\timgWidth = (attrs.psuiWidth || 0) * resizeRatio;\r\n\t\t\t\t\timgHeight = (attrs.psuiHeight || 0) * resizeRatio;\r\n\t\t\t\t}\r\n\t\t\t\tconsole.log('Imageresizor width: ' + width + ' height: ' + height);\r\n\r\n\t\t\t\tvar modalEl = angular.element('<div class=\"xpsui-imageresizor-resizor\" ></div>');\r\n\t\t\t\tmodalEl.addClass('x-modalview');\r\n\t\t\t\twrapper.append(modalEl);\r\n\t\t\t\t\r\n\t\t\t\tvar modalContentWrapperEl =  angular.element('<div></div>');\r\n\t\t\t\tmodalContentWrapperEl.addClass('x-modalview-window');\r\n\t\t\t\tmodalEl.append(modalContentWrapperEl);\r\n\t\t\t\tvar modalWidth = width + 40;\r\n\t\t\t\tif (window.innerWidth < modalWidth) {\r\n\t\t\t\t\tmodalWidth = width;\r\n\t\t\t\t\theight = height * ((width - 40) / width);\r\n\t\t\t\t\twidth = width - 40;\r\n\t\t\t\t}\r\n\t\t\t\tmodalContentWrapperEl.css('width', '' + modalWidth + 'px');\r\n\r\n\t\t\t\t\r\n\t\t\t\tvar labelTranslated = '';\r\n\t\t\t\tif (attrs.xpsuiSchema) {\r\n\t\t\t\t\t$translate.instant(scope.$eval(attrs.xpsuiSchema.concat('.transCode')));\r\n\t\t\t\t}\r\n\t\t\t\tvar modalHeader = $compile(angular.element('<div class=\"x-modalview-header\"><span>' + labelTranslated + '</span></div>'))(scope);\r\n\t\t\t\tmodalContentWrapperEl.append(modalHeader);\r\n\t\t\t\t\r\n\t\t\t\tvar modalContentEl =  angular.element('<div></div>');\r\n\t\t\t\tmodalContentEl.addClass('x-modalview-body');\r\n\t\t\t\tmodalContentWrapperEl.append(modalContentEl);\r\n\r\n\t\t\t\tvar canvasContainer = angular.element('<div class=\"xpsui-uploadable-canvas-container\"></div>')\r\n\t\t\t\tvar resizorCanvas = angular.element('<canvas ></canvas>');\r\n\t\t\t\tresizorCanvas.attr('width', width);\r\n\t\t\t\tresizorCanvas.attr('height', height);\r\n\t\t\t\tcanvasContainer.append(resizorCanvas);\r\n\t\t\t\tmodalContentEl.append(canvasContainer);\r\n\t\t\t\t\r\n\t\t\t\tvar canvasResult = angular.element('<canvas class=\"xpsui-imageresizor-result\" width=\"' + resultImgWidth + '\" height=\"' + resultImgHeight + '\"></canvas>');\r\n\t\t\t\tcanvasResult.addClass('x-hidden');\r\n\t\t\t\twrapper.append(canvasResult);\r\n\t\t\t\t\r\n\t\t\t\tvar buttonsHolder = angular.element('<div class=\"xpsui-buttons-holder\"></div>');\r\n\t\t\t\tmodalContentEl.append(buttonsHolder);\r\n\r\n\t\t\t\tvar buttonRotate = $compile(angular.element('<button type=\"button\" class=\"btn btn-edit xpsui-icon-rotate\"><icon class=\"icon-rotate\"></icon> <span>{{\\'psui.imageresizor.rotate\\' | translate}}</span></button>'))(scope);\r\n\t\t\t\tbuttonsHolder.append(buttonRotate);\r\n\t\t\t\t\r\n\t\t\t\tvar buttonOk = $compile(angular.element('<button type=\"button\" class=\"btn btn-edit xpsui-icon-ok\"><icon class=\"icon-check\"></icon> <span>{{\\'psui.imageresizor.ok\\' | translate}}</span></button>'))(scope);\r\n\t\t\t\tbuttonsHolder.append(buttonOk);\r\n\t\t\t\t\r\n\t\t\t\tvar buttonClose = angular.element('<div class=\"x-modalview-close\"></div>');\r\n\t\t\t\tmodalHeader.append(buttonClose);\r\n\r\n\t\t\t\tvar numberOfRot = 0;\r\n\t\t\t\t\r\n\t\t\t\tbuttonRotate.on('click', function(evt){\r\n\t\t\t\t\tnumberOfRot = numberOfRot + 1;\r\n\t\t\t\t\tnumberOfRot = numberOfRot % 4;\r\n\t\t\t\t\ttmp = originImgHeight;\r\n\t\t\t\t\toriginImgHeight = originImgWidth;\r\n\t\t\t\t\toriginImgWidth = tmp;\r\n\t\t\t\t\tdifX = 0;\r\n\t\t\t\t\tdifY = 0;\r\n\t\t\t\t\tresize = 1;\r\n\t\t\t\t\t\r\n\t\t\t\t\tdraw(context,context2);\r\n\t\t\t\t\tevt.stopPropagation();\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t})\r\n\t\t\t\t\r\n\t\t\t\tvar context = resizorCanvas[0].getContext(\"2d\");\r\n\t\t\t\tvar context2 = canvasResult[0].getContext(\"2d\");\r\n\t\t\t\t// this moves 0,0 coordinates into center of canvas\r\n\t\t\t\tcontext.translate(width/2,height/2);\r\n\t\t\t\t\r\n\t\t\t\tvar img = new Image();\r\n\r\n\t\t\t\tvar draw=function(ctx,ctx2){\r\n\t\t\t\t\tctx.fillStyle = 'rgba(0,0,0,1)';\r\n\t\t\t\t\tctx.fillRect(-width/2,-height/2,width,height);\r\n\t\t\t\t\tctx.rotate((Math.PI /2)* numberOfRot);\r\n\t\t\t\t\t\r\n\t\t\t\t\tif((originImgHeight / originImgWidth) > (height / width)){\r\n\t\t\t\t\t\tpomer = height / originImgHeight;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tpomer = width / originImgWidth;\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\t\r\n\t\t\t\t\tif (originImgHeight * pomer * resize <= imgHeight || originImgWidth * pomer * resize <= imgWidth){\r\n\t\t\t\t\t\tif((originImgHeight / originImgWidth) > (height / width)){\r\n\t\t\t\t\t\t\tresize = imgWidth / (originImgWidth * pomer);\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tresize = imgHeight / (originImgHeight * pomer);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t\tif (numberOfRot % 2 === 1){\r\n\t\t\t\t\t\ttmp = difX;\r\n\t\t\t\t\t\tdifX = difY;\r\n\t\t\t\t\t\tdifY = tmp;\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t\tif (difX > (originImgWidth * resize * pomer - imgWidth)/2){\r\n\t\t\t\t\t\tdifX = (originImgWidth * resize * pomer - imgWidth)/2;\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\t\r\n\t\t\t\t\tif (-difX > (originImgWidth * resize * pomer - imgWidth)/2){\r\n\t\t\t\t\t\tdifX = -(originImgWidth * resize * pomer - imgWidth)/2;\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\t\r\n\t\t\t\t\tif (difY > (originImgHeight * resize * pomer - imgHeight)/2){\r\n\t\t\t\t\t\tdifY = (originImgHeight * resize * pomer - imgHeight)/2;\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t\tif (-difY > (originImgHeight * resize * pomer - imgHeight)/2){\r\n\t\t\t\t\t\tdifY = -(originImgHeight * resize * pomer - imgHeight)/2;\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t\tif (numberOfRot % 2 === 1){\r\n\t\t\t\t\t\ttmp = difX;\r\n\t\t\t\t\t\tdifX = difY;\r\n\t\t\t\t\t\tdifY = tmp;\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t\tctx.drawImage(img,\r\n\t\t\t\t\t\t-(img.width * resize * pomer)/2 + difX,\r\n\t\t\t\t\t\t-(img.height * resize * pomer)/2 + difY,\r\n\t\t\t\t\t\timg.width * pomer * resize,\r\n\t\t\t\t\t\timg.height * pomer * resize\r\n\t\t\t\t\t);\r\n\t\t\t\t\t\r\n\t\t\t\t\tctx.rotate(-(Math.PI/2)* numberOfRot);\r\n\t\t\t\t\tctx2.drawImage(resizorCanvas[0],(width - imgWidth)/2,(height - imgHeight)/2,imgWidth,imgHeight,0,0,resultImgWidth,resultImgHeight);\r\n\t\t\t\t\tctx.fillStyle = 'rgba(1,1,1,0.7)';\r\n\t\t\t\t\t// left bar\r\n\t\t\t\t\tctx.fillRect(- width/2,- height/2,(width - imgWidth)/2,height);\r\n\t\t\t\t\t// top bar\r\n\t\t\t\t\tctx.fillRect(- width/2 + (width - imgWidth)/2,- height/2,imgWidth,(height - imgHeight)/2);\r\n\t\t\t\t\t// right bar\r\n\t\t\t\t\tctx.fillRect(imgWidth/2,-height/2,(width-imgWidth)/2,height);\r\n\t\t\t\t\t// bottom bar\r\n\t\t\t\t\tctx.fillRect(- width/2 + (width - imgWidth)/2, imgHeight/2,imgWidth,(height - imgHeight)/2);\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\t\r\n\t\t\t\timg.onload =  function() {\r\n\t\t\t\t\tconsole.log('loaded');\r\n\t\t\t\t\toriginImgWidth = img.width;\r\n\t\t\t\t\toriginImgHeight = img.height;\r\n\t\t\t\t\tcanvasResult.removeClass('x-hidden');\r\n\t\t\t\t\tdocument.querySelector('body').classList.add('x-dropdown-open');\r\n\t\t\t\t\tmodalEl.addClass('x-open');\r\n\t\t\t\t\tdraw(context,context2);\r\n\t\t\t\t};\r\n\r\n\t\t\t\tif (imgCtrl) {\r\n\t\t\t\t\timgCtrl.srcElm = img;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tmodalEl.on('click', function(evt) {\r\n\t\t\t\t\tevt.stopPropagation();\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t});\r\n\r\n\t\t\t\tbuttonOk.on('click', function(evt) {\r\n\t\t\t\t\tif (canvasResult[0].toBlob) {\r\n\t\t\t\t\t\tcanvasResult[0].toBlob(imgCtrl.imageProcessed, 'image/jpeg');\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\t// dirty workarround for chrome\r\n\t\t\t\t\t\t//take apart data URL\r\n\t\t\t\t\t\tvar parts = canvasResult[0].toDataURL().match(/data:([^;]*)(;base64)?,([0-9A-Za-z+/]+)/);\r\n\r\n\t\t\t\t\t\t//assume base64 encoding\r\n\t\t\t\t\t\tvar binStr = atob(parts[3]);\r\n\r\n\t\t\t\t\t\t//convert to binary in ArrayBuffer\r\n\t\t\t\t\t\tvar buf = new ArrayBuffer(binStr.length);\r\n\t\t\t\t\t\tvar view = new Uint8Array(buf);\r\n\t\t\t\t\t\tfor(var i = 0; i < view.length; i++)\r\n\t\t\t\t\t\t  view[i] = binStr.charCodeAt(i);\r\n\r\n\t\t\t\t\t\tvar blob = new Blob([view], {'type': parts[1]});\r\n\t\t\t\t\t\timgCtrl.imageProcessed(blob);\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tcanvasResult.addClass('x-hidden');\r\n\t\t\t\t\tdocument.querySelector('body').classList.remove('x-dropdown-open');\r\n\t\t\t\t\tmodalEl.removeClass('x-open');\r\n\t\t\t\t\tevt.stopPropagation();\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t});\r\n\t\t\t\t\t\r\n\t\t\t\tbuttonClose.on('click', function(evt) {\r\n\t\t\t\t\tcanvasResult.addClass('x-hidden');\r\n\t\t\t\t\tdocument.querySelector('body').classList.remove('x-dropdown-open');\r\n\t\t\t\t\tmodalEl.removeClass('x-open');\r\n\t\t\t\t\tevt.stopPropagation();\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t});\r\n\r\n\t\t\t\tresizorCanvas.on('mousewheel', function(evt){\r\n\t\t\t\t\tevt.preventDefault();\r\n\t\t\t\t\tif (evt.wheelDelta > 0){\r\n\t\t\t\t\t\tresize = resize + 0.1;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tresize = resize - 0.1;\t\r\n\t\t\t\t\t}\r\n\t\t\t\t\tdraw(context,context2);\r\n\t\t\t\t})\r\n\t\t\t\t\r\n\t\t\t\tresizorCanvas.on('DOMMouseScroll', function(evt){\r\n\t\t\t\t\tevt.preventDefault();\r\n\t\t\t\t\tif (evt.detail < 0){\r\n\t\t\t\t\t\tresize = resize + 0.1;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tresize = resize - 0.1;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tdraw(context,context2);\r\n\t\t\t\t\t\r\n\t\t\t\t})\r\n\t\t\t\t\r\n\t\t\t\tfunction moveImg(clientX, clientY){\r\n\t\t\t\t\tif (state == 1){\r\n\t\t\t\t\t\tif (numberOfRot == 0){\r\n\t\t\t\t\t\t\tdifX = difX + clientX - x;\r\n\t\t\t\t\t\t\tdifY = difY + clientY - y;\r\n\t\t\t\t\t\t} else if (numberOfRot == 1){\r\n\t\t\t\t\t\t\tdifX = difX + clientY - y;\r\n\t\t\t\t\t\t\tdifY = difY - clientX + x;\r\n\t\t\t\t\t\t} else if (numberOfRot == 2){\r\n\t\t\t\t\t\t\tdifX = difX - clientX + x;\r\n\t\t\t\t\t\t\tdifY = difY - clientY + y;\r\n\t\t\t\t\t\t} else if (numberOfRot == 3){\r\n\t\t\t\t\t\t\tdifX = difX - clientY + y;\r\n\t\t\t\t\t\t\tdifY = difY + clientX - x;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tdraw(context,context2);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tx = clientX;\r\n\t\t\t\t\ty = clientY;\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tresizorCanvas.on('click',function(evt){\r\n\t\t\t\t\tevt.stopPropagation();\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t})\r\n\r\n\t\t\t\tresizorCanvas.on('mousedown',function(evt){\r\n\t\t\t\t\tstate = 1;\r\n\t\t\t\t\tevt.stopPropagation();\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t})\r\n\t\t\t\t\r\n\t\t\t\tresizorCanvas.on('mouseup mouseleave',function(evt){\r\n\t\t\t\t\tstate = 0;\r\n\t\t\t\t\tevt.stopPropagation();\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t})\r\n\t\t\t\t\r\n\t\t\t\tresizorCanvas.on('mousemove',function(evt){\r\n\t\t\t\t\tmoveImg(evt.clientX, evt.clientY);\r\n\t\t\t\t\tevt.stopPropagation();\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t})\r\n\t\t\t\t\r\n\t\t\t\r\n\t\t\t\tvar zoomTouch = [];\r\n\t\t\t\t\r\n\t\t\t\tresizorCanvas.on('touchstart',function(evt){\r\n\t\t\t\t\tstate = 1;\r\n\t\t\t\t\t\r\n\t\t\t\t\tif (evt.targetTouches.length === 1) {\r\n\t\t\t\t\t\tx = evt.targetTouches[0].clientX;\r\n\t\t\t\t\t\ty = evt.targetTouches[0].clientY;\r\n\t\t\t\t\t} else if(evt.targetTouches.length === 2){\r\n\t\t\t\t\t\tzoomTouch = [\r\n\t\t\t\t\t\t\tgetVector(evt.targetTouches[0]),\r\n\t\t\t\t\t\t\tgetVector(evt.targetTouches[1])\r\n\t\t\t\t\t\t];\r\n\t\t\t\t\t}\r\n\t\t\t\t\tevt.preventDefault();\r\n\t\t\t\t})\r\n\t\t\t\t\r\n\t\t\t\tresizorCanvas.on('touchend',function(evt){\r\n\t\t\t\t\tstate = 0;\r\n\t\t\t\t\tevt.preventDefault();\r\n\t\t\t\t})\r\n\t\t\t\t\r\n\t\t\t\tresizorCanvas.on('touchmove',function(evt){\r\n\t\t\t\t\tif (evt.targetTouches.length === 1) {\r\n\t\t\t\t\t\tmoveImg(\r\n\t\t\t\t\t\t\tevt.targetTouches[0].clientX, \r\n\t\t\t\t\t\t\tevt.targetTouches[0].clientY\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\t} else if(evt.targetTouches.length === 2){\r\n\t\t\t\t\t\tvar currentZoomTouch = [\r\n\t\t\t\t\t\t\t\tgetVector(evt.targetTouches[0]),\r\n\t\t\t\t\t\t\t\tgetVector(evt.targetTouches[1])\r\n\t\t\t\t\t\t\t]\r\n\t\t\t\t\t\t;\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tresize = resize + \r\n\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\tvectorLength(currentZoomTouch[0],currentZoomTouch[1]) -\r\n\t\t\t\t\t\t\t\t\tvectorLength(zoomTouch[0],zoomTouch[1])\r\n\t\t\t\t\t\t\t\t) / 100\r\n\t\t\t\t\t\t;\r\n\t\t\t\t\t\t\r\n\r\n\t\t\t\t\t\tdraw(context,context2);\r\n\t\t\t\t\t\tzoomTouch = currentZoomTouch;\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t\tevt.preventDefault();\r\n\t\t\t\t})\r\n\t\t\t\t\r\n\t\t\t\tfunction getVector(vec){\r\n\t\t\t\t\treturn {\r\n\t\t\t\t\t\tx: vec.clientX,\r\n\t\t\t\t\t\ty: vec.clientY\r\n\t\t\t\t\t};\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tfunction vectorLength(vec1, vec2){\r\n\t\t\t\t\tvar x = Math.abs(vec1.x-vec2.x),\r\n\t\t\t\t\t\ty = Math.abs(vec1.y-vec2.y)\r\n\t\t\t\t\t;\r\n\t\t\t\t\treturn Math.sqrt(\r\n\t\t\t\t\t\tx*x + y*y \r\n\t\t\t\t\t);\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t}\r\n\t\t}\r\n\t}]);\r\n\r\n}(window.angular));","(function(angular) {\n\t'use strict';\n\n\tangular.module('xpsui:directives')\n\t.directive('xpsuiInlineedit', ['xpsui:logging', 'xpsui:FormGenerator', '$compile', '$timeout', '$parse', function(log, formGenerator, $compile, $timeout, $parse) {\n\t\treturn {\n\t\t\trestrict: 'A',\n\t\t\trequire: ['^xpsuiFormControl','xpsuiInlineedit'],\n\n\t\t\tcontroller: function() {\n\t\t\t\tthis.setCommitButton = function(button){\n\t\t\t\t\tthis.comitButton = button;\n\t\t\t\t};\n\t\t\t\t\n\t\t\t\tthis.showCommitButton = function(){\n\t\t\t\t\tthis.comitButton.removeClass('x-hidden');\n\t\t\t\t};\n\n\t\t\t\tthis.hideCommitButton = function(){\n\t\t\t\t\tthis.comitButton.addClass('x-hidden');\n\t\t\t\t};\n\t\t\t\t\n\t\t\t},\n\t\t\tlink: function(scope, elm, attrs, ctrls) {\n\t\t\t\tlog.group('Inlineedit Link');\n\n\t\t\t\tvar formControl = ctrls[0];\n\t\t\t\tvar selfCtrl = ctrls[1];\n\n\t\t\t\tvar modelPath = attrs.xpsuiModel;\n\t\t\t\tvar schemaPath = attrs.xpsuiSchema;\n\t\t\t\tvar oldValue = null;\n\n\t\t\t\telm.addClass('x-inlineedit');\n\n\t\t\t\tif (modelPath && schemaPath) {\n\t\t\t\t} else {\n\t\t\t\t\tlog.warn('Attributes xpsui-model and xpsui-schema have to be set, skipping inlineedit generation');\n\t\t\t\t\tlog.groupEnd();\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tvar schema = scope.$eval(schemaPath);\n\t\t\t\tvar mode = attrs.xpsuiInlineedit || formGenerator.MODE.VIEW;\n\n\t\t\t\tvar viewElm = formGenerator.generateField(schema, schemaPath, modelPath, formGenerator.MODE.VIEW);\n\t\t\t\tvar editElm = formGenerator.generateField(schema, schemaPath, modelPath, formGenerator.MODE.EDIT);\n\t\t\t\tformGenerator.generateValidations(editElm, schema, schemaPath, modelPath, formGenerator.MODE.EDIT);\n\t\t\t\tvar contentElm = angular.element('<div class=\"x-inlineedit-content\"></div>');\n\n\t\t\t\tcontentElm.append(viewElm);\n\t\t\t\tcontentElm.append(editElm);\n\n\t\t\t\telm.append(contentElm);\n\n\t\t\t\t$compile(viewElm)(scope);\n\t\t\t\t$compile(editElm)(scope);\n\n\t\t\t\tvar buttonsElm = angular.element('<div class=\"x-inlineedit-buttons x-hidden\"></div>');\n\t\t\t\tvar commitButton = angular.element('<button class=\"x-component-button x-inlineedit-commit-button\"><i class=\"fa fa-check\"></i><span>Uložiť</span></button>');\n\t\t\t\tvar rollbackButton = angular.element('<button class=\"x-component-button x-inlineedit-rollback-button\"><i class=\"fa fa-remove\"></i><span>Zrušiť</span></button>');\n\t\t\t\tselfCtrl.setCommitButton(commitButton);\n\t\t\t\t\n\t\t\t\tbuttonsElm.append(commitButton).append(rollbackButton);\n\n\t\t\t\telm.append(buttonsElm);\n\n\t\t\t\tfunction enterEditMode() {\n\t\t\t\t\tmode = formGenerator.MODE.EDIT;\n\t\t\t\t\tviewElm.addClass('x-hidden');\n\t\t\t\t\teditElm.removeClass('x-hidden');\n\t\t\t\t\tbuttonsElm.removeClass('x-hidden');\n\t\t\t\t\telm.addClass('x-inlineedit-edit-mode');\n\t\t\t\t\telm.removeClass('x-inlineedit-view-mode');\n\t\t\t\t\teditElm.triggerHandler('focus');\n\n\t\t\t\t\telm.removeClass('x-inlineedit-active');\n\n\t\t\t\t\telm.off('click', viewModeClickHandler);\n\n\t\t\t\t\toldValue = scope.$eval(modelPath);\n\t\t\t\t\t// Create a hard copy\n\t\t\t\t\t// .. otherwise the rollback on cancel button would keep the edited value.\n\t\t\t\t\tif (oldValue && oldValue.constructor == Array) {\n\t\t\t\t\t\tvar copy = [];\n\t\t\t\t\t\tfor (var i=0; i<oldValue.length; i++) {\n\t\t\t\t\t\t\tcopy[i] = oldValue[i];\n\t\t\t\t\t\t}\n\t\t\t\t\t\toldValue = copy;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tvar viewModeClickHandler = function(evt) {\n\t\t\t\t\tif (mode === formGenerator.MODE.VIEW && formControl.acquireFocus(elm)) {\n\t\t\t\t\t\tenterEditMode();\n\t\t\t\t\t}\n\t\t\t\t};\n\n\t\t\t\tfunction enterViewMode() {\n\t\t\t\t\tmode = formGenerator.MODE.VIEW;\n\t\t\t\t\tviewElm.removeClass('x-hidden');\n\t\t\t\t\teditElm.addClass('x-hidden');\n\t\t\t\t\tbuttonsElm.addClass('x-hidden');\n\t\t\t\t\telm.addClass('x-inlineedit-view-mode');\n\t\t\t\t\telm.removeClass('x-inlineedit-edit-mode');\n\t\t\t\t\n\t\t\t\t\telm.on('click', viewModeClickHandler);\n\t\t\t\t}\n\n\t\t\t\tfunction commit() {\n\t\t\t\t\tenterViewMode();\n\t\t\t\t\tscope.$emit('xpsui:model_changed');\n\n\t\t\t\t\tformControl.releaseFocus(elm);\n\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tvar commitClickHandler = function(evt) {\n\t\t\t\t\tevt.stopPropagation();\n\t\t\t\t\tcommit();\n\n\t\t\t\t\treturn false;\n\t\t\t\t};\n\n\t\t\t\tcommitButton.on('click', commitClickHandler);\n\n\t\t\t\tfunction rollback() {\n\t\t\t\t\tenterViewMode();\n\n\t\t\t\t\tscope.$apply(function() {\n\t\t\t\t\t\t$parse(modelPath).assign(scope, oldValue); \n\t\t\t\t\t});\n\n\t\t\t\t\tformControl.releaseFocus(elm);\n\t\t\t\t}\n\n\t\t\t\tvar rollbackClickHandler = function(evt) {\n\t\t\t\t\trollback();\n\t\t\t\t\tevt.stopPropagation();\n\n\t\t\t\t\treturn false;\n\t\t\t\t};\n\n\t\t\t\trollbackButton.on('click', rollbackClickHandler);\n\n\t\t\t\telm.on('mouseover', function(evt) {\n\t\t\t\t\tif (mode !== formGenerator.MODE.EDIT && formControl.acquireFocus(elm)) {\n\t\t\t\t\t\telm.addClass('x-inlineedit-active');\n\t\t\t\t\t\t\n\t\t\t\t\t\telm.one('mouseout', function() {\n\t\t\t\t\t\t\telm.removeClass('x-inlineedit-active');\n\t\t\t\t\t\t\tif (mode !== formGenerator.MODE.EDIT) {\n\t\t\t\t\t\t\t\tformControl.releaseFocus(elm);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\tif (mode === formGenerator.MODE.EDIT) {\n\t\t\t\t\tenterEditMode();\n\t\t\t\t} else {\n\t\t\t\t\tenterViewMode();\n\t\t\t\t}\n\n\t\t\t\telm.on('keypress keydown', function(evt) {\n\t\t\t\t\tif (evt.which === 27) {\n\t\t\t\t\t\t// key escape\n\t\t\t\t\t\trollback();\n\t\t\t\t\t\tevt.preventDefault();\n\t\t\t\t\t} else if (evt.which === 13) {\n\t\t\t\t\t\t// key enter\n\t\t\t\t\t\tcommit();\n\t\t\t\t\t\tevt.preventDefault();\n\t\t\t\t\t} else if (evt.which === 9) {\n\t\t\t\t\t\t// key tab\n\t\t\t\t\t\tcommit();\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\t// hendle tabs\t\n\t\t\t\t\n\t\t\t\tif (mode !== formGenerator.MODE.EDIT) {\n\t\t\t\t\telm.attr('tabindex', '0');\n\t\t\t\t\n\t\t\t\t\telm.on('focus', function(e) {\n\t\t\t\t\t\tif (formControl.acquireFocus(elm)) {\n\t\t\t\t\t\t\tenterEditMode();\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\t\n\t\t\t\t}\t\n\t\t\t\t\n\n\t\t\t\tlog.groupEnd();\n\t\t\t}\n\t\t};\n\t}]);\n\n}(window.angular));\n\n","(function(angular) {\r\n\t'use strict';\r\n\r\n\tangular.module('xpsui:directives')\r\n\t.directive('xpsuiMenuItems', ['xpsui:logging',  function(log) {\t\t\r\n\t\treturn {\r\n\t\t\trestrict: 'A',\r\n\t\t\trequire: ['^xpsuiMenu'],\r\n\t\t\tcontroller: function($scope, $element){\r\n\r\n\t\t\t},\r\n\t\t\tlink: function(scope, elm, attrs, ctrls) {\r\n\r\n\t\t\t\tvar submenu = angular.element(elm[0].querySelectorAll('.x-submenu-toggle'));\r\n\t\t\t\tsubmenu.on('click',function(event){\r\n\t\t\t\t\tvar $this = angular.element(this);\r\n\t\t\t\t\t$this.parent().toggleClass('x-active');\r\n\t\t\t\t\tevent.preventDefault();\r\n\t\t\t\t});\r\n\r\n\t\t\t\tvar links = angular.element(elm[0].querySelectorAll('ul ul a'));\r\n\t\t\t\tlinks.on('click',function(event){\r\n\t\t\t\t\tvar $this = angular.element(this),\r\n\t\t\t\t\t\t$open = $this.parent()\r\n\t\t\t\t\t;\r\n\r\n\t\t\t\t\twhile(!$open.hasClass('x-active')) {\r\n\t\t\t\t\t\t$open = $open.parent();\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t// elm.removeClass('x-open');\r\n\t\t\t\t\tctrls[0].close();\r\n\t\t\t\t\tangular.element(elm[0].querySelectorAll('li.x-active')).removeClass('x-active');\r\n\t\t\t\t\t$open.addClass('x-active');\r\n\t\t\t\t\tangular.element(elm[0].querySelectorAll('a.x-active-link')).removeClass('x-active-link');\r\n\t\t\t\t\t$this.addClass('x-active-link');\r\n\t\t\t\t});\r\n\r\n\t\t\t}\r\n\t\t};\r\n\t}]);\r\n}(window.angular));","(function(angular) {\n\t'use strict';\n\n\tangular.module('xpsui:directives')\n\t.directive('xpsuiMenu', ['xpsui:logging',  function(log) {\t\t\n\t\treturn {\n\t\t\trestrict: 'A',\n\t\t\trequire: ['xpsuiMenu'],\n\t\t\tcontroller: function(){\n\n\t\t\t\tthis.setElement = function(el){\n\t\t\t\t\tthis.el = el;\n\t\t\t\t};\n\n\t\t\t\tthis.close = function(){\n\t\t\t\t\tthis.el.removeClass('x-open');\n\t\t\t\t};\n\n\t\t\t},\n\t\t\tlink: function(scope, elm, attrs, ctrls) {\n\t\t\t\tvar button = angular.element(elm[0].querySelectorAll('.x-main-menu-toggle'));\n\t\t\t\t\n\t\t\t\tctrls[0].setElement(elm);\n\n\t\t\t\tbutton.on('click',function(){\n\t\t\t\t\telm.toggleClass('x-open');\n\t\t\t\t});\n\n\t\t\t\telm.on('click', function(event){\n\t\t\t\t\tif (this === event.target) {\n\t\t\t\t\t\tctrls[0].close();\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t};\n\t}]);\n}(window.angular));","(function(angular) {\n\t'use strict';\n\n\tangular.module('xpsui:directives')\n\t.directive('xpsuiMultistringEdit', ['xpsui:logging', 'xpsui:DropdownFactory', \n\t\t\t\t\t\t\t'xpsui:SelectboxFactory','xpsui:SelectDataFactory', '$timeout',\n\t\t\t\t\t\t\t'$http',\n\t\t\tfunction(log, dropdownFactory, selectboxFactory, datafactory, $timeout, $http) {\n\t\treturn {\n\t\t\trestrict: 'A',\n\t\t\trequire: ['ngModel', 'xpsuiMultistringEdit'],\n\t\t\tcontroller: function($scope, $element, $attrs) {\n\t\t\t\tthis.setup = function() {\n\t\t\t\t\tthis.$input = angular.element('<input></input>');\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tthis.getInput = function() {\n\t\t\t\t\treturn this.$input;\n\t\t\t\t}\n\n\t\t\t\tthis.$input = null;\n\t\t\t\tthis.setup();\n\t\t\t},\n\t\t\tlink: function(scope, elm, attrs, ctrls) {\n\t\t\t\tlog.group('Multistring edit Link');\n\n\t\t\t\tvar ngModel = ctrls[0];\n\t\t\t\tvar selfControl = ctrls[1];\n\n\t\t\t\telm.addClass('x-multistring-edit');\n\n\t\t\t\tvar container = angular.element('<div></div>');\n\t\t\t\t//var input = angular.element('<input></input>');\n\t\t\t\tvar inputWrapper = angular.element('<div class=\"x-select-edit\"></div>');\n\t\t\t\tvar input = selfControl.getInput();\n\t\t\t\tvar addButton = angular.element('<button class=\"btn btn-primary\">Pridať</button>');\n\t\t\t\tinputWrapper.append(input);\n\n\t\t\t\telm.addClass('x-control');\n\t\t\t\telm.addClass('x-multistring-edit');\n\n\t\t\t\tngModel.$render = function() {\n\t\t\t\t\tvar i, xButton, stringElm;\n\n\t\t\t\t\tcontainer.empty();\n\t\t\t\t\tfor (i in ngModel.$modelValue) {\n\t\t\t\t\t\tstringElm = angular.element('<div class=\"portal-multistring-element\"><span>'+ngModel.$modelValue[i]+'</span></div>');\n\t\t\t\t\t\txButton = angular.element('<i class=\"icon-remove\"></i>');\n\t\t\t\t\t\txButton.data('idx', i);\n\n\t\t\t\t\t\txButton.on('click', function(evt) {\n\t\t\t\t\t\t\tscope.$apply(function() {\n\t\t\t\t\t\t\t\tngModel.$modelValue.splice(angular.element(evt.target).data('idx'), 1);\n\t\t\t\t\t\t\t\tngModel.$render();\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t});\n\t\t\t\t\t\tstringElm.append(xButton);\n\t\t\t\t\t\tcontainer.append(stringElm);\n\t\t\t\t\t}\n\t\t\t\t};\n\n\t\t\t\telm.append(container);\n\t\t\t\telm.append(inputWrapper);\n\t\t\t\telm.append(addButton);\n\n\t\t\t\tinput.on('change', function(evt) {\n\t\t\t\t\tscope.$apply(function() {\n\t\t\t\t\t\t// if (input.val() && input.val().trim() != '') {\n\t\t\t\t\t\t// \tngModel.$modelValue.push(input.val());\n\t\t\t\t\t\t// \tngModel.$render();\n\t\t\t\t\t\t// }\n\t\t\t\t\t\t// input.val('');\n\t\t\t\t\t});\n\t\t\t\t});\n\n\t\t\t\taddButton.on('click', function (e) {\n\t\t\t\t\tvar newVal = selfControl.getInput().val();\n\t\t\t\t\tif (newVal && newVal.trim() != '') {\n\t\t\t\t\t\tngModel.$modelValue.push(newVal);\n\t\t\t\t\t\tngModel.$render();\n\t\t\t\t\t\tselfControl.getInput().val('');\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\tinputWrapper.bind('focus', function(evt) {\n\t\t\t\t\tinput[0].focus();\n\t\t\t\t});\n\n\t\t\t\t// dropdown\n\t\t\t\tvar dropdown = dropdownFactory.create(inputWrapper,{\n\t\t\t\t\tshowDropdownAction: false\n\t\t\t\t\t//allowClose: false\n\t\t\t\t});\n\t\t\t\tdropdown.setInput(selfControl.getInput())\n\t\t\t\t\t.render()\n\t\t\t\t;\n\n\t\t\t\t// selectbox\n\t\t\t\tvar selectbox = selectboxFactory.create(inputWrapper, {\n\t\t\t\t\tuseSearchInput: false,\n\t\t\t\t\tfreeTextMode: true,\n\t\t\t\t\tshowInfo: false,\n\t\t\t\t\tonSelected: function(value){\n\t\t\t\t\t\t//ngModel.$modelValue.push(value.v);\n\t\t\t\t\t\tngModel.$render();\n\t\t\t\t\t\tselfControl.getInput().val(value.v);\n\t\t\t\t\t\t//input.val(value.v);\n\t\t\t\t\t\tconsole.log('onSelected');\n\t\t\t\t\t\tconsole.log(arguments);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tselectbox.setInput(selfControl.getInput());\n\t\t\t\tselectbox.setDropdown(dropdown);\n\n\t\t\t\t$http({\n\t\t\t\t\turl: '/portalapi/articleTagsDistinct',\n\t\t\t\t\tmethod: \"GET\",\n\t\t\t\t\theaders: {'Content-Type': 'application/json'}\n\t\t\t\t}).success(function (data, status, headers, config) {\n\t\t\t\t\t// store\n\t\t\t\t\tvar dataset = datafactory.createArrayDataset(\n\t\t\t\t\t\tdata\n\t\t\t\t\t);\n\t\t\t\t\tselectbox.setDataset(dataset);\n\t\t\t\t});\n\n\t\t\t\tinput.on('keypress',function() {\n\t\t\t\t\t$timeout(function() {\n\t\t\t\t\t\tdropdown.open();\n\t\t\t\t\t\tselectbox.actionFilter(input.val());\n\t\t\t\t\t}, 300);\n\t\t\t\t});\n\n\t\t\t\tlog.groupEnd();\n\t\t\t}\n\t\t};\n\t}]);\n\n}(window.angular));\n\n\n","(function(angular) {\r\n\t'use strict';\r\n\r\n\tangular.module('xpsui:directives')\r\n\t.directive('xpsuiNotification', ['$rootScope','$timeout', '$compile'/*, '$transate'*/,\r\n\t\tfunction ($rootScope, $timeout, $compile/*, $translate*/) {\r\n\t\t\treturn {\r\n\t\t\t\trestrict: 'AE',\r\n\t\t\t\tlink: function(scope, elm, attrs, ctrls) {\r\n\t\t\t\t\telm.addClass('x-notification');\r\n\t\t\t\t\t$rootScope.psuiNotification = ( $rootScope.psuiNotification || {} );\r\n\t\t\t\t\t$rootScope.psuiNotification.message = ( $rootScope.psuiNotification.message || [] );\r\n\t\t\t\t\tscope.$watchCollection('psuiNotification.message', function(newNames,oldNames){\r\n\t\t\t\t\t\tfor (var i = 0; i < $rootScope.psuiNotification.message.length; i++ ){\t\t\t\t\t\r\n\t\t\t\t\t\t\tif (!($rootScope.psuiNotification.message[i].element)){\r\n\t\t\t\t\t\t\t\tif($rootScope.psuiNotification.message[i].translationCode){\r\n\t\t\t\t\t\t\t\t//\t$translate($rootScope.psuiNotification.message[i].translationCode).then(function(notif){\r\n\t\t\t\t\t\t\t\t\t$rootScope.psuiNotification.message[i].element = $compile(angular.element('<div class=\"x-notification-'+ $rootScope.psuiNotification.message[i].type +'\">{{\\''+ $rootScope.psuiNotification.message[i].translationCode +'\\' | translate:\\'{data:\"'+ $rootScope.psuiNotification.message[i].translationData +'\"}\\'}}</div>'))(scope);\r\n\t\t\t\t\t\t\t\t//\t});\r\n\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\t$rootScope.psuiNotification.message[i].element = angular.element('<div class=\"x-notification-'+ $rootScope.psuiNotification.message[i].type +'\">'+ $rootScope.psuiNotification.message[i].text +'</div>');\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\telm.append($rootScope.psuiNotification.message[i].element);\r\n\t\t\t\t\t\t\t\tif ($rootScope.psuiNotification.message[i].deletable){\r\n\t\t\t\t\t\t\t\t\tvar buttonDelete = angular.element('<button type=\"button\"></button>');\r\n\t\t\t\t\t\t\t\t\t$rootScope.psuiNotification.message[i].element.append(buttonDelete);\r\n\t\t\t\t\t\t\t\t\t$rootScope.psuiNotification.message[i].button = buttonDelete;\r\n\t\t\t\t\t\t\t\t\tvar searchedMessage = $rootScope.psuiNotification.message[i];\r\n\t\t\t\t\t\t\t\t\tbuttonDelete.on('click',function(evt){\r\n\t\t\t\t\t\t\t\t\t\tfor (var j = 0; j < $rootScope.psuiNotification.message.length; j++ ){\r\n\t\t\t\t\t\t\t\t\t\t\tif ($rootScope.psuiNotification.message[j].button[0] == this) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t$rootScope.psuiNotification.message[j].element.remove();\r\n\t\t\t\t\t\t\t\t\t\t\t\t$rootScope.psuiNotification.message.splice(j,1);\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\tif ($rootScope.psuiNotification.message[i].time > 0){\r\n\t\t\t\t\t\t\t\t\tvar searchedMsg = $rootScope.psuiNotification.message[i];\r\n\t\t\t\t\t\t\t\t\tvar messageHide = function(){\r\n\t\t\t\t\t\t\t\t\t\tfor (var z = 0; z < $rootScope.psuiNotification.message.length; z++ ){\r\n\t\t\t\t\t\t\t\t\t\t\tif ($rootScope.psuiNotification.message[z] == searchedMsg) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t$rootScope.psuiNotification.message[z].element.remove();\r\n\t\t\t\t\t\t\t\t\t\t\t\t$rootScope.psuiNotification.message.splice(z,1);\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t$rootScope.psuiNotification.message[i].timeout = $timeout( messageHide,searchedMsg.time, false);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t})\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t]);\r\n\r\n}(window.angular));\r\n","(function(angular) {\n\t'use strict';\n\n\tangular.module('xpsui:directives')\n\t.directive('xpsuiObjectlink2Edit', [\n\t\t'xpsui:logging',\n\t\t'$parse', \n\t\t'xpsui:DropdownFactory', \n\t\t'xpsui:Objectlink2Factory',\n\t\t'xpsui:SelectDataFactory', \n\t\t'xpsui:SchemaUtil',\n\t\t'xpsui:RemoveButtonFactory',\n\tfunction(log, $parse, dropdownFactory, objectlink2Factory, dataFactory, schemaUtil, removeButtonFactory) {\n\t\treturn {\n\t\t\trestrict: 'A',\n\t\t\trequire: ['ngModel', '?^xpsuiFormControl', 'xpsuiObjectlink2Edit'],\n\t\t\tcontroller: function($scope, $element, $attrs) {\n\t\t\t\tthis.setup = function(){\n\t\t\t\t\tthis.$input = angular.element('<div tabindex=\"0\"></div>');\n\t\t\t\t\tthis.$input.addClass('x-input');\n\t\t\t\t};\n\t\t\t\t\n\t\t\t\tthis.getInput = function(){\n\t\t\t\t\treturn this.$input;\n\t\t\t\t};\n\n\t\t\t\tthis.$input = null;\n\t\t\t\tthis.setup();\n\t\t\t},\n\t\t\tlink: function(scope, elm, attrs, ctrls) {\n\t\t\t\tlog.group('ObjectLink2 edit Link');\n\n\t\t\t\tvar ngModel = ctrls[0],\n\t\t\t\t\tformControl = ctrls[1] || {},\n\t\t\t\t\tselfControl = ctrls[2],\n\t\t\t\t\tinput = selfControl.getInput(),\n\t\t\t\t\tparseSchemaFragment = $parse(attrs.xpsuiSchema),\n\t\t\t\t\tschemaFragment = parseSchemaFragment(scope)\n\t\t\t\t;\n\n\t\t\t\tvar removeButton = removeButtonFactory.create(elm,{\n\t\t\t\t\tenabled: !!!schemaFragment.required,\n\t\t\t\t\tinput: input,\n\t\t\t\t\tonClear: function(){\n\t\t\t\t\t\tinput.empty();\n\t\t\t\t\t\tscope.$apply(function() {\n\t\t\t\t\t\t\tngModel.$modelValue = {};\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\telm.addClass('x-control');\n\t\t\t\telm.addClass('x-select-edit x-objectlink2-edit');\n\n\t\t\t\tngModel.$render = function() {\n\t\t\t\t\tif(!angular.equals({},ngModel.$viewValue)) {\n\t\t\t\t\t\t// get data from schema or model and render it\n\t\t\t\t\t\trender(dataFactory.getObjectLinkData(\n\t\t\t\t\t\t\tschemaFragment.objectLink2, ngModel.$modelValue\n\t\t\t\t\t\t));\n\t\t\t\t\t} else {\n\t\t\t\t\t\tinput.empty();\n\t\t\t\t\t}\n\t\t\t\t};\n\n\t\t\t\tfunction render(data) {\n\t\t\t\t\tinput.empty();\n\n\t\t\t\t\tif (data) {\n\t\t\t\t\t\tremoveButton.show();\n\t\t\t\t\t\t// get fields schema fragments\n\t\t\t\t\t\tschemaUtil.getFieldsSchemaFragment(\n\t\t\t\t\t\t\tschemaFragment.objectLink2.schema, \n\t\t\t\t\t\t\tschemaFragment.objectLink2.fields, \n\t\t\t\t\t\t\tfunction(fields) {\n\t\t\t\t\t\t\t\tobjectlink2Factory.renderElement(\n\t\t\t\t\t\t\t\t\tinput,\n\t\t\t\t\t\t\t\t\tfields,\n\t\t\t\t\t\t\t\t\tdata\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\telm.append(input);\n\n\n\t\t\t\telm.bind('focus', function(evt) {\n\t\t\t\t\tinput[0].focus();\n\t\t\t\t});\n\n\t\t\t\t// dropdown\n\t\t\t\tvar dropdown = dropdownFactory.create(elm, {\n\t\t\t\t\ttitleTransCode: schemaFragment.transCode\n\t\t\t\t});\n\t\t\t\t\n\t\t\t\tdropdown.setInput(selfControl.getInput())\n\t\t\t\t\t.render()\n\t\t\t\t;\n\n\t\t\t\t// selectobx\n\t\t\t\tvar selectbox = objectlink2Factory.create(elm, {\n\t\t\t\t\tonSelected: function(value){\n\t\t\t\t\t\t\n\t\t\t\t\t\tscope.$apply(function() {\n\t\t\t\t\t\t\tngModel.$setViewValue(\n\t\t\t\t\t\t\t\tvalue\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\trender(value);\n\t\t\t\t\t\tconsole.log('onSelected');\n\t\t\t\t\t\tconsole.log(arguments);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tselectbox.setInput(selfControl.getInput());\n\t\t\t\tselectbox.setDropdown(dropdown);\n\n\t\t\t\t// store\n\t\t\t\tvar dataset = dataFactory.createObjectDataset(schemaFragment);\n\t\t\t\tselectbox.setDataset(dataset);\n\n\t\t\t\tlog.groupEnd();\n\t\t\t}\n\t\t};\n\t}]);\n\n}(window.angular));\n\n","(function(angular) {\n\t'use strict';\n\n\tangular.module('xpsui:directives')\n\t.directive('xpsuiObjectlink2View', ['xpsui:logging', 'xpsui:Objectlink2Factory','xpsui:SelectDataFactory', 'xpsui:SchemaUtil','$parse', '$compile', 'xpsuiuriescapeFilter',\n\tfunction(log, objectlink2Factory, dataFactory, schemaUtil, $parse, $compile, xpsuiuriescape) {\n\t\treturn {\n\t\t\trestrict: 'A',\n\t\t\trequire: ['ngModel'],\n\t\t\tlink: function(scope, elm, attrs, ctrls) {\n\t\t\t\tlog.group('String view Link');\n\n\t\t\t\tvar ngModel = ctrls[0],\n\t\t\t\t\tview = angular.element('<div></div>'),\n\t\t\t\t\tparseSchemaFragment = $parse(attrs.xpsuiSchema),\n\t\t\t\t\tschemaFragment = parseSchemaFragment(scope)\n\t\t\t\t;\n\n\t\t\t\telm.addClass('x-control');\n\t\t\t\telm.addClass('x-objectlink2-view');\n\n\t\t\t\telm.append(view);\n\t\t\t\t\n\t\t\t\tngModel.$render = function() {\n\t\t\t\t\tview.empty();\n\n\t\t\t\t\tif (ngModel.$viewValue && \n\t\t\t\t\t\t(ngModel.$viewValue.id || ngModel.$viewValue.oid)\n\t\t\t\t\t) {\n\t\t\t\t\t\tschemaUtil.getFieldsSchemaFragment(\n\t\t\t\t\t\t\tschemaFragment.objectLink2.schema, \n\t\t\t\t\t\t\tschemaFragment.objectLink2.fields, \n\t\t\t\t\t\t\tfunction(fields){\n\t\t\t\t\t\t\t\tvar data = dataFactory.getObjectLinkData(\n\t\t\t\t\t\t\t\t\t\tschemaFragment.objectLink2, ngModel.$viewValue\n\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\tvar schemaUri = schemaFragment.objectLink2.schema;\n\t\t\t\t\t\t\t\tschemaUri = schemaUri.substring(0, schemaUri.length - '/view'.length);\n\t\t\t\t\t\t\t\tview.append('<a href=\"#/registry/view/' + xpsuiuriescape(schemaUri) + '/' + data.oid + '\" ><i class=\"icon-external-link fa-1\"></i></a>&nbsp;&nbsp;');\n\t\t\t\t\t\t\t\tobjectlink2Factory.renderElement(\n\t\t\t\t\t\t\t\t\tview, \n\t\t\t\t\t\t\t\t\tfields, \n\t\t\t\t\t\t\t\t\tdata,\n\t\t\t\t\t\t\t\t\tscope\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t);\n\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t}\n\t\t};\n\t}]);\n\n}(window.angular));\n","(function(angular) {\n\t'use strict';\n\n\tangular.module('xpsui:directives')\n\t.directive('xpsuiPortalArticleContentEdit', ['xpsui:logging', '$compile', function(log, $compile) {\n\t\treturn {\n\t\t\trestrict: 'A',\n\t\t\trequire: ['ngModel'],\n\t\t\tcontroller: ['$scope', '$element', '$attrs', '$parse', '$timeout', function($scope, $element, $attrs, $parse, $timeout) {\n\t\t\t\tthis.moveUp = function(idx) {\n\t\t\t\t\tif (idx > 0) {\n\t\t\t\t\t\tvar parsedModel = $parse($attrs.ngModel);\n\n\t\t\t\t\t\tvar array = parsedModel($scope);\n\n\t\t\t\t\t\tvar tmp = array[idx];\n\t\t\t\t\t\tarray[idx] = array[idx - 1];\n\t\t\t\t\t\tarray[idx - 1] = tmp;\n\n\t\t\t\t\t\tparsedModel.assign($scope, array);\n\n\t\t\t\t\t\t$scope.$broadcast('modechange');\n\t\t\t\t\t}\n\t\t\t\t};\n\n\t\t\t\tthis.moveDown = function(idx) {\n\t\t\t\t\tvar parsedModel = $parse($attrs.ngModel);\n\n\t\t\t\t\tvar array = parsedModel($scope);\n\n\t\t\t\t\tif (idx < array.length-1) {\n\t\t\t\t\t\tvar tmp = array[idx];\n\t\t\t\t\t\t\n\t\t\t\t\t\tarray.splice(idx, 1);\n\t\t\t\t\t\tarray.splice(idx+1, 0, tmp);\n\n\t\t\t\t\t\tparsedModel.assign($scope, array);\n\n\t\t\t\t\t\t$scope.$broadcast('modechange');\n\t\t\t\t\t}\n\t\t\t\t};\n\n\t\t\t\tthis.remove = function(idx) {\n\t\t\t\t\tvar parsedModel = $parse($attrs.ngModel);\n\n\t\t\t\t\tvar array = parsedModel($scope);\n\n\t\t\t\t\tarray.splice(idx, 1);\n\n\t\t\t\t\tparsedModel.assign($scope, array);\n\n\t\t\t\t\t$scope.$broadcast('modechange');\n\t\t\t\t};\n\t\t\t}],\n\t\t\tlink: function(scope, elm, attrs, ctrls) {\n\t\t\t\tlog.group('portal-article-content-edit Link');\n\n\t\t\t\tvar ngModel = ctrls[0];\n\n\t\t\t\tvar content = angular.element('<div></div>');\n\n\t\t\t\tngModel.$render = function() {\n\t\t\t\t\tvar i, block;\n\t\t\t\t\telm.empty();\n\t\t\t\t\t\n\t\t\t\t\tvar content = angular.element('<div></div>');\n\t\t\t\t\tfor (i = 0; i < ngModel.$modelValue.length; ++i) {\n\t\t\t\t\t\tblock = angular.element('<div >x</div>');\n\t\t\t\t\t\tif (scope.mode === 'edit') {\n\t\t\t\t\t\t\tblock.attr('xpsui-portal-widget-' + ngModel.$modelValue[i].meta.type + '-edit', attrs.ngModel+'[' + i + ']');\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tblock.attr('xpsui-portal-widget-' + ngModel.$modelValue[i].meta.type + '-view', attrs.ngModel+'[' + i + ']');\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (ngModel.$modelValue[i].css) {\n\t\t\t\t\t\t\tblock.attr('class', ngModel.$modelValue[i].css.cssClass);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tblock.attr('index', i);\n\n\t\t\t\t\t\tcontent.append(block);\n\t\t\t\t\t\telm.append(content);\n\t\t\t\t\t\t$compile(block)(scope);\n\t\t\t\t\t\t\n\t\t\t\t\t}\n\t\t\t\t};\n\n\t\t\t\tscope.$on('modechange', function() {\n\t\t\t\t\tngModel.$render();\n\t\t\t\t});\n\n\n\t\t\t\tlog.groupEnd();\n\t\t\t}\n\t\t};\n\t}]);\n\n}(window.angular));\n\n\n","(function(angular) {\r\n\t'use strict';\r\n\t\r\n\tangular.module('xpsui:directives')\r\n\t.directive('xpsuiPortalMenuEditor', ['$compile', function($compile) {\r\n\t\treturn {\r\n\t\t\trestrict: 'A',\r\n\t\t\tscope: {\r\n\t\t\t\tindex: '=xpsuiPortalMenuEditor',\r\n\t\t\t\telementIdx: '=portalMenuIndex'\r\n\t\t\t},\r\n\t\t\tcontroller: ['$scope', function($scope) {\r\n\t\t\t\tthis.remove = function(idx) {\r\n\t\t\t\t\tif ($scope.index && $scope.index.subElements) {\r\n\t\t\t\t\t$scope.index.subElements.splice(idx, 1);\r\n\t\t\t\t\t}\r\n\t\t\t\t};\r\n\t\t\t\tthis.removeParent = function(idx) {\r\n\t\t\t\t\t$scope.$parent.removeFn(idx);\r\n\t\t\t\t};\r\n\t\t\t\tthis.upInParent = function(idx) {\r\n\t\t\t\t\tvar curr = $scope.$parent.index.subElements[idx];\r\n\t\t\t\t\tif (idx > 0) {\r\n\t\t\t\t\t$scope.$parent.index.subElements.splice(idx, 1);\r\n\t\t\t\t\t$scope.$parent.index.subElements.splice(idx-1, 0, curr);\r\n\t\t\t\t\t}\r\n\t\t\t\t};\r\n\t\t\t\tthis.downInParent = function(idx) {\r\n\t\t\t\t\tvar curr = $scope.$parent.index.subElements[idx];\r\n\t\t\t\t\tif (idx < $scope.$parent.index.subElements.length-1) {\r\n\t\t\t\t\t$scope.$parent.index.subElements.splice(idx, 1);\r\n\t\t\t\t\t$scope.$parent.index.subElements.splice(idx+1, 0, curr);\r\n\t\t\t\t\t}\r\n\t\t\t\t};\r\n\t\t\t}],\r\n\t\t\trequire: [\"^?xpsuiPortalMenuEditor\"],\r\n\t\t\tlink: function(scope, elm, attrs, ctrls) {\r\n\t\t\t\tscope.mode = 'view';\r\n\t\t\t\tscope.opened = false;\r\n\r\n\t\t\t\telm.addClass('portal-menu-editor');\r\n\r\n\t\t\t\tvar header = angular.element('<div class=\"portal-menu-header\"></div>');\r\n\t\t\t\tvar openIcon = angular.element('<i class=\"icon-minus\" style=\"padding-right:10px;\"></i>');\r\n\t\t\t\tvar children = angular.element('<div style=\"padding-left: 20px;\"><div ng-repeat=\"c in index.subElements\"><div xpsui-portal-menu-editor=\"c\" portal-menu-index=\"$index\"></div></div></div>');\r\n\t\t\t\tvar actionButtons = angular.element('<span style=\"padding-left: 10px;\" class=\"x-hidden\"></span>');\r\n\t\t\t\tvar editButton = angular.element('<i class=\"action-button icon-pencil\"></i>');\r\n\t\t\t\tvar addButton = angular.element('<i class=\"action-button icon-add\"></i>');\r\n\t\t\t\tvar removeButton = angular.element('<i class=\"action-button icon-minus\" ng-click=\"removeParent()\"></i>');\r\n\t\t\t\tvar downButton = angular.element('<i class=\"action-button icon-chevron-down\" ng-click=\"downFn()\"></i>');\r\n\t\t\t\tvar upButton = angular.element('<i class=\"action-button icon-chevron-up\" ng-click=\"upFn()\"></i>');\r\n\r\n\t\t\t\tvar editPanel = angular.element('<table class=\"x-hidden portal-menu-editor-edit-panel\">' +\r\n\t\t\t\t\t'<tr><td>Meno:</td><td><input ng-model=\"index.name\"</td></tr>' +\r\n\t\t\t\t\t'<tr><td>Tagy:</td><td><span xpsui-portal-multistring-edit ng-model=\"index.tags\"></span></td></tr>' +\r\n\t\t\t\t\t'<tr><td>Hash tag (#):</td><td><input ng-model=\"index.hash\"</td></tr>' +\r\n\t\t\t\t\t'</table>');\r\n\r\n\r\n\t\t\t\teditButton.on('click', function(evt) {\r\n\t\t\t\t\teditPanel.toggleClass('x-hidden');\r\n\t\t\t\t\tscope.opened = !scope.opened;\r\n\t\t\t\t\tevt.stopPropagation();\r\n\t\t\t\t});\r\n\r\n\t\t\t\taddButton.on('click', function(evt) {\r\n\t\t\t\t\tscope.$apply(function () {\r\n\t\t\t\t\t\tscope.addNew();\r\n\t\t\t\t\t});\r\n\t\t\t\t\tevt.stopPropagation();\r\n\t\t\t\t});\r\n\r\n\t\t\t\tscope.removeParent = function() {\r\n\t\t\t\t\tif (ctrls[0]) {\r\n\t\t\t\t\t\tctrls[0].removeParent(scope.elementIdx);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tscope.removeFn = function(idx) {\r\n\t\t\t\t\tconsole.log(idx);\r\n\t\t\t\t\tif (ctrls[0]) {\r\n\t\t\t\t\t\tctrls[0].remove(idx);\r\n\t\t\t\t\t}\r\n\t\t\t\t};\r\n\r\n\t\t\t\tscope.upFn = function() {\r\n\t\t\t\t\teditPanel.removeClass('x-hidden');\r\n\t\t\t\t\teditPanel.addClass('x-hidden');\r\n\t\t\t\t\tchildren.removeClass('x-hidden');\r\n\t\t\t\t\tchildren.addClass('x-hidden');\r\n\t\t\t\t\tif (ctrls[0]) {\r\n\t\t\t\t\t\tctrls[0].upInParent(scope.elementIdx);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tscope.downFn = function() {\r\n\t\t\t\t\teditPanel.removeClass('x-hidden');\r\n\t\t\t\t\teditPanel.addClass('x-hidden');\r\n\t\t\t\t\tchildren.removeClass('x-hidden');\r\n\t\t\t\t\tchildren.addClass('x-hidden');\r\n\t\t\t\t\tif (ctrls[0]) {\r\n\t\t\t\t\t\tctrls[0].downInParent(scope.elementIdx);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (ctrls[0]) {\r\n\t\t\t\t\tactionButtons.append(editButton);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tactionButtons.append(addButton);\r\n\t\t\t\tif (ctrls[0]) {\r\n\t\t\t\t\tactionButtons.append(removeButton);\r\n\t\t\t\t\tactionButtons.append(downButton);\r\n\t\t\t\t\tactionButtons.append(upButton);\r\n\t\t\t\t}\r\n\r\n\t\t\t\theader.on('click', function(evt) {\r\n\t\t\t\t\tif (scope.index && scope.index.subElements && scope.index.subElements.length > 0) {\r\n\t\t\t\t\t\topenIcon.toggleClass('icon-add');\r\n\t\t\t\t\t\topenIcon.toggleClass('icon-minus');\r\n\r\n\t\t\t\t\t\tchildren.toggleClass('x-hidden');\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tevt.stopPropagation();\r\n\t\t\t\t});\r\n\r\n\t\t\t\theader.on('mouseover', function() {\r\n\t\t\t\t\tactionButtons.removeClass('x-hidden');\r\n\t\t\t\t});\r\n\t\t\t\theader.on('mouseleave', function() {\r\n\t\t\t\t\tactionButtons.addClass('x-hidden');\r\n\t\t\t\t});\r\n\t\t\t\tvar name = angular.element('<span>{{index.name}}</span>');\r\n\r\n\t\t\t\theader.append(openIcon);\r\n\t\t\t\theader.append(name);\r\n\t\t\t\theader.append(actionButtons);\r\n\r\n\t\t\t\tif (scope.index && scope.index.subElements && scope.index.subElements.length < 1) {\r\n\t\t\t\t\topenIcon.removeClass('icon-minus');\r\n\t\t\t\t\topenIcon.removeClass('icon-add');\r\n\t\t\t\t\topenIcon.addClass('glyphicon-record');\r\n\t\t\t\t}\r\n\r\n\t\t\t\telm.append(header);\r\n\t\t\t\telm.append(editPanel);\r\n\t\t\t\telm.append(children);\r\n\t\t\t\t$compile(editPanel)(scope);\r\n\t\t\t\t$compile(children)(scope);\r\n\t\t\t\t$compile(header)(scope);\r\n\r\n\t\t\t\tscope.addNew = function addNew() {\r\n\t\t\t\t\tscope.index.subElements.push({\r\n\t\t\t\t\t\tname: '...Nový...',\r\n\t\t\t\t\t\ttransCode: null,\r\n\t\t\t\t\t\ttags: [],\r\n\t\t\t\t\t\tsubElements: []\r\n\t\t\t\t\t});\r\n\t\t\t\t\topenIcon.addClass('glyphicon-minus-sign');\r\n\t\t\t\t\topenIcon.removeClass('glyphicon-record');\r\n\t\t\t\t\topenIcon.removeClass('glyphicon-plus-sign');\r\n\t\t\t\t\tchildren.removeClass('x-hidden');\r\n\t\t\t\t};\r\n\r\n\t\t\t}\r\n\t\t};\r\n\t}]);\r\n}(window.angular));","(function(angular) {\r\n\t'use strict';\r\n\t\r\n\tangular.module('xpsui:directives')\r\n\t.directive('xpsuiPortalMenuRender', ['$http', '$route', '$compile', '$location', \r\n\tfunction($http, $route, $compile, $location) {\r\n\t\treturn {\r\n\t\t\trestrict: 'A',\r\n\t\t\tlink: function(scope, elm, attrs, ctrls) {\r\n\t\t\t\tvar loadingDiv = angular.element('<div>Nahrávam...</div>');\r\n\r\n\t\t\t\telm.append(loadingDiv);\r\n\r\n\t\t\t\tvar menuHash = [];\r\n\t\t\t\tvar counter = 0;\r\n\r\n\t\t\t\tfunction renderMenuEntry(data, element) {\r\n\t\t\t\t\tvar menuEntry = angular.element('<div class=\"portal-menu-entry\"><a ng-click=\"navigate('+ (counter++) +');\">'+data.name+'</a></div>');\r\n\r\n\t\t\t\t\tmenuHash.push(data.tags);\r\n\r\n\t\t\t\t\tvar subMenu = angular.element('<div class=\"portal-sub-menu\"></div>');\r\n\t\t\t\t\tfor (var i = 0; i < data.subElements.length; ++i) {\r\n\t\t\t\t\t\tsubMenu.append(angular.element('<div ng-click=\"navigate('+ (counter++) +')\">'+ data.subElements[i].name+'</div>'));\r\n\t\t\t\t\t\tmenuHash.push(data.subElements[i].tags);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tmenuEntry.append(subMenu);\r\n\t\t\t\t\treturn(menuEntry);\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\t$http({\r\n\t\t\t\t\tmethod : 'GET',\r\n\t\t\t\t\turl: '/udao/list/portalMenu',\r\n\t\t\t\t\tdata: {\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t\t.success(function(data, status, headers, config){\r\n\t\t\t\t\telm.empty();\r\n\t\t\t\t\tif (data && data.length > 0 && data[0].index) {\r\n\t\t\t\t\t\tfor (var i = 0; i < data[0].index.subElements.length; ++i) {\r\n\t\t\t\t\t\t\tvar menuEntry = renderMenuEntry(data[0].index.subElements[i]);\r\n\t\t\t\t\t\t\telm.append(menuEntry);\r\n\t\t\t\t\t\t\t$compile(menuEntry)(scope);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}).error(function(err) {\r\n\t\t\t\t\tnotificationFactory.error(err);\r\n\t\t\t\t});\r\n\r\n\t\t\t\tscope.navigate = function(i) {\r\n\t\t\t\t\t$http({\r\n\t\t\t\t\t\tmethod : 'POST',\r\n\t\t\t\t\t\turl: '/portalapi/getByTags',\r\n\t\t\t\t\t\tdata: {\r\n\t\t\t\t\t\t\ttags: menuHash[i]\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t})\r\n\t\t\t\t\t.success(function(data, status, headers, config){\r\n\t\t\t\t\t\tif (data && data.length > 0 && data[0].id) {\r\n\t\t\t\t\t\t\t$location.path('/portal/edit/'+ data[0].id);\r\n\t\t\t\t\t\t\t//$route.updateParams({id: data[0].id});\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}).error(function(err) {\r\n\t\t\t\t\t\tnotificationFactory.error(err);\r\n\t\t\t\t\t});\r\n\t\t\t\t};\r\n\t\t\t}\r\n\t\t};\r\n\t}]);\r\n}(window.angular));","(function(angular) {\r\n\t'use strict';\r\n\t\r\n\tangular.module('xpsui:directives')\r\n\t.directive('portalMultistringEdit',['xpsui:logging','$parse', \r\n\t\t'xpsui:DropdownFactory', 'xpsui:SelectboxFactory','xpsui:SelectDataFactory',\r\n\t\tfunction(log, $parse, dropdownFactory, selectboxFactory, datafactory) {\r\n\t\treturn {\r\n\t\t\trestrict: 'A',\r\n\t\t\trequire: ['ngModel'],\r\n\t\t\tlink: function(scope, elm, attrs, ctrls) {\r\n\t\t\t\tvar ngModel = ctrls[0];\r\n\r\n\t\t\t\telm.addClass('portal-multistring-edit');\r\n\r\n\t\t\t\tvar container = angular.element('<div></div>');\r\n\t\t\t\tvar input = angular.element('<input></input>');\r\n\t\t\t\tvar addButton = angular.element('<button class=\"btn btn-primary\">Pridať</button>');\r\n\r\n\t\t\t\telm.addClass('portal-multistring-edit');\r\n\r\n\t\t\t\tngModel.$render = function() {\r\n\t\t\t\t\tvar i, xButton, stringElm;\r\n\r\n\t\t\t\t\tcontainer.empty();\r\n\t\t\t\t\tfor (i in ngModel.$modelValue) {\r\n\t\t\t\t\t\tstringElm = angular.element('<div class=\"portal-multistring-element\"><span>'+ngModel.$modelValue[i]+'</span></div>');\r\n\t\t\t\t\t\txButton = angular.element('<i class=\"glyphicon-remove\"></i>');\r\n\t\t\t\t\t\txButton.data('idx', i);\r\n\r\n\t\t\t\t\t\txButton.on('click', function(evt) {\r\n\t\t\t\t\t\tscope.$apply(function() {\r\n\t\t\t\t\t\t\tngModel.$modelValue.splice(angular.element(evt.target).data('idx'), 1);\r\n\t\t\t\t\t\t\tngModel.$render();\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tstringElm.append(xButton);\r\n\t\t\t\t\t\tcontainer.append(stringElm);\r\n\t\t\t\t\t}\r\n\t\t\t\t};\r\n\r\n\t\t\t\telm.append(container);\r\n\t\t\t\telm.append(input);\r\n\t\t\t\telm.append(addButton);\r\n\r\n\t\t\t\tinput.on('change', function(evt) {\r\n\t\t\t\t\tscope.$apply(function() {\r\n\t\t\t\t\t\tngModel.$modelValue.push(input.val());\r\n\t\t\t\t\t\tngModel.$render();\r\n\t\t\t\t\t\tinput.val('');\r\n\t\t\t\t\t});\r\n\t\t\t\t});\r\n\r\n\t\t\t\telm.bind('focus', function(evt) {\r\n\t\t\t\t\tinput[0].focus();\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t};\r\n\t}]);\r\n}(window.angular));","(function(angular) {\n\t'use strict';\n\n\tangular.module('xpsui:directives')\n\t.directive('xpsuiPortalWidgetCategoryEdit', ['xpsui:logging', '$compile', function(log, $compile) {\n\t\treturn {\n\t\t\trestrict: 'A',\n\t\t\tscope: {\n\t\t\t\tdata: '=xpsuiPortalWidgetCategoryEdit',\n\t\t\t\tindex: '='\n\t\t\t},\n\t\t\trequire: ['^xpsuiPortalArticleContentEdit'],\n\t\t\tlink: function(scope, elm, attrs, ctrls) {\n\t\t\t\tlog.group('portal-widget-category-edit Link');\n\n\t\t\t\telm.empty();\n\t\t\t\telm.addClass('x-portal-widget-edit');\n\n\t\t\t\tvar titleBar = angular.element('<div class=\"xpsui-portal-widget-title-bar\">{{data.meta.type}}:{{data.meta.name}}<div class=\"pull-right\"><i class=\"action-button icon-chevron-up\" ng-click=\"moveUp();\"></i><i class=\"action-button icon-chevron-down\" ng-click=\"moveDown();\"></i><i class=\"action-button icon-trash\" ng-click=\"remove();\"></i></div></div>');\n\t\t\t\tvar content = angular.element(\n\t\t\t\t\t'<form class=\"form\">'\n\t\t\t\t\t+'<fieldset class=\"form-group\" style=\"background-color: black; padding: 10px;\" ng-show=\"mode !== \\'edit\\'\">'\n\t\t\t\t\t+'<div style=\"background-color: white; padding-top: 10px; padding-bottom: 10px;\">'\n\t\t\t\t\t+'<div class=\"form-group row\">'\n\t\t\t\t\t+' <label class=\"col-sm-2 control-label\">Tagy:</label>'\n\t\t\t\t\t+' <div class=\"col-sm-4\"><div class=\"input-group\"><div xpsui-portal-multistring-edit ng-model=\"data.data.tags\"></div></div></div>'\n\t\t\t\t\t+'</div>'\n\t\t\t\t\t+'<div class=\"form-group row\">'\n\t\t\t\t\t+' <label class=\"col-sm-2 control-label\">Veľkosť stránky:</label>'\n\t\t\t\t\t+' <div class=\"col-sm-4\"><div class=\"input-group\"><input ng-model=\"data.data.pageSize\"/></div></div>'\n\t\t\t\t\t+'</div>'\n\t\t\t\t\t+'</div>'\n\t\t\t\t\t+'</fieldset>'\n\t\t\t\t\t+'</form>');\n\n\n\t\t\t\telm.append(titleBar);\n\t\t\t\telm.append(content);\n\n\t\t\t\t$compile(titleBar)(scope);\n\t\t\t\t$compile(content)(scope);\n\n\t\t\t\tscope.moveUp = function() {\n\t\t\t\t\tctrls[0].moveUp(scope.index);\n\t\t\t\t};\n\n\t\t\t\tscope.moveDown = function() {\n\t\t\t\t\tctrls[0].moveDown(scope.index);\n\t\t\t\t};\n\n\t\t\t\tscope.remove = function() {\n\t\t\t\t\tctrls[0].remove(scope.index);\n\t\t\t\t};\n\n\t\t\t\tlog.groupEnd();\n\t\t\t}\n\t\t};\n\t}]);\n\n}(window.angular));\n\n\n","(function(angular) {\n\t'use strict';\n\n\tangular.module('xpsui:directives')\n\t.directive('xpsuiPortalWidgetCategoryView', ['xpsui:logging', '$compile', '$http', '$sce', '$route', '$location', function(log, $compile, $http, $sce, $route, $location) {\n\t\treturn {\n\t\t\trestrict: 'A',\n\t\t\tscope: {\n\t\t\t\tdata: '=xpsuiPortalWidgetCategoryView'\n\t\t\t},\n\t\t\ttemplate: '<article ng-repeat=\"c in model\" style=\"overflow: auto;\">'\n\t\t\t\t+ '\t\t\t<div><a ng-click=\"navigate(c.id)\" ng-bind-html=\"makeSafe(c.title)\"></a></div>'\n\t\t\t\t+ '\t\t\t<img ng-show=\"c.img.img\" ng-src=\"{{c.img.img}}\" style=\"width: 164px !important; height: 123px !important;float: left;\"></img>'\n\t\t\t\t+ '\t\t\t<div ng-bind-html=\"makeSafe(c.abstract)\" class=\"x-portal-widget-category-inner\"></div></article>'\n\t\t\t\t+ '<div style=\" text-align: right; clear: both;\" class=\"x-portal-widget-category-navigation\">'\n\t\t\t\t+ '\t<a ng-click=\"prevPage()\" style=\" color: #CB2225; \"><i class=\"fa fa-chevron-left x-portal-widget-gallery-prev-btn\"></i></a>'\n\t\t\t\t+ '\t&nbsp;&nbsp;<a ng-click=\"nextPage()\" style=\" color: #CB2225; \"><i class=\"fa fa-chevron-right x-portal-widget-gallery-next-btn\"></i></a>'\n\t\t\t\t+ '</div>',\n\t\t\tlink: function(scope, elm, attrs, ctrls) {\n\t\t\t\tlog.group('portal-widget-category-view Link');\n\n\t\t\t\telm.addClass('x-portal-widget-category');\n\n\t\t\t\tscope.model = [];\n\t\t\t\tscope.page = 0;\n\t\t\t\tscope.numberPerPage = scope.data.data.pageSize;\n\t\t\t\tconsole.log('dsa');\n\t\t\t\tif ((typeof scope.numberPerPage === \"undefined\")\n\t\t\t\t\t\t|| scope.numberPerPage == '') {\n\t\t\t\t\tscope.numberPerPage = 20;\n\t\t\t\t}\n\t\t\t\tscope.prevPage = function () {\n\t\t\t\t\tscope.page--;\n\t\t\t\t\tif (scope.page < 0) {\n\t\t\t\t\t\tscope.page = 0;\n\t\t\t\t\t}\n\t\t\t\t\tscope.refreshPage();\n\t\t\t\t};\n\t\t\t\tscope.nextPage = function () {\n\t\t\t\t\tscope.page++;\n\t\t\t\t\tvar totalPages = Math.ceil((1.0 * scope.modelAll.length) / (1.0 * scope.numberPerPage));\n\t\t\t\t\tif (scope.page >= totalPages) {\n\t\t\t\t\t\tscope.page = totalPages-1;\n\t\t\t\t\t}\n\t\t\t\t\tscope.refreshPage();\n\t\t\t\t};\n\t\t\t\tscope.refreshPage = function () {\n\t\t\t\t\tscope.model = [];\n\t\t\t\t\tvar iterateFrom = scope.page*scope.numberPerPage;\n\t\t\t\t\tvar iterateTo = (scope.page+1)*scope.numberPerPage;\n\t\t\t\t\tvar iterateTo = (iterateTo < scope.modelAll.length)? iterateTo : scope.modelAll.length;\n\t\t\t\t\tfor (var i = iterateFrom; i < iterateTo; ++i) {\n\t\t\t\t\t\tscope.model.push(scope.modelAll[i]);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tfunction findFirstOfType(obj, type) {\n\t\t\t\t\tfor (var j = 0; j < obj.length; ++j) {\n\t\t\t\t\t\tif (obj[j].meta.name === type) {\n\t\t\t\t\t\t\treturn obj[j].data;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tscope.makeSafe = function(str) {\n\t\t\t\t\tif (typeof str === 'string') {\n\t\t\t\t\t\treturn $sce.trustAsHtml(str);\n\t\t\t\t\t}\n\n\t\t\t\t\treturn '';\n\t\t\t\t};\n\n\t\t\t\tconsole.log('querying with page size: ' + scope.numberPerPage);\n\t\t\t\t$http({\n\t\t\t\t\tmethod : 'POST',\n\t\t\t\t\turl: '/portalapi/getByTags',\n\t\t\t\t\tdata: {\n\t\t\t\t\t\ttags: scope.data.data.tags,\n\t\t\t\t\t\tskip: 0,\n\t\t\t\t\t\tlimit: null\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t\t.success(function(data, status, headers, config){\n\t\t\t\t\tif (data && data.length > 0) {\n\t\t\t\t\t\tscope.modelAll = [];\n\t\t\t\t\t\tfor (var i = 0; i < data.length; ++i) {\n\t\t\t\t\t\t\tscope.modelAll.push({\n\t\t\t\t\t\t\t\tid: data[i].id,\n\t\t\t\t\t\t\t\ttitle: findFirstOfType(data[i].data, 'title'),\n\t\t\t\t\t\t\t\tabstract: findFirstOfType(data[i].data, 'abstract'),\n\t\t\t\t\t\t\t\timg: findFirstOfType(data[i].data, 'image'),\n\t\t\t\t\t\t\t\timg1170: findFirstOfType(data[i].data, 'image1170'),\n\t\t\t\t\t\t\t\tvideo: findFirstOfType(data[i].data, 'video'),\n\t\t\t\t\t\t\t\tcontent: findFirstOfType(data[i].data, 'content')\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t\tscope.refreshPage();\n\n\t\t\t\t\t\tconsole.log(scope.modelAll);\n\t\t\t\t\t}\n\t\t\t\t}).error(function(err) {\n\t\t\t\t\tnotificationFactory.error(err);\n\t\t\t\t});\n\n\t\t\t\tscope.navigate = function(aid) {\n\t\t\t\t\t$location.path('/portal/edit/' + aid);\n\t\t\t\t\t//$route.updateParams({id: aid});\n\t\t\t\t};\n\n\t\t\t\tlog.groupEnd();\n\t\t\t}\n\t\t};\n\t}]);\n\n}(window.angular));\n\n\n","(function(angular) {\n\t'use strict';\n\n\tangular.module('xpsui:directives')\n\t.directive('xpsuiPortalWidgetFileListEdit', ['xpsui:logging', '$compile', function(log, $compile) {\n\t\treturn {\n\t\t\trestrict: 'A',\n\t\t\tscope: {\n\t\t\t\tdata: '=xpsuiPortalWidgetFileListEdit',\n\t\t\t\tindex: '='\n\t\t\t},\n\t\t\trequire: ['^xpsuiPortalArticleContentEdit'],\n\t\t\tlink: function(scope, elm, attrs, ctrls) {\n\t\t\t\tlog.group('portal-widget-file-list-edit Link');\n\n\t\t\t\telm.empty();\n\t\t\t\telm.addClass('x-portal-widget-edit');\n\n\t\t\t\tvar titleBar = angular.element('<div class=\"xpsui-portal-widget-title-bar\">{{data.meta.type}}:{{data.meta.name}}<div class=\"pull-right\"><i class=\"action-button icon-add\" ng-click=\"add();\"></i><i class=\"action-button icon-chevron-up\" ng-click=\"moveUp();\"></i><i class=\"action-button icon-chevron-down\" ng-click=\"moveDown();\"></i><i class=\"action-button icon-trash\" ng-click=\"remove();\"></i></div></div>');\n\n\t\t\t\tvar content = angular.element('<div style=\"padding-left: 1px;\">' +\n\t\t\t\t\t\t'<div ng-repeat=\"file in data.data.files\" class=\"psui-wrapper\" style=\"padding: 10px; position: relative;\">' +\n\t\t\t\t\t\t\t'<div style=\"position: absolute; right: 5px; top: 10px;\">' +\n\t\t\t\t\t\t\t\t'<i class=\"action-button icon-chevron-left\" ng-click=\"photoLeft($index);\"></i>'+\n\t\t\t\t\t\t\t\t'<i class=\"action-button icon-trash\" ng-click=\"photoRemove($index);\"></i>'+\n\t\t\t\t\t\t\t\t'<i class=\"action-button icon-chevron-right\" ng-click=\"photoRight($index);\"></i>'+\n\t\t\t\t\t\t\t'</div>' +\n\t\t\t\t\t\t\t\t'<div><div xpsui-uploadable-file ng-model=\"data.data.files[$index]\"></div></div>' +\n\t\t\t\t\t\t'</div>' +\n\t\t\t\t\t'</div>');\n\t\t\t\telm.append(titleBar);\n\t\t\t\telm.append(content);\n\n\t\t\t\t$compile(titleBar)(scope);\n\t\t\t\t$compile(content)(scope);\n\n\t\t\t\tscope.moveUp = function() {\n\t\t\t\t\tctrls[0].moveUp(scope.index);\n\t\t\t\t};\n\n\t\t\t\tscope.moveDown = function() {\n\t\t\t\t\tctrls[0].moveDown(scope.index);\n\t\t\t\t};\n\n\t\t\t\tscope.remove = function() {\n\t\t\t\t\tctrls[0].remove(scope.index);\n\t\t\t\t};\n\n\t\t\t\tscope.add = function() {\n\t\t\t\t\tscope.data.data.files.push({\n\t\t\t\t\t});\n\t\t\t\t};\n\n\t\t\t\tscope.photoLeft = function(idx) {\n\t\t\t\t\tif (idx > 0) {\n\t\t\t\t\t\tvar tmp = scope.data.data.files[idx];\n\t\t\t\t\t\n\t\t\t\t\t\tscope.data.data.files.splice(idx, 1);\n\t\t\t\t\t\tscope.data.data.files.splice(idx-1, 0, tmp);\n\t\t\t\t\t}\n\t\t\t\t};\n\n\t\t\t\tscope.photoRight = function(idx) {\n\t\t\t\t\tif (idx < scope.data.data.files.length - 1) {\n\t\t\t\t\t\tvar tmp = scope.data.data.files[idx];\n\t\t\t\t\t\n\t\t\t\t\t\tscope.data.data.files.splice(idx, 1);\n\t\t\t\t\t\tscope.data.data.files.splice(idx+1, 0, tmp);\n\t\t\t\t\t}\n\t\t\t\t};\n\n\t\t\t\tscope.photoRemove = function(idx) {\n\t\t\t\t\t\tscope.data.data.files.splice(idx, 1);\n\t\t\t\t};\n\n\t\t\t\tlog.groupEnd();\n\t\t\t}\n\t\t};\n\t}]);\n\n}(window.angular));\n","(function(angular) {\n\t'use strict';\n\n\tangular.module('xpsui:directives')\n\t.directive('xpsuiPortalWidgetFileListView', ['xpsui:logging', '$compile', function(log, $compile) {\n\t\treturn {\n\t\t\trestrict: 'A',\n\t\t\tscope: {\n\t\t\t\tdata: '=xpsuiPortalWidgetFileListView',\n\t\t\t\tindex: '='\n\t\t\t},\n\t\t\tlink: function(scope, elm, attrs, ctrls) {\n\t\t\t\tlog.group('portal-widget-file-list-view Link');\n\n\t\t\t\telm.empty();\n\t\t\t\telm.addClass('x-portal-widget-edit');\n\n\n\t\t\t\tvar content = angular.element('<div style=\"padding-left: 2px;\">' +\n\t\t\t\t\t\t'<div ng-repeat=\"file in data.data.files\" style=\"padding: 6px 6px;\">' +\n\t\t\t\t\t\t\t\t'<a href=\"/uploads/get/{{file.fileId}}\" target=\"_blank\" ng-click=\"$event.stopPropagation();\" download=\"{{file.fileName}}\">{{file.fileName}}</a>' +\n\t\t\t\t\t\t'</div>' +\n\t\t\t\t\t'</div>');\n\n\t\t\t\telm.append(content);\n\n\t\t\t\t$compile(content)(scope);\n\n\t\t\t\tlog.groupEnd();\n\t\t\t}\n\t\t};\n\t}]);\n\n}(window.angular));\n","(function(angular) {\n\t'use strict';\n\n\tangular.module('xpsui:directives')\n\t.directive('xpsuiPortalWidgetGalleryEdit', ['xpsui:logging', '$compile', function(log, $compile) {\n\t\treturn {\n\t\t\trestrict: 'A',\n\t\t\tscope: {\n\t\t\t\tdata: '=xpsuiPortalWidgetGalleryEdit',\n\t\t\t\tindex: '='\n\t\t\t},\n\t\t\trequire: ['^xpsuiPortalArticleContentEdit'],\n\t\t\tlink: function(scope, elm, attrs, ctrls) {\n\t\t\t\tlog.group('portal-widget-gallery-edit Link');\n\n\t\t\t\telm.empty();\n\t\t\t\telm.addClass('x-portal-widget-edit');\n\n\t\t\t\tvar titleBar = angular.element('<div class=\"xpsui-portal-widget-title-bar\">{{data.meta.type}}:{{data.meta.name}}<div class=\"pull-right\"><i class=\"action-button icon-add\" ng-click=\"add();\"></i><i class=\"action-button icon-chevron-up\" ng-click=\"moveUp();\"></i><i class=\"action-button icon-chevron-down\" ng-click=\"moveDown();\"></i><i class=\"action-button icon-trash\" ng-click=\"remove();\"></i></div></div>');\n//\t\t\t\tvar content = angular.element('<div class=\"psui-wrapper\" style=\"text-align: center;\"><psui-uploadable-image psui-imageresizor=\"\" psui-imageresizor-width=\"656\" psui-imageresizor-height=\"492\" ng-model=\"data.data.img\" style=\"width: 656px !important; height: 492px !important; background-image: url(https://localhost:3443/img/no_image.jpg); margin:0;\"></psui-uploadable-image></div>');\n\n\t\t\t\tvar content = angular.element('<div style=\"padding-left: 1px;\">' +\n\t\t\t\t\t\t'<div ng-repeat=\"photo in data.data.images\" class=\"psui-wrapper\" style=\"display: inline-block; padding: 0px; position: relative;\">' +\n\t\t\t\t\t\t\t'<div style=\"position: absolute; left: 5px; top: 5px;\">' +\n\t\t\t\t\t\t\t\t'<i class=\"action-button icon-chevron-left\" ng-click=\"photoLeft($index);\"></i>'+\n\t\t\t\t\t\t\t\t'<i class=\"action-button icon-trash\" ng-click=\"photoRemove($index);\"></i>'+\n\t\t\t\t\t\t\t\t'<i class=\"action-button icon-chevron-right\" ng-click=\"photoRight($index);\"></i>'+\n\t\t\t\t\t\t\t'</div>' +\n\t\t\t\t\t\t\t\t'<div xpsui-uploadable-image xpsui-imageresizor psui-width=\"656\" psui-height=\"492\" ng-model=\"photo.img\" style=\"width: 162px !important; height: 123px !important; background-image: url(/img/no_image.jpg); margin:0;\">' +\n\t\t\t\t\t\t\t\t'</div>' +\n\t\t\t\t\t\t'</div>' +\n\t\t\t\t\t'</div>');\n\t\t\t\telm.append(titleBar);\n\t\t\t\telm.append(content);\n\n\t\t\t\t$compile(titleBar)(scope);\n\t\t\t\t$compile(content)(scope);\n\n\t\t\t\tscope.moveUp = function() {\n\t\t\t\t\tctrls[0].moveUp(scope.index);\n\t\t\t\t};\n\n\t\t\t\tscope.moveDown = function() {\n\t\t\t\t\tctrls[0].moveDown(scope.index);\n\t\t\t\t};\n\n\t\t\t\tscope.remove = function() {\n\t\t\t\t\tctrls[0].remove(scope.index);\n\t\t\t\t};\n\n\t\t\t\tscope.add = function() {\n\t\t\t\t\tscope.data.data.images.push({\n\t\t\t\t\t});\n\t\t\t\t};\n\n\t\t\t\tscope.photoLeft = function(idx) {\n\t\t\t\t\tif (idx > 0) {\n\t\t\t\t\t\tvar tmp = scope.data.data.images[idx];\n\t\t\t\t\t\n\t\t\t\t\t\tscope.data.data.images.splice(idx, 1);\n\t\t\t\t\t\tscope.data.data.images.splice(idx-1, 0, tmp);\n\t\t\t\t\t}\n\t\t\t\t};\n\n\t\t\t\tscope.photoRight = function(idx) {\n\t\t\t\t\tif (idx < scope.data.data.images.length - 1) {\n\t\t\t\t\t\tvar tmp = scope.data.data.images[idx];\n\t\t\t\t\t\n\t\t\t\t\t\tscope.data.data.images.splice(idx, 1);\n\t\t\t\t\t\tscope.data.data.images.splice(idx+1, 0, tmp);\n\t\t\t\t\t}\n\t\t\t\t};\n\n\t\t\t\tscope.photoRemove = function(idx) {\n\t\t\t\t\t\tscope.data.data.images.splice(idx, 1);\n\t\t\t\t};\n\n\t\t\t\tlog.groupEnd();\n\t\t\t}\n\t\t};\n\t}]);\n\n}(window.angular));\n\n\n","(function(angular) {\n\t'use strict';\n\n\tangular.module('xpsui:directives')\n\t.directive('xpsuiPortalWidgetGalleryView', ['xpsui:logging', '$compile', function(log, $compile) {\n\t\treturn {\n\t\t\trestrict: 'A',\n\t\t\tscope: {\n\t\t\t\tdata: '=xpsuiPortalWidgetGalleryView',\n\t\t\t\tindex: '='\n\t\t\t},\n\t\t\tlink: function(scope, elm, attrs, ctrls) {\n\t\t\t\tlog.group('portal-widget-gallery-view Link');\n\n\t\t\t\telm.empty();\n\t\t\t\telm.addClass('x-portal-widget-edit');\n\n\n\t\t\t\tvar content = angular.element('<div style=\"padding-left: 2px;\">' +\n\t\t\t\t\t\t'<div ng-repeat=\"photo in data.data.images\" style=\"display: inline-block; padding-left: 1px;\">' +\n\t\t\t\t\t\t\t\t'<img ng-src=\"{{photo.img}}\" style=\"width: 162px !important; height: 123px !important; margin:0;\" ng-click=\"show($index);\"></img>' +\n\t\t\t\t\t\t'</div>' +\n\t\t\t\t\t'</div>');\n\n\t\t\t\tvar viewer = angular.element('<div ng-show=\"viewerVisible\" style=\"z-index: 100; position: fixed; top: 0; height:100%; left:0; width: 100%; display: table;\">' +\n\t\t\t\t\t\t'<div style=\"display: table-cell; vertical-align: middle; width: 625px; margin-left: auto; margin-right: auto;\">'+\n\t\t\t\t\t\t'<div style=\"display: block; vertical-align: middle; width: 676px; min-height: 535px; margin-left: auto; margin-right: auto; position: relative; background-color: white; box-shadow: 0 3px 3px gray;\">'+\n\t\t\t\t\t\t\t'<div ng-repeat=\"photo in data.data.images\" ng-show=\"visibleIndex == $index\" style=\"display: inline-block; padding-left: 1px; position: absolute; top: 10px; bottom: 10px; left: 10px; right: 10px;\">' +\n\t\t\t\t\t\t\t\t\t'<img ng-src=\"{{photo.img}}\" style=\"width: 656px !important; height: 492px !important; margin:0;\"></img>' +\n\t\t\t\t\t\t\t\t\t'<div style=\"position: absolute; bottom: 0; left: 0;\">' +\n\t\t\t\t\t\t\t\t\t\t'<i class=\"icon-chevron-left\" ng-click=\"photoLeft();\"></i>'+\n\t\t\t\t\t\t\t\t\t\t' <i class=\"icon-chevron-right\" ng-click=\"photoRight();\"></i>'+\n\t\t\t\t\t\t\t\t\t'</div>'+\n\t\t\t\t\t\t\t\t\t'<div style=\"position: absolute; bottom: 0; right: 0; font-size: 18px;\">' +\n\t\t\t\t\t\t\t\t\t\t'<i class=\"icon-remove\" ng-click=\"close();\"></i>'+\n\t\t\t\t\t\t\t\t\t'</div>'+\n\t\t\t\t\t\t\t'</div>' +\n\t\t\t\t\t\t'</div>' +\n\t\t\t\t\t\t'</div>' +\n\t\t\t\t\t'</div>');\n\n\t\t\t\tscope.viewerVisible = false;\n\n\t\t\t\tscope.visibleIndex = 0;\n\n\t\t\t\tscope.show = function(idx) {\n\t\t\t\t\tscope.viewerVisible = true;\n\t\t\t\t\tscope.visibleIndex = idx;\n\t\t\t\t};\n\n\t\t\t\tscope.close = function(idx) {\n\t\t\t\t\tscope.viewerVisible = false;\n\t\t\t\t};\n\n\t\t\t\tscope.photoLeft = function() {\n\t\t\t\t\t--scope.visibleIndex;\n\n\t\t\t\t\tif (scope.visibleIndex < 0) {\n\t\t\t\t\t\tscope.visibleIndex = scope.data.data.images.length-1;\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t\tscope.photoRight = function() {\n\t\t\t\t\t++scope.visibleIndex;\n\n\t\t\t\t\tif (scope.visibleIndex > scope.data.data.images.length-1) {\n\t\t\t\t\t\tscope.visibleIndex = 0;\n\t\t\t\t\t}\n\t\t\t\t};\n\n\t\t\t\telm.append(content);\n\t\t\t\telm.append(viewer);\n\n\t\t\t\t$compile(content)(scope);\n\t\t\t\t$compile(viewer)(scope);\n\n\t\t\t\tlog.groupEnd();\n\t\t\t}\n\t\t};\n\t}]);\n\n}(window.angular));\n\n\n","(function(angular) {\n\t'use strict';\n\n\tangular.module('xpsui:directives')\n\t.directive('xpsuiPortalWidgetImageEdit', ['xpsui:logging', '$compile', function(log, $compile) {\n\t\treturn {\n\t\t\trestrict: 'A',\n\t\t\tscope: {\n\t\t\t\tdata: '=xpsuiPortalWidgetImageEdit',\n\t\t\t\tindex: '='\n\t\t\t},\n\t\t\trequire: ['^xpsuiPortalArticleContentEdit'],\n\t\t\tlink: function(scope, elm, attrs, ctrls) {\n\t\t\t\tlog.group('portal-widget-image-edit Link');\n\n\t\t\t\telm.empty();\n\t\t\t\telm.addClass('x-portal-widget-edit');\n\n\t\t\t\tvar titleBar = angular.element('<div class=\"xpsui-portal-widget-title-bar\">{{data.meta.type}}:{{data.meta.name}}<div class=\"pull-right\"><i class=\"action-button icon-chevron-up\" ng-click=\"moveUp();\"></i><i class=\"action-button icon-chevron-down\" ng-click=\"moveDown();\"></i><i class=\"action-button icon-trash\" ng-click=\"remove();\"></i></div></div>');\n\t\t\t\tvar content = angular.element('<div class=\"psui-wrapper\" style=\"text-align: center;\"><div xpsui-uploadable-image=\"\" xpsui-imageresizor=\"\" psui-width=\"656\" psui-height=\"492\" ng-model=\"data.data.img\" style=\"width: 100% !important; height: 492px !important; background-image: url(https://localhost:3443/img/no_image.jpg); margin:0;\" class=\"xpsui-uploadable-image xpsui-imageresizor\"></div></div>');\n\n\t\t\t\telm.append(titleBar);\n\t\t\t\telm.append(content);\n\n\t\t\t\t$compile(titleBar)(scope);\n\t\t\t\t$compile(content)(scope);\n\n\t\t\t\tscope.moveUp = function() {\n\t\t\t\t\tctrls[0].moveUp(scope.index);\n\t\t\t\t};\n\n\t\t\t\tscope.moveDown = function() {\n\t\t\t\t\tctrls[0].moveDown(scope.index);\n\t\t\t\t};\n\n\t\t\t\tscope.remove = function() {\n\t\t\t\t\tctrls[0].remove(scope.index);\n\t\t\t\t};\n\n\t\t\t\tlog.groupEnd();\n\t\t\t}\n\t\t};\n\t}]);\n\n}(window.angular));\n\n\n","(function(angular) {\n\t'use strict';\n\n\tangular.module('xpsui:directives')\n\t.directive('xpsuiPortalWidgetImageView', ['xpsui:logging', '$compile', function(log, $compile) {\n\t\treturn {\n\t\t\trestrict: 'A',\n\t\t\tscope: {\n\t\t\t\tdata: '=xpsuiPortalWidgetImageView'\n\t\t\t},\n\t\t\tlink: function(scope, elm, attrs, ctrls) {\n\t\t\t\tlog.group('portal-widget-image-view Link');\n\n\t\t\t\telm.empty();\n\t\t\t\telm.addClass('x-portal-widget-view');\n//width: 656px !important; height: 492px !important; \n\t\t\t\tvar content = angular.element('<div class=\"psui-wrapper\" style=\"text-align: center;\"><img ng-src=\"{{data.data.img}}\" style=\"margin:0;\"></img></div>');\n\n\t\t\t\telm.append(content);\n\n\t\t\t\t$compile(content)(scope);\n\n\t\t\t\tlog.groupEnd();\n\t\t\t}\n\t\t};\n\t}]);\n\n}(window.angular));\n\n\n","(function(angular) {\n\t'use strict';\n\n\tangular.module('xpsui:directives')\n\t.directive('xpsuiPortalWidgetImage1170Edit', ['xpsui:logging', '$compile', function(log, $compile) {\n\t\treturn {\n\t\t\trestrict: 'A',\n\t\t\tscope: {\n\t\t\t\tdata: '=xpsuiPortalWidgetImage1170Edit',\n\t\t\t\tindex: '='\n\t\t\t},\n\t\t\trequire: ['^xpsuiPortalArticleContentEdit'],\n\t\t\tlink: function(scope, elm, attrs, ctrls) {\n\t\t\t\tlog.group('portal-widget-image1170-edit Link');\n\n\t\t\t\telm.empty();\n\t\t\t\telm.addClass('x-portal-widget-edit');\n\n\t\t\t\tvar titleBar = angular.element('<div class=\"xpsui-portal-widget-title-bar\">{{data.meta.type}}:{{data.meta.name}}<div class=\"pull-right\"><i class=\"action-button icon-chevron-up\" ng-click=\"moveUp();\"></i><i class=\"action-button icon-chevron-down\" ng-click=\"moveDown();\"></i><i class=\"action-button icon-trash\" ng-click=\"remove();\"></i></div></div>');\n\t\t\t\tvar content = angular.element('<div class=\"psui-wrapper\" style=\"text-align: center;\"><div xpsui-uploadable-image=\"\" xpsui-imageresizor=\"\" psui-width=\"1170\" psui-height=\"570\" ng-model=\"data.data.img\" style=\"width: 100% !important; height: 492px !important; background-image: url(https://localhost:3443/img/no_image.jpg); margin:0;\" class=\"xpsui-uploadable-image xpsui-imageresizor\"></div></div>');\n\n\t\t\t\telm.append(titleBar);\n\t\t\t\telm.append(content);\n\n\t\t\t\t$compile(titleBar)(scope);\n\t\t\t\t$compile(content)(scope);\n\n\t\t\t\tscope.moveUp = function() {\n\t\t\t\t\tctrls[0].moveUp(scope.index);\n\t\t\t\t};\n\n\t\t\t\tscope.moveDown = function() {\n\t\t\t\t\tctrls[0].moveDown(scope.index);\n\t\t\t\t};\n\n\t\t\t\tscope.remove = function() {\n\t\t\t\t\tctrls[0].remove(scope.index);\n\t\t\t\t};\n\n\t\t\t\tlog.groupEnd();\n\t\t\t}\n\t\t};\n\t}]);\n\n}(window.angular));\n\n\n","(function(angular) {\n\t'use strict';\n\n\tangular.module('xpsui:directives')\n\t.directive('xpsuiPortalWidgetImage1170View', ['xpsui:logging', '$compile', function(log, $compile) {\n\t\treturn {\n\t\t\trestrict: 'A',\n\t\t\tscope: {\n\t\t\t\tdata: '=xpsuiPortalWidgetImage1170View'\n\t\t\t},\n\t\t\tlink: function(scope, elm, attrs, ctrls) {\n\t\t\t\tlog.group('portal-widget-image1170-view Link');\n\n\t\t\t\telm.empty();\n\t\t\t\telm.addClass('x-portal-widget-view');\n//width: 656px !important; height: 492px !important; \n\t\t\t\tvar content = angular.element('<div class=\"psui-wrapper\" style=\"text-align: center;\"><img ng-src=\"{{data.data.img}}\" style=\"margin:0;\"></img></div>');\n\n\t\t\t\telm.append(content);\n\n\t\t\t\t$compile(content)(scope);\n\n\t\t\t\tlog.groupEnd();\n\t\t\t}\n\t\t};\n\t}]);\n\n}(window.angular));\n\n\n","(function(angular) {\n\t'use strict';\n\n\tangular.module('xpsui:directives')\n\t.directive('xpsuiPortalWidgetLinkEdit', ['xpsui:logging', '$compile', function(log, $compile) {\n\t\treturn {\n\t\t\trestrict: 'A',\n\t\t\tscope: {\n\t\t\t\tdata: '=xpsuiPortalWidgetLinkEdit',\n\t\t\t\tindex: '='\n\t\t\t},\n\t\t\trequire: ['^xpsuiPortalArticleContentEdit'],\n\t\t\tlink: function(scope, elm, attrs, ctrls) {\n\t\t\t\tlog.group('portal-widget-link-edit Link');\n\n\t\t\t\telm.empty();\n\t\t\t\telm.addClass('x-portal-widget-edit');\n\n\t\t\t\tvar titleBar = angular.element('<div class=\"xpsui-portal-widget-title-bar\">{{data.meta.type}}:{{data.meta.name}}<div class=\"pull-right\"><i class=\"action-button icon-chevron-up\" ng-click=\"moveUp();\"></i><i class=\"action-button icon-chevron-down\" ng-click=\"moveDown();\"></i><i class=\"action-button icon-trash\" ng-click=\"remove();\"></i></div></div>');\n\t\t\t\tvar content = angular.element(\n\t\t\t\t\t\t'<form class=\"form\">'\n\t\t\t\t\t\t+'<fieldset class=\"form-group\" style=\"background-color: black; padding: 10px;\" ng-show=\"mode !== \\'edit\\'\">'\n\t\t\t\t\t\t+'<div style=\"background-color: white; padding-top: 10px; padding-bottom: 10px;\">'\n\t\t\t\t\t\t+' <div class=\"form-group row\">'\n\t\t\t\t\t\t+'  <label class=\"col-sm-2 control-label\">URL:</label>'\n\t\t\t\t\t\t+'  <div class=\"col-sm-4\"><div class=\"input-group\"><input ng-model=\"data.data.href\"/></div></div>'\n\t\t\t\t\t\t+' </div>'\n\t\t\t\t\t\t+' <div class=\"form-group row\">'\n\t\t\t\t\t\t+'  <label class=\"col-sm-2 control-label\">Title:</label>'\n\t\t\t\t\t\t+'  <div class=\"col-sm-4\"><div class=\"input-group\"><input ng-model=\"data.data.title\"/></div></div>'\n\t\t\t\t\t\t+' </div>'\n\t\t\t\t\t\t+' <div class=\"form-group row\">'\n\t\t\t\t\t\t+'  <label class=\"col-sm-2 control-label\">Otvoriť v novom okne:</label>'\n\t\t\t\t\t\t+'  <div class=\"col-sm-4\"><div class=\"input-group\"><input ng-model=\"data.data.newWindow\" type=\"checkbox\" /></div></div>'\n\t\t\t\t\t\t+' </div>'\n\t\t\t\t\t\t+'</div>'\n\t\t\t\t\t\t+'</fieldset>'\n\t\t\t\t\t\t+'</form>');\n\n\t\t\t\telm.append(titleBar);\n\t\t\t\telm.append(content);\n\n\t\t\t\t$compile(titleBar)(scope);\n\t\t\t\t$compile(content)(scope);\n\n\t\t\t\tscope.moveUp = function() {\n\t\t\t\t\tctrls[0].moveUp(scope.index);\n\t\t\t\t};\n\n\t\t\t\tscope.moveDown = function() {\n\t\t\t\t\tctrls[0].moveDown(scope.index);\n\t\t\t\t};\n\n\t\t\t\tscope.remove = function() {\n\t\t\t\t\tctrls[0].remove(scope.index);\n\t\t\t\t};\n\n\t\t\t\tlog.groupEnd();\n\t\t\t}\n\t\t};\n\t}]);\n\n}(window.angular));\n\n\n","(function(angular) {\n\t'use strict';\n\n\tangular.module('xpsui:directives')\n\t.directive('xpsuiPortalWidgetLinkView', ['xpsui:logging', '$compile', function(log, $compile) {\n\t\treturn {\n\t\t\trestrict: 'A',\n\t\t\tscope: {\n\t\t\t\tdata: '=xpsuiPortalWidgetLinkView'\n\t\t\t},\n\t\t\tlink: function(scope, elm, attrs, ctrls) {\n\t\t\t\tlog.group('portal-widget-link-view Link');\n\n\t\t\t\telm.empty();\n\t\t\t\telm.addClass('x-portal-widget-view');\n\t\t\t\tvar target = scope.data.data.newWindow?' target=\"_blank\" ': ' ';\n\t\t\t\tvar content = angular.element('<div class=\"psui-wrapper\" style=\"text-align: left; padding: 10px;\"><a href=\"{{data.data.href|httpPrefixed}}\" ' + target + ' >{{data.data.title}}</a></div>');\n\n\t\t\t\telm.append(content);\n\n\t\t\t\t$compile(content)(scope);\n\n\t\t\t\tlog.groupEnd();\n\t\t\t}\n\t\t};\n\t}]);\n\n}(window.angular));\n\n\n","(function(angular) {\n\t'use strict';\n\n\tangular.module('xpsui:directives')\n\t.directive('xpsuiPortalWidgetMatchResultsEdit', ['xpsui:logging', '$compile', function(log, $compile) {\n\t\treturn {\n\t\t\trestrict: 'A',\n\t\t\tscope: {\n\t\t\t\tdata: '=xpsuiPortalWidgetMatchResultsEdit',\n\t\t\t\tindex: '='\n\t\t\t},\n\t\t\trequire: ['^xpsuiPortalArticleContentEdit'],\n\t\t\tlink: function(scope, elm, attrs, ctrls) {\n\t\t\t\tlog.group('portal-widget-match-results-edit Link');\n\n\t\t\t\telm.empty();\n\t\t\t\telm.addClass('x-portal-widget-edit');\n\n\t\t\t\tvar titleBar = angular.element('<div class=\"xpsui-portal-widget-title-bar\">{{data.meta.type}}:{{data.meta.name}}<div class=\"pull-right\"><i class=\"action-button icon-chevron-up\" ng-click=\"moveUp();\"></i><i class=\"action-button icon-chevron-down\" ng-click=\"moveDown();\"></i><i class=\"action-button icon-trash\" ng-click=\"remove();\"></i></div></div>');\n\t\t\t\tvar content = angular.element(scope.data.meta.element);\n\t\t\t\tcontent.attr('ng-model', 'data.data');\n\t\t\t\tcontent.attr('xpsui-contenteditable', 'false');\n\n\t\t\t\telm.append(titleBar);\n\t\t\t\telm.append(content);\n\n\t\t\t\t$compile(titleBar)(scope);\n\t\t\t\t$compile(content)(scope);\n\n\t\t\t\tscope.moveUp = function() {\n\t\t\t\t\tctrls[0].moveUp(scope.index);\n\t\t\t\t};\n\n\t\t\t\tscope.moveDown = function() {\n\t\t\t\t\tctrls[0].moveDown(scope.index);\n\t\t\t\t};\n\n\t\t\t\tscope.remove = function() {\n\t\t\t\t\tctrls[0].remove(scope.index);\n\t\t\t\t};\n\n\t\t\t\tlog.groupEnd();\n\t\t\t}\n\t\t};\n\t}]);\n\n}(window.angular));\n\n","(function(angular) {\n\t'use strict';\n\n\tangular.module('xpsui:directives')\n\t.directive('xpsuiPortalWidgetMatchResultsView', ['xpsui:logging', '$compile', '$sce', function(log, $compile, $sce) {\n\t\treturn {\n\t\t\trestrict: 'A',\n\t\t\tscope: {\n\t\t\t\tdata: '=xpsuiPortalWidgetMatchResultsView'\n\t\t\t},\n\t\t\tlink: function(scope, elm, attrs, ctrls) {\n\t\t\t\tlog.group('portal-widget-match-results-view Link');\n\n\t\t\t\telm.empty();\n\t\t\t\telm.addClass('x-portal-widget-view');\n\n\t\t\t\tvar content = angular.element(scope.data.meta.element);\n\t\t\t\tcontent.attr('ng-bind-html', 'makeSafe(data.data);');\n\n\t\t\t\telm.append(content);\n\n\t\t\t\t$compile(content)(scope);\n\n\t\t\t\tlog.groupEnd();\n\n\t\t\t\tscope.makeSafe = function(str) {\n\t\t\t\t\tif (typeof str === 'string') {\n\t\t\t\t\t\treturn $sce.trustAsHtml(str);\n\t\t\t\t\t}\n\n\t\t\t\t\treturn '';\n\t\t\t\t};\n\n\t\t\t}\n\t\t};\n\t}]);\n\n}(window.angular));\n\n","(function(angular) {\n\t'use strict';\n\n\tangular.module('xpsui:directives')\n\t.directive('xpsuiPortalWidgetMatchStandingsEdit', ['xpsui:logging', '$compile', function(log, $compile) {\n\t\treturn {\n\t\t\trestrict: 'A',\n\t\t\tscope: {\n\t\t\t\tdata: '=xpsuiPortalWidgetMatchStandingsEdit',\n\t\t\t\tindex: '='\n\t\t\t},\n\t\t\trequire: ['^xpsuiPortalArticleContentEdit'],\n\t\t\tlink: function(scope, elm, attrs, ctrls) {\n\t\t\t\tlog.group('portal-widget-match-standings-edit Link');\n\n\t\t\t\telm.empty();\n\t\t\t\telm.addClass('x-portal-widget-edit');\n\n\t\t\t\tvar titleBar = angular.element('<div class=\"xpsui-portal-widget-title-bar\">{{data.meta.type}}:{{data.meta.name}}<div class=\"pull-right\"><i class=\"action-button icon-chevron-up\" ng-click=\"moveUp();\"></i><i class=\"action-button icon-chevron-down\" ng-click=\"moveDown();\"></i><i class=\"action-button icon-trash\" ng-click=\"remove();\"></i></div></div>');\n\t\t\t\tvar content = angular.element(scope.data.meta.element);\n\t\t\t\tcontent.attr('ng-model', 'data.data');\n\t\t\t\tcontent.attr('xpsui-contenteditable', 'false');\n\n\t\t\t\telm.append(titleBar);\n\t\t\t\telm.append(content);\n\n\t\t\t\t$compile(titleBar)(scope);\n\t\t\t\t$compile(content)(scope);\n\n\t\t\t\tscope.moveUp = function() {\n\t\t\t\t\tctrls[0].moveUp(scope.index);\n\t\t\t\t};\n\n\t\t\t\tscope.moveDown = function() {\n\t\t\t\t\tctrls[0].moveDown(scope.index);\n\t\t\t\t};\n\n\t\t\t\tscope.remove = function() {\n\t\t\t\t\tctrls[0].remove(scope.index);\n\t\t\t\t};\n\n\t\t\t\tlog.groupEnd();\n\t\t\t}\n\t\t};\n\t}]);\n\n}(window.angular));\n\n","(function(angular) {\n\t'use strict';\n\n\tangular.module('xpsui:directives')\n\t.directive('xpsuiPortalWidgetMatchStandingsView', ['xpsui:logging', '$compile', '$sce', function(log, $compile, $sce) {\n\t\treturn {\n\t\t\trestrict: 'A',\n\t\t\tscope: {\n\t\t\t\tdata: '=xpsuiPortalWidgetMatchStandingsView'\n\t\t\t},\n\t\t\tlink: function(scope, elm, attrs, ctrls) {\n\t\t\t\tlog.group('portal-widget-match-standings-view Link');\n\n\t\t\t\telm.empty();\n\t\t\t\telm.addClass('x-portal-widget-view');\n\n\t\t\t\tvar content = angular.element(scope.data.meta.element);\n\t\t\t\tcontent.attr('ng-bind-html', 'makeSafe(data.data);');\n\n\t\t\t\telm.append(content);\n\n\t\t\t\t$compile(content)(scope);\n\n\t\t\t\tlog.groupEnd();\n\n\t\t\t\tscope.makeSafe = function(str) {\n\t\t\t\t\tif (typeof str === 'string') {\n\t\t\t\t\t\treturn $sce.trustAsHtml(str);\n\t\t\t\t\t}\n\n\t\t\t\t\treturn '';\n\t\t\t\t};\n\n\t\t\t}\n\t\t};\n\t}]);\n\n}(window.angular));\n\n","(function(angular) {\n\t'use strict';\n\n\tangular.module('xpsui:directives')\n\t.directive('xpsuiPortalWidgetOverviewEdit', ['xpsui:logging', '$compile', function(log, $compile) {\n\t\treturn {\n\t\t\trestrict: 'A',\n\t\t\tscope: {\n\t\t\t\tdata: '=xpsuiPortalWidgetOverviewEdit',\n\t\t\t\tindex: '='\n\t\t\t},\n\t\t\trequire: ['^xpsuiPortalArticleContentEdit'],\n\t\t\tlink: function(scope, elm, attrs, ctrls) {\n\t\t\t\tlog.group('portal-widget-Overview-edit Link');\n\n\t\t\t\telm.empty();\n\t\t\t\telm.addClass('x-portal-widget-edit');\n\n\t\t\t\tvar titleBar = angular.element('<div class=\"xpsui-portal-widget-title-bar\">{{data.meta.type}}:{{data.meta.name}}<div class=\"pull-right\"><i class=\"action-button icon-chevron-up\" ng-click=\"moveUp();\"></i><i class=\"action-button icon-chevron-down\" ng-click=\"moveDown();\"></i><i class=\"action-button icon-trash\" ng-click=\"remove();\"></i></div></div>');\n\t\t\t\tvar content = angular.element(\n\t\t\t\t\t'<form class=\"form\">'\n\t\t\t\t\t+'<fieldset class=\"form-group\" style=\"background-color: black; padding: 10px;\" ng-show=\"mode !== \\'edit\\'\">'\n\t\t\t\t\t+'<div style=\"background-color: white; padding-top: 10px; padding-bottom: 10px;\">'\n\t\t\t\t\t+'<div class=\"form-group row\">'\n\t\t\t\t\t+' <label class=\"col-sm-2 control-label\">Tagy:</label>'\n\t\t\t\t\t+' <div class=\"col-sm-4\"><div class=\"input-group\"><div xpsui-portal-multistring-edit ng-model=\"data.data.tags\"></div></div></div>'\n\t\t\t\t\t+'</div>'\n\t\t\t\t\t+'<div class=\"form-group row\">'\n\t\t\t\t\t+' <label class=\"col-sm-2 control-label\">Veľkosť stránky:</label>'\n\t\t\t\t\t+' <div class=\"col-sm-4\"><div class=\"input-group\"><input ng-model=\"data.data.pageSize\"/></div></div>'\n\t\t\t\t\t+'</div>'\n\t\t\t\t\t+'</div>'\n\t\t\t\t\t+'</fieldset>'\n\t\t\t\t\t+'</form>');\n\n\n\t\t\t\telm.append(titleBar);\n\t\t\t\telm.append(content);\n\n\t\t\t\t$compile(titleBar)(scope);\n\t\t\t\t$compile(content)(scope);\n\n\t\t\t\tscope.moveUp = function() {\n\t\t\t\t\tctrls[0].moveUp(scope.index);\n\t\t\t\t};\n\n\t\t\t\tscope.moveDown = function() {\n\t\t\t\t\tctrls[0].moveDown(scope.index);\n\t\t\t\t};\n\n\t\t\t\tscope.remove = function() {\n\t\t\t\t\tctrls[0].remove(scope.index);\n\t\t\t\t};\n\n\t\t\t\tlog.groupEnd();\n\t\t\t}\n\t\t};\n\t}]);\n\n}(window.angular));\n\n\n","(function(angular) {\n\t'use strict';\n\n\tangular.module('xpsui:directives')\n\t.directive('xpsuiPortalWidgetOverviewView', ['xpsui:logging', '$compile', '$http', '$sce', '$route', '$location', function(log, $compile, $http, $sce, $route, $location) {\n\t\treturn {\n\t\t\trestrict: 'A',\n\t\t\tscope: {\n\t\t\t\tdata: '=xpsuiPortalWidgetOverviewView'\n\t\t\t},\n\t\t\ttemplate: '<article ng-repeat=\"c in model\" style=\"overflow: auto;\">'\n\t\t\t\t+ '\t\t\t<div><a ng-click=\"navigate(c.id)\" ng-bind-html=\"makeSafe(c.title)\"></a></div>'\n\t\t\t\t+ '\t\t\t<img ng-show=\"c.img.img\" ng-src=\"{{c.img.img}}\" style=\"width: 164px !important; height: 123px !important;float: left;\"></img>'\n\t\t\t\t+ '\t\t\t<div ng-bind-html=\"makeSafe(c.abstract)\" class=\"x-portal-widget-overview-inner\"></div></article>'\n\t\t\t\t+ '<div style=\" text-align: right; clear: both;\" class=\"x-portal-widget-overview-navigation\">'\n\t\t\t\t+ '\t<a ng-click=\"prevPage()\" style=\" color: #CB2225; \"><i class=\"fa fa-chevron-left x-portal-widget-gallery-prev-btn\"></i></a>'\n\t\t\t\t+ '\t&nbsp;&nbsp;<a ng-click=\"nextPage()\" style=\" color: #CB2225; \"><i class=\"fa fa-chevron-right x-portal-widget-gallery-next-btn\"></i></a>'\n\t\t\t\t+ '</div>',\n\t\t\tlink: function(scope, elm, attrs, ctrls) {\n\t\t\t\tlog.group('portal-widget-overview-view Link');\n\n\t\t\t\telm.addClass('x-portal-widget-overview');\n\n\t\t\t\tscope.model = [];\n\t\t\t\tscope.page = 0;\n\t\t\t\tscope.numberPerPage = scope.data.data.pageSize;\n\t\t\t\tconsole.log('dsa');\n\t\t\t\tif ((typeof scope.numberPerPage === \"undefined\")\n\t\t\t\t\t\t|| scope.numberPerPage == '') {\n\t\t\t\t\tscope.numberPerPage = 20;\n\t\t\t\t}\n\t\t\t\tscope.prevPage = function () {\n\t\t\t\t\tscope.page--;\n\t\t\t\t\tif (scope.page < 0) {\n\t\t\t\t\t\tscope.page = 0;\n\t\t\t\t\t}\n\t\t\t\t\tscope.refreshPage();\n\t\t\t\t};\n\t\t\t\tscope.nextPage = function () {\n\t\t\t\t\tscope.page++;\n\t\t\t\t\tvar totalPages = Math.ceil((1.0 * scope.modelAll.length) / (1.0 * scope.numberPerPage));\n\t\t\t\t\tif (scope.page >= totalPages) {\n\t\t\t\t\t\tscope.page = totalPages-1;\n\t\t\t\t\t}\n\t\t\t\t\tscope.refreshPage();\n\t\t\t\t};\n\t\t\t\tscope.refreshPage = function () {\n\t\t\t\t\tscope.model = [];\n\t\t\t\t\tvar iterateFrom = scope.page*scope.numberPerPage;\n\t\t\t\t\tvar iterateTo = (scope.page+1)*scope.numberPerPage;\n\t\t\t\t\tvar iterateTo = (iterateTo < scope.modelAll.length)? iterateTo : scope.modelAll.length;\n\t\t\t\t\tfor (var i = iterateFrom; i < iterateTo; ++i) {\n\t\t\t\t\t\tscope.model.push(scope.modelAll[i]);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tfunction findFirstOfType(obj, type) {\n\t\t\t\t\tfor (var j = 0; j < obj.length; ++j) {\n\t\t\t\t\t\tif (obj[j].meta.name === type) {\n\t\t\t\t\t\t\treturn obj[j].data;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tscope.makeSafe = function(str) {\n\t\t\t\t\tif (typeof str === 'string') {\n\t\t\t\t\t\treturn $sce.trustAsHtml(str);\n\t\t\t\t\t}\n\n\t\t\t\t\treturn '';\n\t\t\t\t};\n\n\t\t\t\tconsole.log('querying with page size: ' + scope.numberPerPage);\n\t\t\t\t$http({\n\t\t\t\t\tmethod : 'POST',\n\t\t\t\t\turl: '/portalapi/getByTags',\n\t\t\t\t\tdata: {\n\t\t\t\t\t\ttags: scope.data.data.tags,\n\t\t\t\t\t\tskip: 0,\n\t\t\t\t\t\tlimit: null\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t\t.success(function(data, status, headers, config){\n\t\t\t\t\tif (data && data.length > 0) {\n\t\t\t\t\t\tscope.modelAll = [];\n\t\t\t\t\t\tfor (var i = 0; i < data.length; ++i) {\n\t\t\t\t\t\t\tscope.modelAll.push({\n\t\t\t\t\t\t\t\tid: data[i].id,\n\t\t\t\t\t\t\t\ttitle: findFirstOfType(data[i].data, 'title'),\n\t\t\t\t\t\t\t\tabstract: findFirstOfType(data[i].data, 'abstract'),\n\t\t\t\t\t\t\t\timg: findFirstOfType(data[i].data, 'image'),\n\t\t\t\t\t\t\t\timg1170: findFirstOfType(data[i].data, 'image1170'),\n\t\t\t\t\t\t\t\tvideo: findFirstOfType(data[i].data, 'video'),\n\t\t\t\t\t\t\t\tcontent: findFirstOfType(data[i].data, 'content')\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t\tscope.refreshPage();\n\n\t\t\t\t\t\tconsole.log(scope.modelAll);\n\t\t\t\t\t}\n\t\t\t\t}).error(function(err) {\n\t\t\t\t\tnotificationFactory.error(err);\n\t\t\t\t});\n\n\t\t\t\tscope.navigate = function(aid) {\n\t\t\t\t\t$location.path('/portal/edit/' + aid);\n\t\t\t\t\t//$route.updateParams({id: aid});\n\t\t\t\t};\n\n\t\t\t\tlog.groupEnd();\n\t\t\t}\n\t\t};\n\t}]);\n\n}(window.angular));\n\n\n","(function(angular) {\n\t'use strict';\n\n\tangular.module('xpsui:directives')\n\t.directive('xpsuiPortalWidgetPureHtmlEdit', ['xpsui:logging', '$compile', function(log, $compile) {\n\t\treturn {\n\t\t\trestrict: 'A',\n\t\t\tscope: {\n\t\t\t\tdata: '=xpsuiPortalWidgetPureHtmlEdit',\n\t\t\t\tindex: '='\n\t\t\t},\n\t\t\trequire: ['^xpsuiPortalArticleContentEdit'],\n\t\t\tlink: function(scope, elm, attrs, ctrls) {\n\t\t\t\tlog.group('portal-widget-pure-html-edit Link');\n\n\t\t\t\telm.empty();\n\t\t\t\telm.addClass('x-portal-widget-edit');\n\n\t\t\t\tvar titleBar = angular.element('<div class=\"xpsui-portal-widget-title-bar\">{{data.meta.type}}:{{data.meta.name}}<div class=\"pull-right\"><i class=\"action-button icon-chevron-up\" ng-click=\"moveUp();\"></i><i class=\"action-button icon-chevron-down\" ng-click=\"moveDown();\"></i><i class=\"action-button icon-trash\" ng-click=\"remove();\"></i></div></div>');\n\t\t\t\tvar content = angular.element('<div style=\"background-color: black; padding: 10px;\"></div>');\n\t\t\t\tvar contentInner = angular.element(scope.data.meta.element);\n\t\t\t\tcontentInner.attr('ng-model', 'data.data');\n\t\t\t\tcontentInner.attr('xpsui-contenteditable', 'true');\n\t\t\t\tcontent.append(contentInner);\n\t\t\t\tcontent.append('<div style=\"background-color: white; padding: 2px;\">CSS Class: <input ng-model=\"data.css.cssClass\"/></div>');\n\n\t\t\t\telm.append(titleBar);\n\t\t\t\telm.append(content);\n\n\t\t\t\t$compile(titleBar)(scope);\n\t\t\t\t$compile(content)(scope);\n\n\t\t\t\tscope.moveUp = function() {\n\t\t\t\t\tctrls[0].moveUp(scope.index);\n\t\t\t\t};\n\n\t\t\t\tscope.moveDown = function() {\n\t\t\t\t\tctrls[0].moveDown(scope.index);\n\t\t\t\t};\n\n\t\t\t\tscope.remove = function() {\n\t\t\t\t\tctrls[0].remove(scope.index);\n\t\t\t\t};\n\n\t\t\t\tlog.groupEnd();\n\t\t\t}\n\t\t};\n\t}]);\n\n}(window.angular));\n\n","(function(angular) {\n\t'use strict';\n\n\tangular.module('xpsui:directives')\n\t.directive('xpsuiPortalWidgetPureHtmlView', ['xpsui:logging', '$compile', '$sce', function(log, $compile, $sce) {\n\t\treturn {\n\t\t\trestrict: 'A',\n\t\t\tscope: {\n\t\t\t\tdata: '=xpsuiPortalWidgetPureHtmlView'\n\t\t\t},\n\t\t\tlink: function(scope, elm, attrs, ctrls) {\n\t\t\t\tlog.group('portal-widget-pure-html-view Link');\n\n\t\t\t\telm.empty();\n\t\t\t\telm.addClass('x-portal-widget-view');\n\n\t\t\t\tvar content = angular.element(scope.data.meta.element);\n\t\t\t\tcontent.attr('ng-bind-html', 'makeSafe(data.data);');\n\n\t\t\t\telm.append(content);\n\n\t\t\t\t$compile(content)(scope);\n\n\t\t\t\tlog.groupEnd();\n\n\t\t\t\tscope.makeSafe = function(str) {\n\t\t\t\t\tif (typeof str === 'string') {\n\t\t\t\t\t\treturn $sce.trustAsHtml(str);\n\t\t\t\t\t}\n\n\t\t\t\t\treturn '';\n\t\t\t\t};\n\n\t\t\t}\n\t\t};\n\t}]);\n\n}(window.angular));\n\n","(function(angular) {\n\t'use strict';\n\n\tangular.module('xpsui:directives')\n\t.directive('xpsuiPortalWidgetRankingEdit', ['xpsui:logging', '$compile', function(log, $compile) {\n\t\treturn {\n\t\t\trestrict: 'A',\n\t\t\tscope: {\n\t\t\t\tdata: '=xpsuiPortalWidgetRankingEdit',\n\t\t\t\tindex: '='\n\t\t\t},\n\t\t\trequire: ['^xpsuiPortalArticleContentEdit'],\n\t\t\tlink: function(scope, elm, attrs, ctrls) {\n\t\t\t\tlog.group('portal-widget-file-list-edit Link');\n\n\t\t\t\telm.empty();\n\t\t\t\telm.addClass('x-portal-widget-edit');\n\n\t\t\t\tvar titleBar = angular.element('<div class=\"xpsui-portal-widget-title-bar\">{{data.meta.type}}:{{data.meta.name}}<div class=\"pull-right\"><i class=\"action-button icon-add\" ng-click=\"add();\"></i><i class=\"action-button icon-chevron-up\" ng-click=\"moveUp();\"></i><i class=\"action-button icon-chevron-down\" ng-click=\"moveDown();\"></i><i class=\"action-button icon-trash\" ng-click=\"remove();\"></i></div></div>');\n\n\t\t\t\tvar content = angular.element('<div style=\"padding-left: 1px;\">' +\n\t\t\t\t\t\t'<div ng-repeat=\"file in data.data.results\" class=\"psui-wrapper\" style=\"padding: 10px; position: relative;\">' +\n\t\t\t\t\t\t\t'<div style=\"position: absolute; right: 5px; top: 10px;\">' +\n\t\t\t\t\t\t\t\t'<i class=\"action-button icon-chevron-left\" ng-click=\"photoLeft($index);\"></i>'+\n\t\t\t\t\t\t\t\t'<i class=\"action-button icon-trash\" ng-click=\"photoRemove($index);\"></i>'+\n\t\t\t\t\t\t\t\t'<i class=\"action-button icon-chevron-right\" ng-click=\"photoRight($index);\"></i>'+\n\t\t\t\t\t\t\t'</div>' +\n\t\t\t\t\t\t\t'<div>' +\n\t\t\t\t\t\t\t'Meno: <input ng-model=\"data.data.results[$index].name\"/>' +\n\t\t\t\t\t\t\t'\tKrajina: <input ng-model=\"data.data.results[$index].country\"/><br/>' +\n\t\t\t\t\t\t\t'\tBody: <input ng-model=\"data.data.results[$index].points\"/>' +\n\t\t\t\t\t\t\t'\tPercenta: <input ng-model=\"data.data.results[$index].percent\"/>' +\n\t\t\t\t\t\t\t'</div>' +\n\t\t\t\t\t\t'</div>' +\n\t\t\t\t\t'</div>');\n\t\t\t\telm.append(titleBar);\n\t\t\t\telm.append(content);\n\n\t\t\t\t$compile(titleBar)(scope);\n\t\t\t\t$compile(content)(scope);\n\n\t\t\t\tscope.moveUp = function() {\n\t\t\t\t\tctrls[0].moveUp(scope.index);\n\t\t\t\t};\n\n\t\t\t\tscope.moveDown = function() {\n\t\t\t\t\tctrls[0].moveDown(scope.index);\n\t\t\t\t};\n\n\t\t\t\tscope.remove = function() {\n\t\t\t\t\tctrls[0].remove(scope.index);\n\t\t\t\t};\n\n\t\t\t\tscope.add = function() {\n\t\t\t\t\tscope.data.data.results.push({\n\t\t\t\t\t});\n\t\t\t\t};\n\n\t\t\t\tscope.photoLeft = function(idx) {\n\t\t\t\t\tif (idx > 0) {\n\t\t\t\t\t\tvar tmp = scope.data.data.results[idx];\n\t\t\t\t\t\n\t\t\t\t\t\tscope.data.data.results.splice(idx, 1);\n\t\t\t\t\t\tscope.data.data.results.splice(idx-1, 0, tmp);\n\t\t\t\t\t}\n\t\t\t\t};\n\n\t\t\t\tscope.photoRight = function(idx) {\n\t\t\t\t\tif (idx < scope.data.data.results.length - 1) {\n\t\t\t\t\t\tvar tmp = scope.data.data.results[idx];\n\t\t\t\t\t\n\t\t\t\t\t\tscope.data.data.results.splice(idx, 1);\n\t\t\t\t\t\tscope.data.data.results.splice(idx+1, 0, tmp);\n\t\t\t\t\t}\n\t\t\t\t};\n\n\t\t\t\tscope.photoRemove = function(idx) {\n\t\t\t\t\t\tscope.data.data.results.splice(idx, 1);\n\t\t\t\t};\n\n\t\t\t\tlog.groupEnd();\n\t\t\t}\n\t\t};\n\t}]);\n\n}(window.angular));\n","(function(angular) {\n\t'use strict';\n\n\tangular.module('xpsui:directives')\n\t.directive('xpsuiPortalWidgetRankingView', ['xpsui:logging', '$compile', function(log, $compile) {\n\t\treturn {\n\t\t\trestrict: 'A',\n\t\t\tscope: {\n\t\t\t\tdata: '=xpsuiPortalWidgetRankingView',\n\t\t\t\tindex: '='\n\t\t\t},\n\t\t\tlink: function(scope, elm, attrs, ctrls) {\n\t\t\t\tlog.group('portal-widget-file-list-view Link');\n\n\t\t\t\telm.empty();\n\t\t\t\telm.addClass('x-portal-widget-edit');\n\t\t\t\telm.addClass('portal-article-ranking');\n\n\n\t\t\t\tvar content = angular.element('<div class=\"portal-content-title\"></div>' +\n\t\t\t\t\t\t'<div style=\"padding-left: 2px;\" class=\"ranking\">' +\n\t\t\t\t\t\t'<div class=\"portal-content-actual-ranking\">' +\n\t\t\t\t\t\t'<div ng-repeat=\"result in data.data.results\" class=\"actual-ranking-riders-items\">' +\n\t\t\t\t\t\t\t\t'<div class=\"rider-name\">{{$index+1}}. {{result.name}}</div>' +\n\t\t\t\t\t\t\t\t'<div class=\"rider-country\">({{result.country}})</div>' +\n\t\t\t\t\t\t\t\t'<div class=\"rider-points\">({{result.points}})</div>' +\n\t\t\t\t\t\t\t\t'<div class=\"rider-graph\" style=\" width: {{result.percent}}%; \"></div>' +\n\t\t\t\t\t\t'</div>' +\n\t\t\t\t\t'</div></div>');\n\n\t\t\t\telm.append(content);\n\n\t\t\t\t$compile(content)(scope);\n\n\t\t\t\tlog.groupEnd();\n\t\t\t}\n\t\t};\n\t}]);\n\n}(window.angular));\n","(function(angular) {\n\t'use strict';\n\n\tangular.module('xpsui:directives')\n\t.directive('xpsuiPortalWidgetShowcaseEdit', ['xpsui:logging', '$compile', function(log, $compile) {\n\t\treturn {\n\t\t\trestrict: 'A',\n\t\t\tscope: {\n\t\t\t\tdata: '=xpsuiPortalWidgetShowcaseEdit',\n\t\t\t\tindex: '='\n\t\t\t},\n\t\t\trequire: ['^xpsuiPortalArticleContentEdit'],\n\t\t\tlink: function(scope, elm, attrs, ctrls) {\n\t\t\t\tlog.group('portal-widget-category-edit Link');\n\n\t\t\t\telm.empty();\n\t\t\t\telm.addClass('x-portal-widget-edit');\n\n\t\t\t\tvar titleBar = angular.element('<div class=\"xpsui-portal-widget-title-bar\">{{data.meta.type}}:{{data.meta.name}}<div class=\"pull-right\"><i class=\"action-button icon-chevron-up\" ng-click=\"moveUp();\"></i><i class=\"action-button icon-chevron-down\" ng-click=\"moveDown();\"></i><i class=\"action-button icon-trash\" ng-click=\"remove();\"></i></div></div>');\n\t\t\t\tvar content = angular.element(\n\t\t\t\t\t'<form class=\"form\">'\n\t\t\t\t\t+'<fieldset class=\"form-group\" style=\"background-color: black; padding: 10px;\" ng-show=\"mode !== \\'edit\\'\">'\n\t\t\t\t\t+'<div style=\"background-color: white; padding-top: 10px; padding-bottom: 10px;\">'\n\t\t\t\t\t+'<div class=\"form-group row\">'\n\t\t\t\t\t+' <label class=\"col-sm-2 control-label\">Tagy:</label>'\n\t\t\t\t\t+' <div class=\"col-sm-4\"><div class=\"input-group\"><div xpsui-portal-multistring-edit ng-model=\"data.data.tags\"></div></div></div>'\n\t\t\t\t\t+'</div>'\n\t\t\t\t\t+'<div class=\"form-group row\">'\n\t\t\t\t\t+' <label class=\"col-sm-2 control-label\">CSS Classes:</label>'\n\t\t\t\t\t+' <div class=\"col-sm-4\"><input ng-model=\"data.css.cssClass\"/></div>'\n\t\t\t\t\t+'</div>'\n\t\t\t\t\t+'</div>'\n\t\t\t\t\t+'</fieldset>'\n\t\t\t\t\t+'</form>');\n\n\n\t\t\t\telm.append(titleBar);\n\t\t\t\telm.append(content);\n\n\t\t\t\t$compile(titleBar)(scope);\n\t\t\t\t$compile(content)(scope);\n\n\t\t\t\tscope.moveUp = function() {\n\t\t\t\t\tctrls[0].moveUp(scope.index);\n\t\t\t\t};\n\n\t\t\t\tscope.moveDown = function() {\n\t\t\t\t\tctrls[0].moveDown(scope.index);\n\t\t\t\t};\n\n\t\t\t\tscope.remove = function() {\n\t\t\t\t\tctrls[0].remove(scope.index);\n\t\t\t\t};\n\n\t\t\t\tlog.groupEnd();\n\t\t\t}\n\t\t};\n\t}]);\n\n}(window.angular));\n\n\n","(function(angular) {\n\t'use strict';\n\n\tangular.module('xpsui:directives')\n\t.directive('xpsuiPortalWidgetShowcaseView', ['xpsui:logging', '$compile', '$http', '$sce', '$route', '$interval', '$location', function(log, $compile, $http, $sce, $route, $interval, $location) {\n\t\treturn {\n\t\t\trestrict: 'A',\n\t\t\tscope: {\n\t\t\t\tdata: '=xpsuiPortalWidgetShowcaseView'\n\t\t\t},\n\t\t\ttemplate: '<div class=\"portal-content-title\"></div>'\n\t\t\t\t+ '<div class=\"portal-content-container\" style=\" margin-left: {{marginLeft}}px; \"><article ng-repeat=\"c in model\" ng-show=\"visibleIndex == $index || visibleIndex == \\'no\\'\">'\n\t\t\t\t+ '<div class=\"x-portal-widget-showcase-diamond only-location\"><div class=\"x-portal-widget-showcase-diamond-inner\"></div></div>'\n\t\t\t\t+ '<div class=\"only-riderszone\" style=\"background: #b9b9b9; -webkit-clip-path: polygon(0px 110px, 110px 0px, 220px 110px, 110px 220px); position: absolute; width: 220px; height: 220px; margin-left: -15px; margin-top: -15px;\"></div>'\n\t\t\t\t+ '<div class=\"only-riderszone\" style=\"background: url(\\'{{ c.img.img }}\\'); background-size: cover; background-repeat: no-repeat; ; -webkit-clip-path: polygon(0px 95px, 95px 0px, 190px 95px, 95px 190px); width: 190px; height: 190px; \"></div>'\n\t\t\t\t+ '<div ng-show=\"c.img.img\" class=\"x-portal-widget-showcase-image\" style=\"background: url(\\'{{c.img.img}}\\'); background-repeat: no-repeat; background-size: cover; height: 492px; width: 100%;\"></div>'\n\t\t\t\t+ '<div ng-show=\"c.img.img\" class=\"x-portal-widget-showcase-textblock\"><a ng-click=\"navigate(c.id)\" ng-bind-html=\"makeSafe(c.title)\"></a><div ng-bind-html=\"makeSafe(c.abstract)\"></div></div>'\n\t\t\t\t+ '<div ng-show=\"c.img1170.img\" style=\"background: url(\\'{{c.img1170.img}}\\'); background-repeat: no-repeat; background-size: cover; height: 570px; width: 100%;\"></div>'\n\t\t\t\t+ '<div ng-show=\"c.img1170.img\" class=\"x-portal-widget-showcase-textblock\"><a ng-click=\"navigate(c.id)\" ng-bind-html=\"makeSafe(c.title)\"></a></div>'\n\t\t\t\t+ '</article></div>'\n\t\t\t\t+ '<div class=\"portal-content-navigation\"><i class=\"fa fa-caret-left fa-2x\" ng-click=\"moveLeft()\"></i> <i class=\"fa fa-caret-right fa-2x\" ng-click=\"moveRight()\"></i></div>',\n\t\t\tlink: function(scope, elm, attrs, ctrls) {\n\t\t\t\tlog.group('portal-widget-category-view Link');\n\n\t\t\t\telm.addClass('x-portal-widget-showcase');\n\n\t\t\t\tscope.model = [];\n\n\t\t\t\tscope.visibleIndex = 0;\n\t\t\t\tscope.marginLeft = 0;\n\n\t\t\t\tscope.moveLeft = function() {\n\t\t\t\t\tscope.marginLeft = scope.marginLeft + 100;\n\t\t\t\t}\n\t\t\t\tscope.moveRight = function() {\n\t\t\t\t\tscope.marginLeft = scope.marginLeft - 100;\n\t\t\t\t}\n\t\t\t\telm.css('height', '492px');\n\n\t\t\t\tif (attrs.class.indexOf('portal-content-location') < 0\n\t\t\t\t\t\t&& attrs.class.indexOf('portal-content-riderszone') < 0\n\t\t\t\t\t\t&& attrs.class.indexOf('portal-content-mediazone') < 0) {\n\t\t\t\t\t$interval(function() {\n\t\t\t\t\t\t++scope.visibleIndex;\n\t\t\t\t\t\tif (scope.visibleIndex >= scope.model.length) {\n\t\t\t\t\t\t\tscope.visibleIndex = 0;\n\t\t\t\t\t\t}\n\t\t\t\t\t}, 5000);\n\t\t\t\t} else {\n\t\t\t\t\tscope.visibleIndex = 'no';\n\t\t\t\t}\n\n\t\t\t\tfunction findFirstOfType(obj, type) {\n\t\t\t\t\tfor (var j = 0; j < obj.length; ++j) {\n\t\t\t\t\t\tif (obj[j].meta.name === type) {\n\t\t\t\t\t\t\treturn obj[j].data;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tscope.makeSafe = function(str) {\n\t\t\t\t\tif (typeof str === 'string') {\n\t\t\t\t\t\treturn $sce.trustAsHtml(str);\n\t\t\t\t\t}\n\n\t\t\t\t\treturn '';\n\t\t\t\t};\n\n\t\t\t\t$http({\n\t\t\t\t\tmethod : 'POST',\n\t\t\t\t\turl: '/portalapi/getByTags',\n\t\t\t\t\tdata: {\n\t\t\t\t\t\ttags: scope.data.data.tags\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t\t.success(function(data, status, headers, config){\n\t\t\t\t\tif (data && data.length > 0) {\n\t\t\t\t\t\tscope.model = [];\n\t\t\t\t\t   \tfor (var i = 0; i < data.length; ++i) {\n\t\t\t\t\t\t\tscope.model.push({\n\t\t\t\t\t\t\t\tid: data[i].id,\n\t\t\t\t\t\t\t\ttitle: findFirstOfType(data[i].data, 'title'),\n\t\t\t\t\t\t\t\tabstract: findFirstOfType(data[i].data, 'abstract'),\n\t\t\t\t\t\t\t\timg: findFirstOfType(data[i].data, 'image'),\n\t\t\t\t\t\t\t\timg1170: findFirstOfType(data[i].data, 'image1170'),\n\t\t\t\t\t\t\t\tvideo: findFirstOfType(data[i].data, 'video'),\n\t\t\t\t\t\t\t\tcontent: findFirstOfType(data[i].data, 'content')\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\tif (findFirstOfType(data[i].data, 'image1170')) {\n\t\t\t\t\t\t\t\telm.css('height', '570px');\n\t\t\t\t\t\t\t}\n\t\t\t\t\t   }\n\t\t\t\t\n\t\t\t\t\t\tconsole.log(scope.model);\n\t\t\t\t\t}\n\t\t\t\t}).error(function(err) {\n\t\t\t\t\tnotificationFactory.error(err);\n\t\t\t\t});\n\n\t\t\t\tscope.navigate = function(aid) {\n\t\t\t\t\t$location.path('/portal/edit/'+ aid);\n\t\t\t\t\t//$route.updateParams({id: aid});\n\t\t\t\t};\n\n\t\t\t\tlog.groupEnd();\n\t\t\t}\n\t\t};\n\t}]);\n\n}(window.angular));\n\n\n","(function(angular) {\n\t'use strict';\n\n\tangular.module('xpsui:directives')\n\t.directive('xpsuiPortalWidgetShowcasevideoEdit', ['xpsui:logging', '$compile', function(log, $compile) {\n\t\treturn {\n\t\t\trestrict: 'A',\n\t\t\tscope: {\n\t\t\t\tdata: '=xpsuiPortalWidgetShowcasevideoEdit',\n\t\t\t\tindex: '='\n\t\t\t},\n\t\t\trequire: ['^xpsuiPortalArticleContentEdit'],\n\t\t\tlink: function(scope, elm, attrs, ctrls) {\n\t\t\t\tlog.group('portal-widget-category-edit Link');\n\n\t\t\t\telm.empty();\n\t\t\t\telm.addClass('x-portal-widget-edit');\n\n\t\t\t\tvar titleBar = angular.element('<div class=\"xpsui-portal-widget-title-bar\">{{data.meta.type}}:{{data.meta.name}}<div class=\"pull-right\"><i class=\"action-button icon-chevron-up\" ng-click=\"moveUp();\"></i><i class=\"action-button icon-chevron-down\" ng-click=\"moveDown();\"></i><i class=\"action-button icon-trash\" ng-click=\"remove();\"></i></div></div>');\n\t\t\t\tvar content = angular.element(\n\t\t\t\t\t'<form class=\"form\">'\n\t\t\t\t\t+'<fieldset class=\"form-group\" style=\"background-color: black; padding: 10px;\" ng-show=\"mode !== \\'edit\\'\">'\n\t\t\t\t\t+'<div style=\"background-color: white; padding-top: 10px; padding-bottom: 10px;\">'\n\t\t\t\t\t+'<div class=\"form-group row\">'\n\t\t\t\t\t+' <label class=\"col-sm-2 control-label\">Tagy:</label>'\n\t\t\t\t\t+' <div class=\"col-sm-4\"><div class=\"input-group\"><div xpsui-portal-multistring-edit ng-model=\"data.data.tags\"></div></div></div>'\n\t\t\t\t\t+'</div>'\n\t\t\t\t\t+'<div class=\"form-group row\">'\n\t\t\t\t\t+' <label class=\"col-sm-2 control-label\">CSS Classes:</label>'\n\t\t\t\t\t+' <div class=\"col-sm-4\"><input ng-model=\"data.css.cssClass\"/></div>'\n\t\t\t\t\t+'</div>'\n\t\t\t\t\t+'</div>'\n\t\t\t\t\t+'</fieldset>'\n\t\t\t\t\t+'</form>');\n\n\n\t\t\t\telm.append(titleBar);\n\t\t\t\telm.append(content);\n\n\t\t\t\t$compile(titleBar)(scope);\n\t\t\t\t$compile(content)(scope);\n\n\t\t\t\tscope.moveUp = function() {\n\t\t\t\t\tctrls[0].moveUp(scope.index);\n\t\t\t\t};\n\n\t\t\t\tscope.moveDown = function() {\n\t\t\t\t\tctrls[0].moveDown(scope.index);\n\t\t\t\t};\n\n\t\t\t\tscope.remove = function() {\n\t\t\t\t\tctrls[0].remove(scope.index);\n\t\t\t\t};\n\n\t\t\t\tlog.groupEnd();\n\t\t\t}\n\t\t};\n\t}]);\n\n}(window.angular));\n\n\n","(function(angular) {\n\t'use strict';\n\n\tangular.module('xpsui:directives')\n\t.directive('xpsuiPortalWidgetShowcasevideoView', ['xpsui:logging', '$compile', '$http', '$sce', '$route', '$interval', '$location', function(log, $compile, $http, $sce, $route, $interval, $location) {\n\t\treturn {\n\t\t\trestrict: 'A',\n\t\t\tscope: {\n\t\t\t\tdata: '=xpsuiPortalWidgetShowcasevideoView'\n\t\t\t},\n\t\t\t// template: '<article ng-repeat=\"c in model\" ng-show=\"visibleIndex == $index\">'\n\t\t\t// \t//+ '<div ng-show=\"c.img.img\" style=\"background: url(\\'{{c.img.img}}\\'); background-repeat: no-repeat; background-size: cover; height: 492px; width: 100%;\"></div>'\n\t\t\t// \t+ '<iframe width=\"560\" height=\"315\" ng-src=\"{{ trustResource(c.video.src) }}\" frameborder=\"0\" allowfullscreen></iframe>'\n\t\t\t// \t+ '{{ trustResource(c.video.src) }}'\n\t\t\t// \t+ '<div class=\"x-portal-widget-showcasevideo-textblock\"><a ng-click=\"navigate(c.id)\" ng-bind-html=\"makeSafe(c.video.title)\"></a><div ng-bind-html=\"makeSafe(c.video.subTitle)\"></div></div></article>',\n\t\t\tlink: function(scope, elm, attrs, ctrls) {\n\t\t\t\tlog.group('portal-widget-category-view Link');\n\n\t\t\t\telm.addClass('x-portal-widget-showcasevideo');\n\n\t\t\t\tscope.model = [];\n\n\t\t\t\tscope.visibleIndex = 0;\n\n\t\t\t\telm.css('height', '492px');\n\n\t\t\t\t$interval(function() {\n\t\t\t\t\t++scope.visibleIndex;\n\t\t\t\t\tif (scope.visibleIndex >= scope.model.length) {\n\t\t\t\t\t\tscope.visibleIndex = 0;\n\t\t\t\t\t}\n\t\t\t\t}, 5000);\n\n\t\t\t\tfunction findFirstOfType(obj, type) {\n\t\t\t\t\tfor (var j = 0; j < obj.length; ++j) {\n\t\t\t\t\t\tif (obj[j].meta.name === type) {\n\t\t\t\t\t\t\treturn obj[j].data;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tscope.makeSafe = function(str) {\n\t\t\t\t\tif (typeof str === 'string') {\n\t\t\t\t\t\treturn $sce.trustAsHtml(str);\n\t\t\t\t\t}\n\n\t\t\t\t\treturn '';\n\t\t\t\t};\n\n\t\t\t\t$http({\n\t\t\t\t\tmethod : 'POST',\n\t\t\t\t\turl: '/portalapi/getByTags',\n\t\t\t\t\tdata: {\n\t\t\t\t\t\ttags: scope.data.data.tags\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t\t.success(function(data, status, headers, config){\n\t\t\t\t\tif (data && data.length > 0) {\n\t\t\t\t\t\tscope.model = [];\n\t\t\t\t\t   \tfor (var i = 0; i < data.length; ++i) {\n\t\t\t\t\t\t\tscope.model.push({\n\t\t\t\t\t\t\t\tid: data[i].id,\n\t\t\t\t\t\t\t\ttitle: findFirstOfType(data[i].data, 'title'),\n\t\t\t\t\t\t\t\tabstract: findFirstOfType(data[i].data, 'abstract'),\n\t\t\t\t\t\t\t\timg: findFirstOfType(data[i].data, 'image'),\n\t\t\t\t\t\t\t\tvideo: findFirstOfType(data[i].data, 'video'),\n\t\t\t\t\t\t\t\timg1170: findFirstOfType(data[i].data, 'image1170'),\n\t\t\t\t\t\t\t\tcontent: findFirstOfType(data[i].data, 'content')\n\t\t\t\t\t\t\t});\n\t\t\t\t\t   }\n\n\t\t\t\t\t   elm.empty();\n\t\t\t\t\t   elm.append('<div class=\"portal-content-title\"></div>');\n\t\t\t\t\t   for (var i = 0; i < scope.model.length; i++) {\n\t\t\t\t\t\t\tvar article = angular.element('<article ng-show=\"visibleIndex == ' + i + '\"></article>');\n\t\t\t\t\t   \t\tvar item = angular.element(\n\t\t\t\t\t   \t\t\t'<iframe width=\"560\" height=\"315\" src=\"' + scope.model[i].video.src + '\" frameborder=\"0\" allowfullscreen></iframe>'\n\t\t\t\t\t\t\t\t+ '<div class=\"x-portal-widget-showcasevideo-textblock\"><a ng-click=\"aler(10);navigate(\\'' + scope.model[i].id + '\\')\" >' + scope.model[i].video.title + '</a><div >' + scope.model[i].video.subTitle + '</div></div>');\n\t\t\t\t\t   \t\tarticle.append(item);\n\t\t\t\t\t   \t\telm.append(article);\n\t\t\t\t\t   \t\t$compile(article)(scope);\n\t\t\t\t\t   }\n\n\n\t\t\t\t\t   console.log(scope.model);\n\t\t\t\t\t}\n\t\t\t\t}).error(function(err) {\n\t\t\t\t\tnotificationFactory.error(err);\n\t\t\t\t});\n\n\t\t\t\tscope.navigate = function(aid) {\n\t\t\t\t\t$location.path('/portal/edit/'+ aid);\n\t\t\t\t\t//$route.updateParams({id: aid});\n\t\t\t\t};\n\n\t\t\t\tlog.groupEnd();\n\t\t\t}\n\t\t};\n\t}]);\n\n}(window.angular));\n\n\n","(function(angular) {\n\t'use strict';\n\n\tangular.module('xpsui:directives')\n\t.directive('xpsuiPortalWidgetVideoEdit', ['xpsui:logging', '$compile', function(log, $compile) {\n\t\treturn {\n\t\t\trestrict: 'A',\n\t\t\tscope: {\n\t\t\t\tdata: '=xpsuiPortalWidgetVideoEdit',\n\t\t\t\tindex: '='\n\t\t\t},\n\t\t\trequire: ['^xpsuiPortalArticleContentEdit'],\n\t\t\tlink: function(scope, elm, attrs, ctrls) {\n\t\t\t\tlog.group('portal-widget-video-edit Link');\n\n\t\t\t\telm.empty();\n\t\t\t\telm.addClass('x-portal-widget-edit');\n\n\t\t\t\tvar titleBar = angular.element('<div class=\"xpsui-portal-widget-title-bar\">{{data.meta.type}}:{{data.meta.name}}<div class=\"pull-right\"><i class=\"action-button icon-chevron-up\" ng-click=\"moveUp();\"></i><i class=\"action-button icon-chevron-down\" ng-click=\"moveDown();\"></i><i class=\"action-button icon-trash\" ng-click=\"remove();\"></i></div></div>');\n\t\t\t\tvar content = angular.element(\n\t\t\t\t\t\t'<form class=\"form\">'\n\t\t\t\t\t\t+'<fieldset class=\"form-group\" style=\"background-color: black; padding: 10px;\" ng-show=\"mode !== \\'edit\\'\">'\n\t\t\t\t\t\t+'<div style=\"background-color: white; padding-top: 10px; padding-bottom: 10px;\">'\n\t\t\t\t\t\t+' <div class=\"form-group row\">'\n\t\t\t\t\t\t+'  <label class=\"col-sm-2 control-label\">Video embed URL:</label>'\n\t\t\t\t\t\t+'  <div class=\"col-sm-4\"><div class=\"input-group\"><input ng-model=\"data.data.src\"/></div></div>'\n\t\t\t\t\t\t+' </div>'\n\t\t\t\t\t\t+' <div class=\"form-group row\">'\n\t\t\t\t\t\t+'  <label class=\"col-sm-2 control-label\">Title:</label>'\n\t\t\t\t\t\t+'  <div class=\"col-sm-4\"><div class=\"input-group\"><input ng-model=\"data.data.title\"/></div></div>'\n\t\t\t\t\t\t+' </div>'\n\t\t\t\t\t\t+' <div class=\"form-group row\">'\n\t\t\t\t\t\t+'  <label class=\"col-sm-2 control-label\">Subtitle:</label>'\n\t\t\t\t\t\t+'  <div class=\"col-sm-4\"><div class=\"input-group\"><input ng-model=\"data.data.subTitle\" /></div></div>'\n\t\t\t\t\t\t+' </div>'\n\t\t\t\t\t\t+' <div class=\"form-group row\">'\n\t\t\t\t\t\t+'  <label class=\"col-sm-2 control-label\">Text:</label>'\n\t\t\t\t\t\t+'  <div class=\"col-sm-4\"><div class=\"input-group\"><section class=\"content\" xpsui-contenteditable=\"true\" ng-model=\"data.data.text\"></section></div></div>'\n\t\t\t\t\t\t+' </div>'\n\t\t\t\t\t\t+'</div>'\n\t\t\t\t\t\t+'</fieldset>'\n\t\t\t\t\t\t+'</form>');\n\n\t\t\t\telm.append(titleBar);\n\t\t\t\telm.append(content);\n\n\t\t\t\t$compile(titleBar)(scope);\n\t\t\t\t$compile(content)(scope);\n\n\t\t\t\tscope.moveUp = function() {\n\t\t\t\t\tctrls[0].moveUp(scope.index);\n\t\t\t\t};\n\n\t\t\t\tscope.moveDown = function() {\n\t\t\t\t\tctrls[0].moveDown(scope.index);\n\t\t\t\t};\n\n\t\t\t\tscope.remove = function() {\n\t\t\t\t\tctrls[0].remove(scope.index);\n\t\t\t\t};\n\n\t\t\t\tlog.groupEnd();\n\t\t\t}\n\t\t};\n\t}]);\n\n}(window.angular));\n\n\n","(function(angular) {\n\t'use strict';\n\n\tangular.module('xpsui:directives')\n\t.directive('xpsuiPortalWidgetVideoView', ['xpsui:logging', '$compile', function(log, $compile) {\n\t\treturn {\n\t\t\trestrict: 'A',\n\t\t\tscope: {\n\t\t\t\tdata: '=xpsuiPortalWidgetVideoView'\n\t\t\t},\n\t\t\tlink: function(scope, elm, attrs, ctrls) {\n\t\t\t\tlog.group('portal-widget-video-view Link');\n\n\t\t\t\telm.empty();\n\t\t\t\telm.addClass('x-portal-widget-view');\n\n\t\t\t\tvar content = angular.element(\n\t\t\t\t\t\t'<div class=\"psui-wrapper\" style=\"text-align: center;\">'\n\t\t\t\t\t\t+ '  <iframe width=\"560\" height=\"315\" src=\"' + scope.data.data.src + '\" frameborder=\"0\" allowfullscreen></iframe>'\n\t\t\t\t\t\t+ '  <h3>{{data.data.title}}</h3>'\n\t\t\t\t\t\t+ '  <h3>{{data.data.subTitle}}</h3>'\n\t\t\t\t\t\t+ scope.data.data.text\n\t\t\t\t\t\t+ '</div>');\n\n\t\t\t\telm.append(content);\n\n\t\t\t\t$compile(content)(scope);\n\n\t\t\t\tlog.groupEnd();\n\t\t\t}\n\t\t};\n\t}]);\n\n}(window.angular));\n\n\n","(function(angular) {\n\t'use strict';\n\n\tangular.module('xpsui:directives')\n\t.directive('xpsuiRecordAction', ['xpsui:logging', 'xpsui:SchemaUtil', '$parse', '$injector', 'xpsui:NavigationService',\n\tfunction(log, schemaUtil, $parse, $injector, navS) {\n\t\treturn {\n\t\t\trestrict: 'A',\n\t\t\tlink: function(scope, elm, attrs, ctrls) {\n\t\t\t\tlog.group('Record Action');\n\n\t\t\t\tvar schemaParser = $parse(attrs.xpsuiSchema);\n\t\t\t\tvar modelParser = $parse(attrs.xpsuiModel);\n\n\t\t\t\t//TODO observe attributes and update parsers\n\n\t\t\t\telm.addClass('x-control');\n\t\t\t\telm.addClass('x-record-action');\n\n\t\t\t\telm.on('click', function(evt) {\n\t\t\t\t\tvar schemaFragment = schemaParser(scope);\n\t\t\t\t\tvar modelFragment = modelParser(scope);\n\t\t\t\t\n\t\t\t\t\tvar ctx = {\n\t\t\t\t\t\tschema: schemaFragment,\n\t\t\t\t\t\tmodel: modelFragment\n\t\t\t\t\t};\n\n\t\t\t\t\t$injector.invoke(['xpsui:NavigationService', \"$interpolate\", '$location', function(navS, $interpolate, $location) {\n\t\t\t\t\t\treturn function execute(ctx) {\n\t\t\t\t\t\t\tvar navPath = $interpolate(ctx.schema.params.path)(ctx);\n\t\t\t\t\t\t\tnavS.navigateToPath(navPath);\n\t\t\t\t\t\t\tattrs.$set('href', '/#' + navPath);\n\t\t\t\t\t   };\n\t\t\t\t\t}]) (ctx);\n\n\t\t\t\t\tscope.$apply();\n\t\t\t\t});\n\n\t\t\t\tlog.groupEnd();\n\t\t\t}\n\t\t};\n\t}]);\n\n}(window.angular));\n\n","(function(angular) {\n\t'use strict';\n\n\tangular.module('xpsui:directives')\n\t.directive('xpsuiRequired', ['xpsui:logging', 'xpsui:FormGenerator', '$compile', function(log, formGenerator, $compile) {\n\t\treturn {\n\t\t\trestrict: 'A',\n\t\t\tlink: function(scope, elm, attrs, ctrls) {\n\t\t\t\tlog.group('Required Link');\n\n\t\t\t\tvar modelPath = attrs.xpsuiModel;\n\t\t\t\tvar schemaPath = attrs.xpsuiSchema;\n\n\t\t\t\telm.addClass('x-inlineedit');\n\n\t\t\t\tif (modelPath && schemaPath) {\n\t\t\t\t} else {\n\t\t\t\t\tlog.warn('Attributes xpsui-model and xpsui-schema have to be set, skipping inlineedit generation');\n\t\t\t\t\tlog.groupEnd();\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tvar schema = scope.$eval(schemaPath);\n\t\t\t\tvar mode = attrs.xpsuiInlineedit;\n\n\t\t\t\tvar viewElm = formGenerator.generateField(schema, schemaPath, modelPath, formGenerator.MODE.VIEW);\n\t\t\t\tvar editElm = formGenerator.generateField(schema, schemaPath, modelPath, formGenerator.MODE.EDIT);\n\n\t\t\t\t$compile(viewElm)(scope);\n\t\t\t\t$compile(editElm)(scope);\n\t\t\t\telm.append(viewElm);\n\t\t\t\telm.append(editElm);\n\n\t\t\t\tlog.groupEnd();\n\t\t\t}\n\t\t};\n\t}]);\n\n}(window.angular));\n\n\n","(function(angular) {\n\t'use strict';\n\n\tangular.module('xpsui:directives')\n\t\t.directive('xpsuiSelectEdit', [\n\t\t\t'xpsui:logging',\n\t\t\t'$parse', \n\t\t\t'xpsui:DropdownFactory',\n\t\t\t'xpsui:SelectboxFactory',\n\t\t\t'xpsui:SelectDataFactory',\n\t\t\t'$timeout',\n\t\t\t'xpsui:RemoveButtonFactory',\n\t\tfunction(log, $parse, dropdownFactory, selectboxFactory, datafactory, $timeout, removeButtonFactory) {\n\t\treturn {\n\t\t\trestrict: 'A',\n\t\t\trequire: ['ngModel', '?^xpsuiFormControl', 'xpsuiSelectEdit'],\n\t\t\tcontroller: function($scope, $element, $attrs) {\n\t\t\t\tthis.setup = function(){\n\t\t\t\t\tthis.$input = angular.element('<input></input>');\n\t\t\t\t\t//this.$input = angular.element('<div tabindex=\"0\"></div>');\n\t\t\t\t\tthis.$input.addClass('x-input');\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tthis.getInput = function(){\n\t\t\t\t\treturn this.$input;\n\t\t\t\t}\n\n\t\t\t\tthis.$input = null;\n\t\t\t\tthis.setup();\n\t\t\t},\n\t\t\tlink: function(scope, elm, attrs, ctrls) {\n\t\t\t\tlog.group('Select edit Link');\n\n\t\t\t\tvar ngModel = ctrls[0];\n\t\t\t\tvar formControl = ctrls[1] || {};\n\t\t\t\tvar selfControl = ctrls[2];\n\t\t\t\tvar input = selfControl.getInput();\n\t\t\t\t//scope.$eval(attrs.xpsuiSchema)\n\t\t\t\tvar parseSchemaFragment = $parse(attrs.xpsuiSchema);\n\t\t\t\tvar schemaFragment = parseSchemaFragment(scope);\n\n\t\t\t\telm.addClass('x-control');\n\t\t\t\telm.addClass('x-select-edit');\n\n\t\t\t\telm.append(input);\n\n\t\t\t\tinput.on('change', function(evt) {\n\t\t\t\t\tscope.$apply(function() {\n\t\t\t\t\t\tngModel.$setViewValue(input.val());\n\t\t\t\t\t});\n\t\t\t\t});\n\n\t\t\t\telm.bind('focus', function(evt) {\n\t\t\t\t\tinput[0].focus();\n\t\t\t\t});\n\n\t\t\t\t// dropdown\n\t\t\t\tvar dropdown = dropdownFactory.create(elm,{\n\t\t\t\t\ttitleTransCode: schemaFragment.transCode\n\t\t\t\t});\n\t\t\t\t\n\t\t\t\tdropdown.setInput(selfControl.getInput())\n\t\t\t\t\t.render();\n\t\t\t\t\n\t\t\t\tvar removeButton = removeButtonFactory.create(elm,{\n\t\t\t\t\tenabled: !!!schemaFragment.required,\n\t\t\t\t\tinput: input,\n\t\t\t\t\tonClear: function(){\n\t\t\t\t\t\tinput.val('');\n\t\t\t\t\t\tscope.$apply(function() {\n\t\t\t\t\t\t\tngModel.$setViewValue('');\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\t// selectbox\n\t\t\t\tvar selectbox = selectboxFactory.create(elm, {\n\t\t\t\t\t// useSearchInput: false,\n\t\t\t\t\t// freeTextMode: true,\n\t\t\t\t\tonSelected: function(value){\n\t\t\t\t\t\tinput.val(value.v);\n\t\t\t\t\t\tscope.$apply(function() {\n\t\t\t\t\t\t\tngModel.$setViewValue(\n\t\t\t\t\t\t\t\tvalue.k ? value.k : value.v\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\tremoveButton.show();\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tselectbox.setInput(selfControl.getInput());\n\t\t\t\tselectbox.setDropdown(dropdown);\n\n\t\t\t\t// store\n\t\t\t\tvar dataset = datafactory.createArrayDataset(\n\t\t\t\t\tschemaFragment.enum, \n\t\t\t\t\tschemaFragment.enumTransCodes\n\t\t\t\t);\n\t\t\t\tselectbox.setDataset(dataset);\n\n\t\t\t\tngModel.$render = function() {\n\t\t\t\t\tinput.val(dataset.store.getValueByKey(ngModel.$viewValue) || ngModel.$viewValue || '');\n\t\t\t\t\tformControl.oldValue = ngModel.$modelValue;\n\t\t\t\t\t\n\t\t\t\t};\n\t\t\t\t\n\t\t\t\tfunction render(data) {\n\t\t\t\t\tinput.empty();\n\n\t\t\t\t\tif (data) {\n\t\t\t\t\t\t// get fields schema fragments\n\t\t\t\t\t\tschemaUtil.getFieldsSchemaFragment(\n\t\t\t\t\t\t\tschemaFragment.objectLink2.schema, \n\t\t\t\t\t\t\tschemaFragment.objectLink2.fields, \n\t\t\t\t\t\t\tfunction(fields) {\n\t\t\t\t\t\t\t\tobjectlink2Factory.renderElement(\n\t\t\t\t\t\t\t\t\tinput,\n\t\t\t\t\t\t\t\t\tfields,\n\t\t\t\t\t\t\t\t\tdata\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// input.on('keypress',function(){\n\t\t\t\t// \t$timeout(function(){\n\t\t\t\t// \t\tdropdown.open();\n\t\t\t\t// \t\tselectbox.actionFilter(input.val());\n\t\t\t\t// \t}, 300);\n\t\t\t\t// });\n\n\t\t\t\tlog.groupEnd();\n\t\t\t}\n\t\t};\n\t}]);\n\n}(window.angular));","(function(angular) {\r\n\t'use strict';\r\n\r\n\tangular.module('xpsui:directives')\r\n\t.directive('xpsuiSelectView', ['xpsui:logging','$translate','xpsui:SelectDataFactory', function(log, $translate, datafactory) {\r\n\t\treturn {\r\n\t\t\trestrict: 'A',\r\n\t\t\trequire: ['^ngModel'],\r\n\t\t\tlink: function(scope, elm, attrs, ctrls) {\r\n\t\t\t\tvar schemaFragment = null;\r\n\t\t\t\tvar data = [];\r\n\r\n\t\t\t\telm.addClass('x-select-view');\r\n\r\n\t\t\t\tif (attrs.xpsuiSchema) {\r\n\t\t\t\t\tschemaFragment = scope.$eval(attrs.xpsuiSchema);\r\n\r\n\t\t\t\t\t// store\r\n\t\t\t\t\tvar dataset = datafactory.createArrayDataset(\r\n\t\t\t\t\t\tschemaFragment.enum, \r\n\t\t\t\t\t\tschemaFragment.enumTransCodes\r\n\t\t\t\t\t);\r\n\t\t\t\t\t\r\n\r\n\t\t\t\t\tif (!schemaFragment.enum) {\r\n\t\t\t\t\t\tthrow \"Schema fragment does not contain enum field\";\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tvar ngModel = ctrls[0];\r\n\r\n\t\t\t\tngModel.$render = function() {\r\n\t\t\t\t\tif (ngModel.$viewValue) {\r\n\t\t\t\t\t\telm.text(dataset.store.getValueByKey(ngModel.$viewValue) || ngModel.$viewValue || '');\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\telm.text('');\r\n\t\t\t\t\t}\r\n\t\t\t\t};\r\n\t\t\t}\r\n\t\t};\r\n\t}]);\r\n\r\n}(window.angular));","(function(angular) {\n\t'use strict';\n\n\tangular.module('xpsui:directives')\n\t.directive('xpsuiStringEdit', ['xpsui:logging', function(log) {\n\t\treturn {\n\t\t\trestrict: 'A',\n\t\t\trequire: ['ngModel', '?^xpsuiFormControl','xpsuiStringEdit'],\n\t\t\tcontroller: function($scope, $element, $attrs) {\n\t\t\t\tthis.setup = function(){\n\t\t\t\t\tthis.$input = angular.element('<input></input>');\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tthis.getInput = function(){\n\t\t\t\t\treturn this.$input;\n\t\t\t\t}\n\n\t\t\t\tthis.$input = null;\n\t\t\t\tthis.setup();\n\t\t\t\t\n\t\t\t},\n\t\t\tlink: function(scope, elm, attrs, ctrls) {\n\t\t\t\tlog.group('String edit Link');\n\n\t\t\t\tvar ngModel = ctrls[0];\n\t\t\t\tvar formControl = ctrls[1] || {};\n\t\t\t\tvar selfControl = ctrls[2] || {};\n\n\t\t\t\tvar input = selfControl.getInput();\n\n\t\t\t\telm.addClass('x-control');\n\t\t\t\telm.addClass('x-string-edit');\n\n\t\t\t\tngModel.$render = function() {\n\t\t\t\t\tinput.val(ngModel.$viewValue || '');\n\t\t\t\t\tformControl.oldValue = ngModel.$modelValue;\n\t\t\t\t};\n\n\t\t\t\telm.append(input);\n\n\t\t\t\tinput.on('keyup', function(evt) {\n\t\t\t\t\tscope.$apply(function() {\n\t\t\t\t\t\tngModel.$setViewValue(input.val());\n\t\t\t\t\t});\n\t\t\t\t});\n\n\t\t\t\telm.bind('focus', function(evt) {\n\t\t\t\t\tinput[0].focus();\n\t\t\t\t});\n\n\t\t\t\tlog.groupEnd();\n\t\t\t}\n\t\t};\n\t}]);\n\n}(window.angular));\n\n","(function(angular) {\n\t'use strict';\n\n\tangular.module('xpsui:directives')\n\t.directive('xpsuiStringView', ['xpsui:logging', function(log) {\n\t\treturn {\n\t\t\trestrict: 'A',\n\t\t\trequire: ['ngModel'],\n\t\t\tlink: function(scope, elm, attrs, ctrls) {\n\t\t\t\tlog.group('String view Link');\n\n\t\t\t\tvar ngModel = ctrls[0];\n\t\t\t\tvar view = angular.element('<div></div>');\n\n\t\t\t\telm.addClass('x-control');\n\t\t\t\telm.addClass('x-string-view');\n\n\t\t\t\tngModel.$render = function() {\n\t\t\t\t\tif (ngModel && ngModel.$viewValue || ngModel.$viewValue===0 ) {\n\t\t\t\t\t\tif (isNaN(ngModel.$viewValue) && ngModel.$viewValue.replace){\n\t\t\t\t\t\t\tview.html(ngModel.$viewValue.replace(/(?:\\r\\n|\\r|\\n)/g, '<br />'));\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse {\n\t\t\t\t\t\t\tview.html(ngModel.$viewValue);\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tview.text(' ');\n\t\t\t\t\t}\n\t\t\t\t};\n\n\t\t\t\telm.append(view);\n\t\t\t\tlog.groupEnd();\n\t\t\t}\n\t\t};\n\t}]);\n\n}(window.angular));\n","(function(angular) {\n\t'use strict';\n\n\tangular.module('xpsui:directives')\n\t.directive('xpsuiTextareaEdit', ['xpsui:logging', function(log) {\n\t\treturn {\n\t\t\trestrict: 'A',\n\t\t\trequire: ['ngModel', '?^xpsuiFormControl','xpsuiTextareaEdit'],\n\t\t\tcontroller: function($scope, $element, $attrs) {\n\n\t\t\t\tthis.setup = function(){\n\t\t\t\t\tthis.$input = angular.element('<textarea></textarea>');\n\t\t\t\t}\n\n\t\t\t\tthis.getInput = function(){\n\t\t\t\t\treturn this.$input;\n\t\t\t\t}\n\n\t\t\t\tthis.$input = null;\n\t\t\t\tthis.setup();\n\n\t\t\t},\n\t\t\tlink: function(scope, elm, attrs, ctrls) {\n\t\t\t\tlog.group('String edit Link');\n\n\t\t\t\tvar ngModel = ctrls[0];\n\t\t\t\tvar formControl = ctrls[1] || {};\n\t\t\t\tvar selfControl = ctrls[2] || {};\n\n\t\t\t\tvar input = selfControl.getInput();\n\n\t\t\t\telm.addClass('x-control');\n\t\t\t\telm.addClass('x-string-edit');\n\n\t\t\t\tngModel.$render = function() {\n\t\t\t\t\tinput.val(ngModel.$viewValue || '');\n\t\t\t\t\tformControl.oldValue = ngModel.$modelValue;\n\t\t\t\t};\n\n\t\t\t\telm.append(input);\n\n\t\t\t\tinput.on('change', function(evt) {\n\t\t\t\t\tscope.$apply(function() {\n\t\t\t\t\t\tngModel.$setViewValue(input.val());\n\t\t\t\t\t});\n\t\t\t\t});\n\n\t\t\t\telm.bind('focus', function(evt) {\n\t\t\t\t\tinput[0].focus();\n\t\t\t\t});\n\n\t\t\t\tlog.groupEnd();\n\t\t\t}\n\t\t};\n\t}]);\n\n}(window.angular));\n","(function(angular) {\n\t'use strict';\n\n\tangular.module('xpsui:directives')\n\t.directive('xpsuiTextareaEdit', ['xpsui:logging', function(log) {\n\t\treturn {\n\t\t\trestrict: 'A',\n\t\t\trequire: ['ngModel'],\n\t\t\tlink: function(scope, elm, attrs, ctrls) {\n\t\t\t\tlog.group('String view Link');\n\n\t\t\t\tvar ngModel = ctrls[0];\n\t\t\t\tvar view = angular.element('<div></div>');\n\n\t\t\t\telm.addClass('x-control');\n\t\t\t\telm.addClass('x-string-view');\n\n\t\t\t\tngModel.$render = function() {\n\t\t\t\t\tif (ngModel.$viewValue) {\n\t\t\t\t\t\tview.html(ngModel.$viewValue.replace(/(?:\\r\\n|\\r|\\n)/g, '<br />'));\n\t\t\t\t\t} else {\n\t\t\t\t\t\tview.text(' ');\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t};\n\n\t\t\t\telm.append(view);\n\t\t\t\tlog.groupEnd();\n\t\t\t}\n\t\t};\n\t}]);\n\n}(window.angular));\n","(function(angular) {\n\t'use strict';\n\n\tangular.module('xpsui:directives')\n\t.directive('xpsuiUnique', ['$http', 'xpsui:SchemaUtil', 'xpsui:QueryFilter', function($http, schemaUtilFactory, QueryFilter) {\n\t\tvar latestId = 0;\n\n\t\treturn {\n\t\t\trestrict: 'A',\n\t\t\trequire: ['?ngModel'],\n\t\t\tlink: function(scope, element, attrs, controllers) {\n\t\t\t\tvar ngModel = controllers[0];\n\n\t\t\t\tvar options = scope.$eval(attrs.xpsuiUnique);\n\t\t\t\tif (ngModel) {\n\t\t\t\t\tngModel.$parsers.push(\n\t\t\t\t\t\tfunction(value) {\n\t\t\t\t\t\t\t//var selfId = scope.$eval(attrs.psuiUniqueId);\n\t\t\t\t\t\t\tvar qf = QueryFilter.create().addCriterium(\n\t\t\t\t\t\t\t\t\toptions.field,\n\t\t\t\t\t\t\t\t\tQueryFilter.operation.EQUAL,\n\t\t\t\t\t\t\t\t\tvalue\n\t\t\t\t\t\t\t).setLimit(1);\n\t\t\t\t\t\t\tvar conf = {\n\t\t\t\t\t\t\t\tmethod : 'POST',\n\t\t\t\t\t\t\t\turl : '/search/' + schemaUtilFactory.encodeUri(schemaUtilFactory.concatUri(options.schema,'search')),\n\t\t\t\t\t\t\t\tdata : qf\n\t\t\t\t\t\t\t};\n\n\t\t\t\t\t\t\tfunction containEqualId(ngModelStr, id){\n\t\t\t\t\t\t\t\tvar model = scope.$eval(ngModelStr);\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\tif(typeof model === 'object' && model.id && id === model.id){\n\t\t\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\tvar pos = ngModelStr.lastIndexOf(\".\");\n\t\t\t\t\t\t\t\tif(pos !== -1){\n\t\t\t\t\t\t\t\t\treturn containEqualId(ngModelStr.substr(0,pos), id);\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t\t}\n\n\n\t\t\t\t\t\t\tfunction factory(ver) {\n\t\t\t\t\t\t\t\treturn function(data) {\n\t\t\t\t\t\t\t\t\t\tif (ver !== latestId) {\n\t\t\t\t\t\t\t\t\t\t\t// another validation in progress\n\t\t\t\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\t\tif (data.data && data.data.length && data.data.length > 0 && !containEqualId(attrs.ngModel, data.data[0].id)) {\n\t\t\t\t\t\t\t\t\t\t\tngModel.$setValidity('psuiUnique', false);\n\t\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\t\tngModel.$setValidity('psuiUnique', true);\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t$http(conf).then(factory(++latestId));\n\n\t\t\t\t\t\t\treturn value;\n\t\t\t\t\t\t}\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t}]);\n}(window.angular));\n","(function(angular) {\r\n\t'use strict';\r\n\r\n\tvar contentTypes = {\r\n\t\t'.pdf': 'application/pdf',\r\n\t\t'.xls': 'application/vnd.ms-excel',\r\n\t\t'.doc': 'application/msword',\r\n\t\t'.docx': 'application/vnd.openxmlformats-officedocument.wordprocessingml.document',\r\n\t\t'.ppt': 'application/vnd.ms-powerpoint',\r\n\t\t'.odt': 'application/vnd.oasis.opendocument.text',\r\n\t\t'.bin': 'application/octet-stream',\r\n\t\t'.bmp': 'image/bmp',\r\n\t\t'.jpg': 'image/jpeg',\r\n\t\t'.jpeg': 'image/jpeg',\r\n\t\t'.png': 'image/png',\r\n\t\t'.csv':'text/csv',\r\n\t\t'.zip':'application/zip'\r\n\t};\r\n\r\n\tfunction getContentType(fileName){\r\n\t\tvar ext = fileName.substring(fileName.lastIndexOf('.'));\r\n\t\treturn contentTypes[ext? ext.toLowerCase():\"application/binary\"];\r\n\t}\r\n\r\n\tangular.module('xpsui:directives')\r\n\t.directive('xpsuiUploadableFile', ['xpsui:FileUploadFactory','xpsui:NotificationFactory','$compile', '$translate', function(psFileUploadFactory,notificationFactory,$compile,$translate) {\r\n\t\treturn {\r\n\t\t\trestrict: 'A',\r\n\t\t\trequire: ['?ngModel', 'xpsuiUploadableFile'],\r\n\t\t\tscope: true,\r\n\t\t\tcontroller: function() {\r\n\t\t\t\t\tthis.srcElm = null,\r\n\t\t\t\t\tthis.imageProcessed = function(blob) {}\r\n\t\t\t},\r\n\t\t\tlink: function(scope, elm, attrs, ctrls) {\r\n\t\t\t\tvar fileButton = angular.element('<input type=\"file\" style=\"display: none;\"></input>');\r\n\t\t\t\tvar chooseFileButton = angular.element(\r\n\t\t\t\t\t\t'<button class=\"btn-primary\">'\r\n\t\t\t\t\t\t+ '<icon class=\"icon-open\"></icon> ' + $translate.instant('generic.file.choose')\r\n\t\t\t\t\t\t+ '</button>');\r\n\t\t\t\tvar imgLink = '';\r\n\t\t\t\t// elm.addClass('xpsui-uploadable-file');\r\n\r\n\t\t\t\telm.append(fileButton);\r\n\t\t\t\telm.append(chooseFileButton);\r\n\r\n\t\t\t\tchooseFileButton.on('click', function (evt) {\r\n\t\t\t\t\tfileButton[0].files[0] = '';\r\n\t\t\t\t\tfileButton[0].value = '';\r\n\t\t\t\t\tfileButton[0].click();\r\n\t\t\t\t});\r\n\r\n\t\t\t\tvar commit = function() {\r\n\t\t\t\t};\r\n\r\n\t\t\t\tvar imgCtrl = ctrls[1];\r\n\t\t\t\tfileButton.on('change', function(evt) {\r\n\t\t\t\t\tvar file = fileButton[0].files[0];\r\n\r\n\r\n\t\t\t\t\tif (file) {\r\n\t\t\t\t\t\t\tif (imgCtrl && imgCtrl.srcElm) {\r\n\t\t\t\t\t\t\t\tvar urlObject;\r\n\t\t\t\t\t\t\t\tif (typeof webkitURL !== 'undefined') {\r\n\t\t\t\t\t\t\t\turlObject = webkitURL;\r\n\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\turlObject = URL;\r\n\t\t\t\t\t\t\t\t};\r\n\t\t\t\t\t\t\t\timgCtrl.srcElm.src = urlObject.createObjectURL(file);\r\n\t\t\t\t\t\t\t\timgCtrl.imageProcessed = function(blob) {\r\n\t\t\t\t\t\t\t\t\tvar uploader = new psFileUploadFactory.FileUploader(scope, blob, getContentType(file.name), '/uploads/putgetpath/');\r\n\t\t\t\t\t\t\t\t\tuploader.upload(function(err, path) {\r\n\t\t\t\t\t\t\t\t\t\tif (err) {\r\n\t\t\t\t\t\t\t\t\t\t\tnotificationFactory.error($translate.instant('generic.file.uploadFailed'));\r\n\t\t\t\t\t\t\t\t\t\t\t//return true;\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t\t\telm.css('background-image', 'url(/photos/get/' + path+')');\r\n\r\n\t\t\t\t\t\t\t\t\t\tcommit({fileId: path,fileName:file.name,size:file.size,contentType:getContentType(file.name)});\r\n\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tvar uploader = new psFileUploadFactory.FileUploader(scope, file, getContentType(file.name), '/uploads/putgetpath/');\r\n\t\t\t\t\t\t\t\tuploader.upload(function(err, path) {\r\n\t\t\t\t\t\t\t\t\tif (err) {\r\n\t\t\t\t\t\t\t\t\t\tnotificationFactory.error($translate.instant('generic.file.uploadFailed'));\r\n\t\t\t\t\t\t\t\t\t\tscope.$apply( function() { });\r\n\t\t\t\t\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t\t// elm.css('background-image', 'url(/photos/get/' + path+')');\r\n\t\t\t\t\t\t\t\t\tcommit({fileId: path,fileName:file.name,size:file.size,contentType:getContentType(file.name)});\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t// if (file.type !== 'image/jpeg') {\r\n\t\t\t\t\t\t// \t//TODO do something clever\r\n\t\t\t\t\t\t// \tnotificationFactory.error({translationCode:'psui.uploadable.image.unsupported.image.type'});\r\n\t\t\t\t\t\t// } else {\r\n\t\t\t\t\t\t// }\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\r\n\t\t\t\tfunction getReadableFileSizeString(fileSizeInBytes) {\r\n\r\n\t\t\t\t\tvar i = -1;\r\n\t\t\t\t\tvar byteUnits = [' kB', ' MB', ' GB', ' TB', 'PB', 'EB', 'ZB', 'YB'];\r\n\t\t\t\t\tdo {\r\n\t\t\t\t\t\tfileSizeInBytes = fileSizeInBytes / 1024;\r\n\t\t\t\t\t\ti++;\r\n\t\t\t\t\t} while (fileSizeInBytes > 1024);\r\n\r\n\t\t\t\t\treturn Math.max(fileSizeInBytes, 0.1).toFixed(1) + byteUnits[i];\r\n\t\t\t\t}\r\n\r\n\t\t\t\tvar ngModel = ctrls[0];\r\n\t\t\t\tif (ngModel) {\r\n\t\t\t\t\tngModel.$render = function() {\r\n\t\t\t\t\t\t\tif (ngModel.$viewValue && ngModel.$viewValue.fileName) {\r\n\t\t\t\t\t\t\t\telm.html(\r\n\t\t\t\t\t\t\t\t\t\t'<div class=\"psui-attachment-name\">'\r\n\t\t\t\t\t\t\t\t\t\t+ ' <a href=\"/uploads/get/' + ngModel.$viewValue.fileId + '\" target=\"_blank\" '\r\n\t\t\t\t\t\t\t\t\t\t+ '        class=\"psui-attachment-link fa fa-save\" download=\"' + ngModel.$viewValue.fileName + '\">'\r\n\t\t\t\t\t\t\t\t\t\t+ ' ' + ngModel.$viewValue.fileName + '</a>'\r\n\t\t\t\t\t\t\t\t\t\t+ ' <span>' + ngModel.$viewValue.fileName + '</span>'\r\n\t\t\t\t\t\t\t\t\t\t+ ' <em>(' + getReadableFileSizeString(ngModel.$viewValue.size) + ')</em>'\r\n\t\t\t\t\t\t\t\t\t\t+ '</div>'\r\n\t\t\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t\t$compile(elm.contents())(scope);\r\n\t\t\t\t\t\t\t\telm.find('a').on('click', function(evt) {\r\n\t\t\t\t\t\t\t\t\tevt.stopPropagation();\r\n\t\t\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t};\r\n\r\n\t\t\t\t\tcommit = function(val) {\r\n\t\t\t\t\t\tscope.$apply( function() {\r\n\t\t\t\t\t\t\tngModel.$setViewValue(val);\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t};\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}]);\r\n\r\n}(window.angular));\r\n","(function(angular) {\n\t'use strict';\n\n\tangular.module('xpsui:directives')\n\t.directive('xpsuiUploadableImageView', ['xpsui:NotificationFactory', function(notificationFactory) {\n\t\treturn {\n\t\t\trestrict: 'A',\n\t\t\trequire: ['?ngModel'],\n\t\t\tscope: true,\n\t\t\tcontroller: function() {\n\t\t\t},\n\t\t\tlink: function(scope, elm, attrs, ctrls) {\n\t\t\t\tvar imgWidth = attrs.psuiWidth || 0;\n\t\t\t\tvar imgHeight = attrs.psuiHeight || 0;\n\n\t\t\t\telm.attr('style', \n\t\t\t\t\t(imgHeight ? 'height:'+imgHeight+'px !important;':'')\n\t\t\t\t);\n\n\t\t\t\telm.addClass('xpsui-uploadable-image-view');\n\n\t\t\t\tvar ngModel = ctrls[0];\n\t\t\t\tif (ngModel) {\n\t\t\t\t\tngModel.$render = function() {\n\t\t\t\t\t\telm.css('background-image', 'url('+(ngModel.$viewValue || 'img/no_photo.jpg')+')');\n\t\t\t\t\t};\n\n\t\t\t\t}\n\t\t\t\t\n\t\t\t}\n\t\t}\n\t}]);\n\n}(window.angular));","(function(angular) {\r\n\t'use strict';\r\n\r\n\tangular.module('xpsui:directives')\r\n\t.directive('xpsuiUploadableImage', ['xpsui:FileUploadFactory','xpsui:NotificationFactory', function(psFileUploadFactory,notificationFactory) {\r\n\t\treturn {\r\n\t\t\trestrict: 'A',\r\n\t\t\trequire: ['?ngModel', 'xpsuiUploadableImage'],\r\n\t\t\tscope: true,\r\n\t\t\tcontroller: function() {\r\n\t\t\t\t\tthis.srcElm = null,\r\n\t\t\t\t\tthis.imageProcessed = function(blob) {}\r\n\t\t\t},\r\n\t\t\tlink: function(scope, elm, attrs, ctrls) {\r\n\t\t\t\tvar fileButton = angular.element('<input type=\"file\"></input>');\r\n\t\t\t\tvar imgLink = '';\r\n\t\t\t\tvar imgWidth = attrs.psuiWidth || 0;\r\n\t\t\t\tvar imgHeight = attrs.psuiHeight || 0;\r\n\r\n\t\t\t\tif (!attrs.hasOwnProperty('style')) {\r\n\t\t\t\t\telm.attr('style', \r\n\t\t\t\t\t\t\t(imgHeight ? 'height:'+imgHeight+'px !important;':'')\r\n\t\t\t\t\t\t);\r\n\t\t\t\t}\r\n\r\n\r\n\t\t\t\telm.addClass('xpsui-uploadable-image');\r\n\t\t\t\t\r\n\t\t\t\telm.append(fileButton);\r\n\t\t\t\tfileButton.addClass('xpsui-uploadable-image-fbutton');\r\n\r\n\t\t\t\telm.on('click', function(evt) {\r\n\t\t\t\t\tfileButton[0].files[0] = '';\r\n\t\t\t\t\tfileButton[0].value = '';\r\n\t\t\t\t\tfileButton[0].click();\r\n\t\t\t\t});\r\n\t\t\t\t\r\n\t\t\t\tvar commit = function() {\r\n\t\t\t\t};\r\n\r\n\t\t\t\tvar imgCtrl = ctrls[1];\r\n\t\t\t\tfileButton.on('change', function(evt) {\r\n\t\t\t\t\tvar file = fileButton[0].files[0];\r\n\r\n\t\t\t\t\tif (file) {\r\n\t\t\t\t\t\tif (file.type !== 'image/jpeg') {\r\n\t\t\t\t\t\t\t//TODO do something clever\r\n\t\t\t\t\t\t\tnotificationFactory.error({translationCode:'psui.uploadable.image.unsupported.image.type'});\r\n\t\t\t\t\t\t\tscope.$apply(function () {});\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tif (imgCtrl && imgCtrl.srcElm) {\r\n\t\t\t\t\t\t\t\tvar urlObject;\r\n\t\t\t\t\t\t\t   \tif (typeof webkitURL !== 'undefined') {\r\n\t\t\t\t\t\t\t\t   urlObject = webkitURL;\r\n\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\turlObject = URL;\r\n\t\t\t\t\t\t\t\t};\r\n\t\t\t\t\t\t\t\timgCtrl.srcElm.src = urlObject.createObjectURL(file);\r\n\t\t\t\t\t\t\t\timgCtrl.imageProcessed = function(blob) {\r\n\t\t\t\t\t\t\t\t\tvar uploader = new psFileUploadFactory.FileUploader(scope, blob, 'image/jpeg', '/photos/putgetpath/');\r\n\t\t\t\t\t\t\t\t\tuploader.upload(function(err, path) {\r\n\t\t\t\t\t\t\t\t\t\tif (err) {\r\n\t\t\t\t\t\t\t\t\t\t\tnotificationFactory.error(err);\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t\t\telm.css('background-image', 'url(/photos/get/' + path+')');\r\n\t\t\t\t\t\t\t\t\t\tcommit('/photos/get/' + path);\r\n\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tvar uploader = new psFileUploadFactory.FileUploader(scope, file, file.type, '/photos/putgetpath/');\r\n\t\t\t\t\t\t\t\tuploader.upload(function(err, path) {\r\n\t\t\t\t\t\t\t\t\tif (err) {\r\n\t\t\t\t\t\t\t\t\t\tnotificationFactory.error(err);\r\n\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t\telm.css('background-image', 'url(/photos/get/' + path+')');\r\n\t\t\t\t\t\t\t\t\tcommit('/photos/get/' + path);\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\r\n\t\t\t\tvar ngModel = ctrls[0];\r\n\t\t\t\tif (ngModel) {\r\n\t\t\t\t\tngModel.$render = function() {\r\n\t\t\t\t\t\telm.css('background-image', 'url('+(ngModel.$viewValue || 'img/no_photo.jpg')+')');\r\n\t\t\t\t\t};\r\n\r\n\t\t\t\t\tcommit = function(val) {\r\n\t\t\t\t\t\tscope.$apply( function() {\r\n\t\t\t\t\t\t\tngModel.$setViewValue(val);\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t};\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// if (attrs.xpsuiSchema) {\r\n\t\t\t\t// \tvar schema = scope.$eval(attrs.xpsuiSchema);\r\n\t\t\t\t// }\r\n\t\t\t\t\r\n\t\t\t}\r\n\t\t}\r\n\t}]);\r\n\r\n}(window.angular));","(function(angular) {\r\n\t'use strict';\r\n\r\n\tangular.module('xpsui:directives')\r\n\t.directive('xpsuiValidityMark', ['$compile', function($compile) {\r\n\t\treturn {\r\n\t\t\trestrict: 'A',\r\n\t\t\trequire: ['^ngModel', '^form','^?xpsuiInlineedit'],\r\n\t\t\tlink: function(scope, elm, attrs, controller) {\r\n\t\t\t\tvar wrapper = elm;\r\n\r\n\t\t\t\tvar ngModel = null;\r\n\t\t\t\tif (controller[0]) {\r\n\t\t\t\t\tngModel = controller[0];\r\n\t\t\t\t}\r\n\t\t\t\tvar inlineEditCtrl = controller[2];\r\n\r\n\t\t\t\tvar validationMark = angular.element('<span class=\"xpsui-btn xpsui-validation-mark\"><i></i><span>error</span></span>');\r\n\t\t\t\tvalidationMark.addClass('x-hidden');\r\n\r\n\t\t\t\twrapper.prepend(validationMark);\r\n\r\n\t\t\t\tvar errors = angular.element('<div class=\"xpsui-errors\"><div>');\r\n\t\t\t\terrors.addClass('x-hidden');\r\n\t\t\t\tvalidationMark.append(errors);\r\n\t\t\t\tvalidationMark.on('mouseover', function(evt) {\r\n\t\t\t\t\terrors.removeClass('x-hidden');\r\n\t\t\t\t});\r\n\t\t\t\tvalidationMark.on('mouseleave', function(evt) {\r\n\t\t\t\t\terrors.addClass('x-hidden');\r\n\t\t\t\t});\r\n\r\n\t\t\t\tvalidationMark.on('touchstart',function(evt){\r\n\t\t\t\t\terrors.removeClass('x-hidden')\r\n\t\t\t\t\tevt.preventDefault();\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t})\r\n\t\t\t\t\r\n\t\t\t\tvalidationMark.on('touchend',function(evt){\r\n\t\t\t\t\terrors.addClass('x-hidden');\r\n\t\t\t\t\tevt.preventDefault();\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t})\r\n\r\n\r\n\t\t\t\tif (ngModel) {\r\n\t\t\t\t\tscope.$watch(function(scope) {return ngModel.$invalid;}, function(nv, ov) {\r\n\t\t\t\t\t\tif (nv) {\r\n\t\t\t\t\t\t\tvalidationMark.addClass('ng-invalid');\r\n\t\t\t\t\t\t\tvalidationMark.removeClass('x-hidden');\r\n\t\t\t\t\t\t\tinlineEditCtrl && inlineEditCtrl.hideCommitButton();\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tvalidationMark.removeClass('ng-invalid');\r\n\t\t\t\t\t\t\tvalidationMark.addClass('x-hidden');\r\n\t\t\t\t\t\t\tinlineEditCtrl && inlineEditCtrl.showCommitButton();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t\tscope.$watch(function(scope) {return ngModel.$pristine;}, function(nv, ov) {\r\n\t\t\t\t\t\tif (nv) {\r\n\t\t\t\t\t\t\tvalidationMark.addClass('ng-pristine');\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tvalidationMark.removeClass('ng-pristine');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t\tscope.$watchCollection(function(scope) {return ngModel.$error;}, function(nv, ov) {\r\n\t\t\t\t\t\tvar e;\r\n\t\t\t\t\t\terrors.empty();\r\n\t\t\t\t\t\tfor (e in nv) {\r\n\t\t\t\t\t\t\tif (nv[e]) {\r\n\t\t\t\t\t\t\t\terrors.append('<div class=\"xpsui-error\">{{\\'errors.validation.'+e+'\\'|translate}}</div>');\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t$compile(errors)(scope);\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (controller[1]) {\r\n\t\t\t\t\tvar form = controller[1];\r\n\r\n\t\t\t\t\tscope.$watch(function() {return form.xpsui.submitPrepare}, function(newVal) {\r\n\t\t\t\t\t\tif (newVal === true) {\r\n\t\t\t\t\t\t\tvar ngVal = ngModel.$modelValue;\r\n\t\t\t\t\t\t\tif (angular.isObject(ngVal) && Object.getOwnPropertyNames(ngVal).length == 0) {\r\n\t\t\t\t\t\t\t\tngModel.$setViewValue(\"\");\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tngModel.$setViewValue(ngModel.$modelValue);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\t\t}\r\n\t}]);\r\n\r\n}(window.angular));\r\n","(function(angular) {\r\n\t'use strict';\r\n\t\r\n\tangular.module('xpsui:directives')\r\n\t.directive('xpsuiPortalMultistringEdit',['xpsui:logging','$parse', \r\n\t\t'xpsui:DropdownFactory', 'xpsui:SelectboxFactory','xpsui:SelectDataFactory',\r\n\t\tfunction(log, $parse, dropdownFactory, selectboxFactory, datafactory) {\r\n\t\treturn {\r\n\t\t\trestrict: 'A',\r\n\t\t\trequire: ['ngModel'],\r\n\t\t\tlink: function(scope, elm, attrs, ctrls) {\r\n\t\t\t\tvar ngModel = ctrls[0];\r\n\r\n\t\t\t\telm.addClass('portal-multistring-edit');\r\n\r\n\t\t\t\tvar container = angular.element('<div></div>');\r\n\t\t\t\tvar input = angular.element('<input></input>');\r\n\t\t\t\tvar addButton = angular.element('<button class=\"btn btn-primary\">Pridať</button>');\r\n\r\n\t\t\t\telm.addClass('portal-multistring-edit');\r\n\r\n\t\t\t\tngModel.$render = function() {\r\n\t\t\t\t\tvar i, xButton, stringElm;\r\n\r\n\t\t\t\t\tcontainer.empty();\r\n\t\t\t\t\tfor (i in ngModel.$modelValue) {\r\n\t\t\t\t\t\tstringElm = angular.element('<div class=\"portal-multistring-element\"><span>'+ngModel.$modelValue[i]+'</span></div>');\r\n\t\t\t\t\t\txButton = angular.element('<i class=\"icon-remove\"></i>');\r\n\t\t\t\t\t\txButton.data('idx', i);\r\n\r\n\t\t\t\t\t\txButton.on('click', function(evt) {\r\n\t\t\t\t\t\tscope.$apply(function() {\r\n\t\t\t\t\t\t\tngModel.$modelValue.splice(angular.element(evt.target).data('idx'), 1);\r\n\t\t\t\t\t\t\tngModel.$render();\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tstringElm.append(xButton);\r\n\t\t\t\t\t\tcontainer.append(stringElm);\r\n\t\t\t\t\t}\r\n\t\t\t\t};\r\n\r\n\t\t\t\telm.append(container);\r\n\t\t\t\telm.append(input);\r\n\t\t\t\telm.append(addButton);\r\n\r\n\t\t\t\tinput.on('change', function(evt) {\r\n\t\t\t\t\tscope.$apply(function() {\r\n\t\t\t\t\t\tngModel.$modelValue.push(input.val());\r\n\t\t\t\t\t\tngModel.$render();\r\n\t\t\t\t\t\tinput.val('');\r\n\t\t\t\t\t});\r\n\t\t\t\t});\r\n\r\n\t\t\t\telm.bind('focus', function(evt) {\r\n\t\t\t\t\tinput[0].focus();\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t};\r\n\t}]);\r\n}(window.angular));","(function(angular) {\n\t'use strict';\n\n\tangular.module('xpsui:controllers', ['xpsui:services']);\n}(angular));\n","(function(angular) {\r\n\t'use strict';\r\n\r\n\tangular.module('xpsui:controllers')\r\n\t.controller('xpsui:DashboardCtrl', [\r\n\t\t\"$scope\", \r\n\t\t\"$location\", \r\n\t\tfunction($scope, $location) {\r\n\t\t}\r\n\t]);\r\n}(window.angular));","(function(angular) {\n\t'use strict';\n\n\tangular.module('xpsui:controllers')\n\t.controller('xpsui:HelpPageCtrl', [\n\t\t\"$scope\", \n\t\tfunction($scope) {\n\t\t\t$scope.greeting = 'Help';\n\t\t\tconsole.log($scope.greeting);\n\t\t}\n\t]);\n}(window.angular));","(function(angular) {\n\t'use strict';\n\n\tangular.module('xpsui:controllers')\n\t.controller('xpsui:MassmailingEditCtrl', [\n\t\t'$scope',\n\t\t'$routeParams',\n\t\t'xpsui:SchemaUtil',\n\t\t'xpsui:GenericSearchFactory',\n\t\t'xpsui:NotificationFactory',\n\t\t'xpsui:SchemaUtil',\n\t\t'xpsui:MassmailingFactory',\n\t\tfunction($scope, $routeParams,SchemaUtilFactory,genericSearchFactory,notificationFactory,schemaUtilFactory,massmailingFactory) {\n\n\t\t\tvar schemaUri='uri://registries/mailtemplates#views/mailTemplate/view';\n\t\t\tvar peopleSchemaUri='uri://registries/people#views/fullperson/';\n\n\t\t\t$scope.selectedTemplate={baseData:  { name: '', textTemplate: '', htmlTemplate: ''} };\n\t\t\t$scope.searchDef = {};\n\t\t\t$scope.searchCrit = [];\n\t\t\t$scope.data = [];\n\t\t\t$scope.forcedCriterias = [];\n\t\t\t$scope.selectAll=true;\n\n\t\t\tvar pageSize=20;\n\n\t\t\tschemaUtilFactory.getCompiledSchema(peopleSchemaUri, 'search').success(function(data) {\n\n\t\t\t\t$scope.schema=data;\n\t\t\t\t$scope.searchDef = genericSearchFactory.parseSearchDef(data);\n\t\t\t\t$scope.entity = data.title;\n\t\t\t\t\n\t\t\t\t$scope.addCrit();\n\t\t\t\t$scope.sortBy={header: data.listFields[0] , direction : 'asc' };\n\t\t\t\t$scope.forcedCriterias = data.forcedCriterias || [];\n\t\t\t}).error(function(err) {\n\t\t\t\tnotificationFactory.error(err);\n\t\t\t});\n\n\n\n\t\t\tfunction convertSortBy(searchBy){\n\t\t\t\tif (!searchBy)  {\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\t\t\t\treturn [{ f:searchBy.header.field, o: searchBy.direction}];\n\t\t\t}\n\n\n\t\t\tfunction convertCriteria(crit) {\n\n\t\t\t\tvar retval = [];\n\n\t\t\t\tcrit.map(function(c) {\n\t\t\t\t\tif (c && c.attribute && c.attribute.path) {\n\n\t\t\t\t\t\tretval.push({\n\t\t\t\t\t\t\tf : c.attribute.path,\n\t\t\t\t\t\t\tv : c.value,\n\t\t\t\t\t\t\top : c.operator.value\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tretval.push({f : \"contactInfo.email\",v : null,op : \"neq\"});\n\t\t\t\treturn retval;\n\t\t\t}\n\n\n\t\t\t$scope.addCrit = function() {\n\t\t\t\t$scope.searchCrit.push({});\n\t\t\t};\n\n\t\t\t$scope.removeCrit = function(index) {\n\t\t\t\t$scope.searchCrit.splice(index, 1);\n\t\t\t};\n\n\t\t\tSchemaUtilFactory.listBySchema(schemaUri).success(function(data){\n\t\t\t\t$scope.templates=data;\n\t\t\t});\n\n\n\t\t\t$scope.search = function() {\n\t\t\t\tvar c = convertCriteria($scope.searchCrit);\n\t\t\t\t// add forced criteria\n\t\t\t\tfor (var idx = 0; idx < $scope.forcedCriterias.length; idx++) {\n\t\t\t\t\tc.push($scope.forcedCriterias[idx]);\n\t\t\t\t}\n\t\t\t\t$scope.lastCriteria=JSON.parse(JSON.stringify(c));\n\n\t\t\t\tgenericSearchFactory.getSearch(peopleSchemaUri, c,convertSortBy( $scope.sortBy),0,pageSize).success(function(data) {\n\t\t\t\t\t$scope.data = data;\n\t\t\t\t\tgenericSearchFactory.getSearchCount(peopleSchemaUri,c).success(function(data) {\n\t\t\t\t\t\t$scope.dataSize = data;\n\t\t\t\t\t}).error(function(err) {\n\t\t\t\t\t\tnotificationFactory.error(err);\n\t\t\t\t\t});\n\t\t\t\t}).error(function(err) {\n\t\t\t\t\tnotificationFactory.error(err);\n\t\t\t\t});\n\t\t\t};\n\n\n\t\t\t$scope.recipientCount=function(){\n\t\t\t\tif ($scope.selectAll){\n\t\t\t\t\treturn $scope.dataSize;\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tvar count = 0 ;\n\t\t\t\t\tfor(var index in $scope.data){\n\t\t\t\t\t\tif( $scope.data[index].selected){\n\t\t\t\t\t\t\tcount++;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\treturn count;\n\t\t\t\t}\n\t\t\t\treturn 0;\n\t\t\t}\n\n\t\t\t$scope.setSortBy=function (header){\n\t\t\t\tif ($scope.sortBy && $scope.sortBy.header===header){\n\t\t\t\t\tif ( 'asc'===$scope.sortBy.direction) {\n\t\t\t\t\t\t$scope.sortBy={header: header , direction : 'desc' };\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\t$scope.sortBy={header: header , direction : 'asc' };\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\t$scope.sortBy={header: header , direction : 'desc' };\n\t\t\t\t}\n\t\t\t\t$scope.search();\n\t\t\t};\n\n\t\t\t$scope.searchNext = function() {\n\t\t\t\tvar c = convertCriteria($scope.searchCrit);\n\t\t\t\t// add forced criteria\n\t\t\t\tfor (var idx = 0; idx < $scope.forcedCriterias.length; idx++) {\n\t\t\t\t\tc.push($scope.forcedCriterias[idx]);\n\t\t\t\t}\n\t\t\t\tgenericSearchFactory.getSearch(peopleSchemaUri, $scope.lastCriteria,convertSortBy( $scope.sortBy),$scope.data.length,pageSize).success(function(data) {\n\n\t\t\t\t\tdata.map(function (newItems){\n\t\t\t\t\t\t$scope.data.push(newItems);\n\t\t\t\t\t});\n\n\n\t\t\t\t}).error(function(err) {\n\t\t\t\t\tnotificationFactory.error(err);\n\t\t\t\t});\n\t\t\t};\n\n\n\t\t\t$scope.sendMail=function(){\n\t\t\t\tvar userIds=null;\n\t\t\t\tvar crits=null;\n\t\t\t\tif ($scope.selectAll){\n\t\t\t\t\tcrits=$scope.lastCriteria;\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tuserIds=[];\n\t\t\t\t\tfor(var index in $scope.data){\n\t\t\t\t\t\tif( $scope.data[index].selected){\n\n\t\t\t\t\t\t\tuserIds.push($scope.data[index].id);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tmassmailingFactory.sendMail($scope.selectedTemplate,crits,userIds).success(function(){\n\t\t\t\t\tnotificationFactory.info({translationCode:'massmailing.sent', time:3000});\n\t\t\t\t});\n\t\t\t};\n\n\t\t}\n\t]);\n}(window.angular));\n","(function(angular) {\r\n\t'use strict';\r\n\r\n\tangular.module('xpsui:controllers')\r\n\t.controller('xpsui:PersonalPageCtrl', [\r\n\t\t\"$scope\", \r\n\t\t\"$location\", \r\n\t\tfunction($scope, $location) {\r\n\t\t\tconsole.log('/registry/view/uri~3A~2F~2Fregistries~2Fpeople~23views~2FpersonalProfile/'+$scope.security.currentUser.id);\r\n\t\t\t$location.path('/registry/view/uri~3A~2F~2Fregistries~2Fpeople~23views~2FpersonalProfile/'+$scope.security.currentUser.id);\r\n\t\t}\r\n\t]);\r\n}(window.angular));","(function(angular) {\r\n  'use strict';\r\n\r\n  angular.module('xpsui:controllers')\r\n  .controller('xpsui:PortalEditorCtrl', ['$scope', '$sce', '$http', 'xpsui:NotificationFactory', \r\n    '$route', '$routeParams', '$location', 'xpsui:DateUtil', \r\n    function($scope, $sce, $http, notificationFactory, $route, $routeParams, $location, dateUtils) {\r\n    $scope.model = {\r\n    };\r\n\r\n    $scope.templates = {\r\n      'index' : {\r\n        name: 'Titulok',\r\n        desc: 'Nadpis článku, každý článok by mal mať aspoň jeden nadpis. Nadpis článku sa používa aj ako link v zozname článkov',\r\n        icon: 'img/block-headline.svg',\r\n        meta: {\r\n          template: 'index',\r\n          isIndex: false,\r\n          isMenu: false,\r\n          parentMenu: null,\r\n          enabled: true,\r\n          publishFrom: dateUtils.nowToReverse(),\r\n          tags: []\r\n        },\r\n        data: [\r\n          {\r\n            meta: {\r\n              type: 'pure-html',\r\n              name: 'title',\r\n              element: '<div></div>'\r\n            },\r\n            data: '<h1>...Titulok článku...</h1>'\r\n          },\r\n          {\r\n            meta: {\r\n              type: 'pure-html',\r\n              name: 'abstract',\r\n              element: '<section class=\"abstract\"></section>'\r\n            },\r\n            data: '...Abstrakt článku, krátky popis a zhrnutie...'\r\n          },\r\n          {\r\n            meta: {\r\n              type: 'pure-html',\r\n              name: 'contentBlock',\r\n              element: '<section class=\"content\"></section'\r\n\r\n            },\r\n            data: '<p>...Obsah článku...</p>'\r\n          }\r\n        ]\r\n      },\r\n      'article' : {\r\n        name: 'Article',\r\n        desc: 'Nadpis článku, každý článok by mal mať aspoň jeden nadpis. Nadpis článku sa používa aj ako link v zozname článkov',\r\n        icon: 'img/block-article.svg',\r\n        meta: {\r\n          template: 'article',\r\n          enabled: true,\r\n          publishFrom: dateUtils.nowToReverse(),\r\n          tags: []\r\n        },\r\n        data: [\r\n          {\r\n            meta: {\r\n              type: 'pure-html',\r\n              name: 'title',\r\n              element: '<div></div>'\r\n            },\r\n            data: '<h1>...Titulok článku...</h1>'\r\n          },\r\n          {\r\n            meta: {\r\n              type: 'pure-html',\r\n              name: 'abstract',\r\n              element: '<section class=\"abstract\"></section>'\r\n            },\r\n            data: '...Abstrakt článku, krátky popis a zhrnutie...'\r\n          },\r\n          {\r\n            meta: {\r\n              type: 'pure-html',\r\n              name: 'contentBlock',\r\n              element: '<section class=\"content\"></section'\r\n\r\n            },\r\n            data: '<p>...Obsah článku...</p>'\r\n          }\r\n        ]\r\n      },\r\n      'location' : {\r\n        name: 'Location',\r\n        desc: 'Nadpis článku, každý článok by mal mať aspoň jeden nadpis. Nadpis článku sa používa aj ako link v zozname článkov',\r\n        icon: 'img/block-article.svg',\r\n        meta: {\r\n          template: 'location',\r\n          enabled: true,\r\n          publishFrom: dateUtils.nowToReverse(),\r\n          tags: []\r\n        },\r\n        data: [\r\n          {\r\n            meta: {\r\n              type: 'pure-html',\r\n              name: 'title',\r\n              element: '<div></div>'\r\n            },\r\n            data: '<h1>...Titulok článku...</h1>'\r\n          },\r\n          {\r\n            meta: {\r\n              type: 'pure-html',\r\n              name: 'abstract',\r\n              element: '<section class=\"abstract\"></section>'\r\n            },\r\n            data: '...Abstrakt článku, krátky popis a zhrnutie...'\r\n          },\r\n          {\r\n            meta: {\r\n              type: 'pure-html',\r\n              name: 'contentBlock',\r\n              element: '<section class=\"content\"></section'\r\n\r\n            },\r\n            data: '<p>...Obsah článku...</p>'\r\n          }\r\n        ]\r\n      },\r\n      'news' : {\r\n        name: 'News',\r\n        desc: 'Nadpis článku, každý článok by mal mať aspoň jeden nadpis. Nadpis článku sa používa aj ako link v zozname článkov',\r\n        icon: 'img/block-article.svg',\r\n        meta: {\r\n          template: 'news',\r\n          enabled: true,\r\n          publishFrom: dateUtils.nowToReverse(),\r\n          tags: []\r\n        },\r\n        data: [\r\n          {\r\n            meta: {\r\n              type: 'pure-html',\r\n              name: 'title',\r\n              element: '<div></div>'\r\n            },\r\n            data: '<h1>...Titulok článku...</h1>'\r\n          },\r\n          {\r\n            meta: {\r\n              type: 'pure-html',\r\n              name: 'abstract',\r\n              element: '<section class=\"abstract\"></section>'\r\n            },\r\n            data: '...Abstrakt článku, krátky popis a zhrnutie...'\r\n          },\r\n          {\r\n            meta: {\r\n              type: 'pure-html',\r\n              name: 'contentBlock',\r\n              element: '<section class=\"content\"></section'\r\n\r\n            },\r\n            data: '<p>...Obsah článku...</p>'\r\n          }\r\n        ]\r\n      },\r\n      'video' : {\r\n        name: 'Video',\r\n        desc: 'Nadpis článku, každý článok by mal mať aspoň jeden nadpis. Nadpis článku sa používa aj ako link v zozname článkov',\r\n        icon: 'img/block-article.svg',\r\n        meta: {\r\n          template: 'video',\r\n          enabled: true,\r\n          publishFrom: dateUtils.nowToReverse(),\r\n          tags: []\r\n        },\r\n        data: [\r\n          {\r\n            meta: {\r\n              type: 'pure-html',\r\n              name: 'title',\r\n              element: '<div></div>'\r\n            },\r\n            data: '<h1>...Titulok článku...</h1>'\r\n          },\r\n          {\r\n            meta: {\r\n              type: 'pure-html',\r\n              name: 'abstract',\r\n              element: '<section class=\"abstract\"></section>'\r\n            },\r\n            data: '...Abstrakt článku, krátky popis a zhrnutie...'\r\n          },\r\n          {\r\n            meta: {\r\n              type: 'pure-html',\r\n              name: 'contentBlock',\r\n              element: '<section class=\"content\"></section'\r\n\r\n            },\r\n            data: '<p>...Obsah článku...</p>'\r\n          }\r\n        ]\r\n      },\r\n      'photo' : {\r\n        name: 'photo',\r\n        desc: 'Nadpis článku, každý článok by mal mať aspoň jeden nadpis. Nadpis článku sa používa aj ako link v zozname článkov',\r\n        icon: 'img/block-article.svg',\r\n        meta: {\r\n          template: 'photo',\r\n          enabled: true,\r\n          publishFrom: dateUtils.nowToReverse(),\r\n          tags: []\r\n        },\r\n        data: [\r\n          {\r\n            meta: {\r\n              type: 'pure-html',\r\n              name: 'title',\r\n              element: '<div></div>'\r\n            },\r\n            data: '<h1>...Titulok článku...</h1>'\r\n          },\r\n          {\r\n            meta: {\r\n              type: 'pure-html',\r\n              name: 'abstract',\r\n              element: '<section class=\"abstract\"></section>'\r\n            },\r\n            data: '...Abstrakt článku, krátky popis a zhrnutie...'\r\n          },\r\n          {\r\n            meta: {\r\n              type: 'pure-html',\r\n              name: 'contentBlock',\r\n              element: '<section class=\"content\"></section'\r\n\r\n            },\r\n            data: '<p>...Obsah článku...</p>'\r\n          }\r\n        ]\r\n      },\r\n      'riderszone' : {\r\n        name: 'Riderszone',\r\n        desc: 'Nadpis článku, každý článok by mal mať aspoň jeden nadpis. Nadpis článku sa používa aj ako link v zozname článkov',\r\n        icon: 'img/block-article.svg',\r\n        meta: {\r\n          template: 'riderszone',\r\n          enabled: true,\r\n          publishFrom: dateUtils.nowToReverse(),\r\n          tags: []\r\n        },\r\n        data: [\r\n          {\r\n            meta: {\r\n              type: 'pure-html',\r\n              name: 'title',\r\n              element: '<div></div>'\r\n            },\r\n            data: '<h1>...Titulok článku...</h1>'\r\n          },\r\n          {\r\n            meta: {\r\n              type: 'pure-html',\r\n              name: 'abstract',\r\n              element: '<section class=\"abstract\"></section>'\r\n            },\r\n            data: '...Abstrakt článku, krátky popis a zhrnutie...'\r\n          },\r\n          {\r\n            meta: {\r\n              type: 'pure-html',\r\n              name: 'contentBlock',\r\n              element: '<section class=\"content\"></section'\r\n\r\n            },\r\n            data: '<p>...Obsah článku...</p>'\r\n          }\r\n        ]\r\n      }\r\n    };\r\n\r\n    $scope.blocks = {\r\n      title: {\r\n          meta: {\r\n            name: 'title',\r\n            element: '<div></div>',\r\n            type: 'pure-html',\r\n            title: 'Titulok',\r\n            desc: 'Nadpis článku, každý článok by mal mať aspoň jeden nadpis. Nadpis článku sa používa ak ako link v zozname článkov',\r\n            icon: 'img/block-headline.svg',\r\n          },\r\n          data: '<h1>...Titulok článku...</h1>',\r\n          css: { cssClass: '' }\r\n        },\r\n      abstract: {\r\n          meta: {\r\n            name: 'abstract',\r\n            element: '<section class=\"abstract\"></section>',\r\n            type: 'pure-html',\r\n            title: 'Abstrakt',\r\n            desc: 'Krátke zhrnutie článku',\r\n            icon: 'img/block-abstract.svg',\r\n          },\r\n          data: '...Abstrakt článku...'\r\n        },\r\n      content: {\r\n          meta: {\r\n            name: 'content',\r\n            element: '<section class=\"content\"></section>',\r\n            type: 'pure-html',\r\n            title: 'Obsah',\r\n            desc: 'Obsah článku obsahujúci hlavnú časť textu',\r\n            icon: 'img/block-content.svg',\r\n          },\r\n          data: '<p>...Obsah článku...</p>'\r\n        },\r\n        matchResults: {\r\n            meta: {\r\n              name: 'match-results',\r\n              element: '<section class=\"x-portal-competition-matches\"><header>Výsledky</header></section>',\r\n              type: 'match-results',\r\n              title: 'Výsledky',\r\n              desc: 'Časť obsahujúa výsledky súťaží.',\r\n              icon: 'img/block-content.svg',\r\n            },\r\n            data: '<h1>Výsledky súťaží</h1>'\r\n          },\r\n//          matchStandings: {\r\n//              meta: {\r\n//                name: 'match-standings',\r\n//                element: '<section class=\"x-portal-competition-matches\"><header>Poradie</header></section>',\r\n//                type: 'match-standings',\r\n//                desc: '<h1>Poradie</h1><p>Časť obsahujúa poradie podľa výsledkov súťaží.</p>',\r\n//                icon: 'img/block-content.png',\r\n//              },\r\n//              data: '<h1>Poradie</h1>'\r\n//            },\r\n          link: {\r\n              meta: {\r\n                name: 'link',\r\n                title: 'Linka',\r\n                desc: 'Linka na inú stránku',\r\n                icon: 'img/block-link.svg',\r\n                type: 'link',\r\n              },\r\n              data: {\r\n                  href: 'www.example.com',\r\n                  newWindow: false,\r\n                  title: 'Example link',\r\n                }\r\n            },\r\n      image: {\r\n          meta: {\r\n            name: 'image',\r\n            element: '<div></div>',\r\n            type: 'image',\r\n            title: 'Obrázok',\r\n            desc: 'Veľký obrázok do článku',\r\n            icon: 'img/block-image.svg',\r\n          },\r\n          data: {\r\n            img: ''\r\n          }\r\n        },\r\n        image1170: {\r\n            meta: {\r\n              name: 'image1170',\r\n              element: '<div></div>',\r\n              type: 'image1170',\r\n              title: 'Obrázok 1170px x 570px',\r\n              desc: 'Obrázok 1170px x 570px.',\r\n              icon: 'img/block-image.svg',\r\n            },\r\n            data: {\r\n              img: ''\r\n            }\r\n          },\r\n        video: {\r\n            meta: {\r\n              name: 'video',\r\n              title: 'Embedované video',\r\n              desc: 'Embedované video s titulkom a textom',\r\n              icon: 'img/block-video.svg',\r\n              type: 'video',\r\n            },\r\n            data: {\r\n                src: '',\r\n                title: 'Embedované video',\r\n                subTitle: 'video',\r\n                text: 'text k videu',\r\n              }\r\n          },\r\n        fileList: {\r\n            meta: {\r\n              name: 'file-list',\r\n              element: '<div></div>',\r\n              type: 'file-list',\r\n              title: 'Súbory',\r\n              desc: 'Zoznam súborov',\r\n              icon: 'img/block-filelist.svg',\r\n            },\r\n            data: {\r\n              files: []\r\n            }\r\n          },\r\n      category: {\r\n          meta: {\r\n            name: 'category',\r\n            element: '<div></div>',\r\n            type: 'category',\r\n            title: 'Kategória',\r\n            desc: 'Zoznam článkov v danej kategórii',\r\n            icon: 'img/block-category.svg',\r\n          },\r\n          data: {\r\n            tags: []\r\n          }\r\n        },\r\n        overview: {\r\n            meta: {\r\n              name: 'overview',\r\n              element: '<div></div>',\r\n              type: 'overview',\r\n              title: 'Prehľad',\r\n              desc: 'Prehľad článkov pod sebou.',\r\n              icon: 'img/block-overview.svg',\r\n            },\r\n            data: {\r\n              tags: []\r\n            }\r\n          },\r\n        ranking: {\r\n            meta: {\r\n              name: 'ranking',\r\n              element: '<div></div>',\r\n              type: 'ranking',\r\n              title: 'Poradie',\r\n              desc: 'Výsledky / poradie súťažiacich.',\r\n              icon: 'img/block-ranking.svg',\r\n            },\r\n            data: {\r\n              results: []\r\n            }\r\n          },\r\n      gallery: {\r\n          meta: {\r\n            name: 'gallery',\r\n            element: '<div></div>',\r\n            type: 'gallery',\r\n            title: 'Galéria',\r\n            desc: 'Galéria fotografií',\r\n            icon: 'img/block-gallery.svg',\r\n          },\r\n          data: {\r\n            images: []\r\n          }\r\n        },\r\n      showcase: {\r\n          meta: {\r\n            name: 'showcase',\r\n            element: '<div></div>',\r\n            type: 'showcase',\r\n            title: 'Výklad',\r\n            desc: 'Najhorúcejšie články v prelínajúcom zobrazení výkladného okna',\r\n            icon: 'img/block-topics.svg',\r\n          },\r\n          data: {\r\n            tags: []\r\n          },\r\n          css: { cssClass: '' }\r\n        },\r\n      showcasevideo: {\r\n          meta: {\r\n            name: 'showcasevideo',\r\n            element: '<div></div>',\r\n            type: 'showcasevideo',\r\n            title: 'Výklad s videami',\r\n            desc: 'Videá v prelínajúcom zobrazení výkladného okna',\r\n            icon: 'img/block-videoshowcase.svg',\r\n          },\r\n          data: {\r\n            tags: []\r\n          },\r\n          css: { cssClass: '' }\r\n        },\r\n      };\r\n\r\n    //$scope.templateUrl = 'portal/templates/article.html';\r\n\r\n    //$scope.model = angular.copy($scope.templates.article);\r\n\r\n    console.log($routeParams);\r\n    if ($routeParams.id) {\r\n      $http({\r\n        url: '/udao/get/portalArticles/' + $routeParams.id,\r\n        method: 'GET',\r\n      })\r\n      .success(function(data, status, headers, config){\r\n        $scope.model = data;\r\n        $scope.viewTemplate = $scope.getViewTemplate();\r\n\r\n      }).error(function(err) {\r\n        notificationFactory.error({translationCode:'registry.unsuccesfully.saved', time:3000});\r\n      });\r\n    } else {\r\n      $http({\r\n        method : 'POST',\r\n        url: '/portalapi/getByTags',\r\n        data: {\r\n          tags: ['menu:index']\r\n        }\r\n      })\r\n      .success(function(data, status, headers, config) {\r\n        if (data && data.length > 0 && data[0].id) {\r\n          $location.path('/portal/edit/'+ data[0].id);\r\n          //$route.updateParams({id: data[0].id});\r\n        }\r\n      }).error(function(err) {\r\n        notificationFactory.error(err);\r\n      });\r\n    }\r\n    function enterEditMode() {\r\n      $scope.mode = 'edit';\r\n      $scope.$broadcast('modechange');\r\n    }\r\n\r\n    $scope.edit = function addNew() {\r\n      enterEditMode();\r\n    };\r\n\r\n    $scope.addNew = function addNew() {\r\n      $scope.model = {};\r\n      angular.copy($scope.templates.article, $scope.model);\r\n      $scope.viewTemplate = $scope.getViewTemplate();\r\n\r\n      enterEditMode();\r\n    };\r\n\r\n    $scope.findSurrogateTitle = function(pageBlocks) {\r\n      if (pageBlocks) {\r\n        for(var i = 0; i < pageBlocks.length; i++) {\r\n          if (pageBlocks[i].meta.name == 'title') {\r\n            return pageBlocks[i].data.replace('<h1>', '').replace('</h1>', '');\r\n          }\r\n        }\r\n      }\r\n      return '';\r\n    }\r\n\r\n    $scope.save = function() {\r\n      if ($scope.model.meta) {\r\n        $scope.model.meta.lastModTimestamp = (new Date()).getTime();\r\n        if (!$scope.model.meta.title) {\r\n          var surrogateTitle = $scope.findSurrogateTitle($scope.model.data);\r\n          $scope.model.meta.title = surrogateTitle;\r\n        }\r\n      }\r\n      $http({\r\n        url: '/udao/save/portalArticles',\r\n        method: 'PUT',\r\n        data: $scope.model\r\n      })\r\n      .success(function(data, status, headers, config){\r\n        notificationFactory.clear();\r\n        if (data.id) {\r\n          $location.path('/portal/edit/'+ data.id);\r\n          //$route.updateParams({id: data.id});\r\n        } else if ($scope.model.id) {\r\n          $route.reload();\r\n        }\r\n      }).error(function(err) {\r\n        notificationFactory.error({translationCode:'registry.unsuccesfully.saved', time:3000});\r\n      });\r\n    };\r\n\r\n    $scope.cancel = function() {\r\n      $route.reload();\r\n    };\r\n\r\n    $scope.showBlockSelector = function showBlockSelector() {\r\n      $scope.blockSelectorShown = true;\r\n\t\tdocument.querySelector('body').classList.add('x-dropdown-open');\r\n    };\r\n\r\n    $scope.hideBlockSelector = function hideBlockSelector() {\r\n      $scope.blockSelectorShown = false;\r\n      document.querySelector('body').classList.remove('x-dropdown-open');\r\n    };\r\n\r\n    $scope.selectBlock = function(block) {\r\n      $scope.blockSelectorShown = false;\r\n      document.querySelector('body').classList.remove('x-dropdown-open');\r\n      $scope.model.data.push($scope.blocks[block]);\r\n      $scope.$broadcast('modechange');\r\n    };\r\n\r\n    $scope.makeSafe = function(str) {\r\n      return $sce.trustAsHtml(str);\r\n    };\r\n\r\n    $scope.getViewTemplate = function() {\r\n      if ($scope.model && $scope.model.meta && $scope.model.meta.template) {\r\n        return '/portal/templates/'+$scope.model.meta.template+'.html';\r\n      } else {\r\n        return null;\r\n      }\r\n    };\r\n    // 05.28.2015 Add a hover effect to display descriptions. Added by Tom Tanaka.\r\n    $scope.hoverShowDesc = function(desc) {\r\n        // Shows/hides the delete div on hover\r\n    \t$scope.msg = desc;\r\n    }\r\n    \r\n    $scope.hoverCloseWhite = function() {\r\n        // Change the color of the close button to white.\r\n    \t$scope.color = \"white\";\r\n    }\r\n    \r\n    $scope.hoverCloseBlack = function() {\r\n        // Change the color of the close button to black.\r\n    \t$scope.color = \"black\";\r\n    }\r\n    \r\n\r\n    \r\n  }]);\r\n}(angular));\r\n","(function(angular) {\r\n\t'use strict';\r\n\r\n\tangular.module('xpsui:controllers')\r\n\t.controller('xpsui:PortalEditorListCtrl', [\r\n\t\t'$scope',\r\n\t\t'$sce',\r\n\t\t'$route',\r\n\t\t'xpsui:SchemaUtil',\r\n\t\t'xpsui:NotificationFactory',\r\n\t\t'$http',\r\n\t\t'$location',\r\n\t\t'xpsui:DateUtil',\r\n\t\tfunction(\r\n\t\t\t$scope,\r\n\t\t\t$sce,\r\n\t\t\t$route,\r\n\t\t\tschemaUtilFactory,\r\n\t\t\tnotificationFactory,\r\n\t\t\t$http,\r\n\t\t\t$location,\r\n\t\t\tdateUtils\r\n\t\t) {\r\n\r\n\t\t\t$scope.model = [];\r\n\t\t\t$scope.data = [];\r\n\t\t\t$scope.sort = { \"ASC\": 1, \"DESC\": 0 };\r\n\t\t\t$scope.currSort = { \"field\": \"article.meta.title\", \"order\": $scope.sort.ASC };\r\n\t\t\t$scope.newCrit = { \"field\": \"\", \"op\": \"0\", \"val\": \"\" };\r\n\t\t\t$scope.searchCrits = [ angular.copy($scope.newCrit) ];\r\n\t\t\t$scope.isSearching = false;\r\n\r\n\t\t\t$scope.changeSort = function (newField) {\r\n\t\t\t\tif ($scope.currSort.field == newField) {\r\n\t\t\t\t\t$scope.currSort.order = 1 - $scope.currSort.order;\r\n\t\t\t\t} else {\r\n\t\t\t\t\t$scope.currSort.field = newField;\r\n\t\t\t\t\t$scope.currSort.order = $scope.sort.ASC;\r\n\t\t\t\t}\r\n\t\t\t\t$scope.search();\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t$http({\r\n\t\t\t\tmethod : 'GET',\r\n\t\t\t\turl: '/udao/get/portalArticles',\r\n\t\t\t\tdata: {\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t\t.success(function(data, status, headers, config) {\r\n\t\t\t\t$scope.data = data;\r\n\t\t\t}).error(function(err) {\r\n\t\t\t\tnotificationFactory.error(err);\r\n\t\t\t});\r\n\r\n\t\t\t$scope.filterFn = function (val) {\r\n\t\t\t\tfor (var pos=0; pos<$scope.searchCrits.length; pos++) {\r\n\t\t\t\t\tvar crit = $scope.searchCrits[pos];\r\n\t\t\t\t\tif (crit.field == 'article.meta.title') {\r\n\t\t\t\t\t\treturn (val.meta.title && val.meta.title.toLowerCase().indexOf(crit.val.toLowerCase()) > -1);\r\n\t\t\t\t\t} else if (crit.field == 'article.meta.lastModTimestamp') {\r\n\t\t\t\t\t} else if (crit.field == 'article.meta.tags') {\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t} else if (crit.field == 'article.meta.template') {\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\treturn true;\r\n\t\t\t};\r\n\t\t\t\r\n\t\t\t$scope.search = function () {\r\n\t\t\t\t$scope.model = angular.copy($scope.data);\r\n\t\t\t\t\r\n\t\t\t\t$scope.isSearching = true;\r\n\t\t\t\tif ($scope.currSort.field == 'article.meta.title') {\r\n\r\n\t\t\t\t\t$scope.model.sort(function (val1, val2) {\r\n\t\t\t\t\t\treturn ($scope.currSort.order*2-1)\r\n\t\t\t\t\t\t\t* ((val1.meta.title.toLowerCase() > val2.meta.title.toLowerCase())?1:-1);\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t} else if ($scope.currSort.field == 'article.meta.lastModTimestamp') {\r\n\r\n\t\t\t\t\t$scope.model.sort(function (val1, val2) {\r\n\t\t\t\t\t\treturn ($scope.currSort.order*2-1)\r\n\t\t\t\t\t\t\t\t* (new Date(val1.meta.lastModTimestamp).getTime() \r\n\t\t\t\t\t\t\t\t\t\t- new Date(val2.meta.lastModTimestamp).getTime());\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t} else if ($scope.currSort.field == 'article.meta.tags') {\r\n\t\t\t\t\t$scope.model.sort(function (val1, val2) {\r\n\t\t\t\t\t\treturn ($scope.currSort.order*2-1)\r\n\t\t\t\t\t\t\t* ((val1.meta.tags.join(',').toLowerCase() > val2.meta.tags.join(',').toLowerCase())?1:-1);\r\n\t\t\t\t\t});\r\n\t\t\t\t} else if ($scope.currSort.field == 'article.meta.template') {\r\n\r\n\t\t\t\t\t$scope.model.sort(function (val1, val2) {\r\n\t\t\t\t\t\treturn ($scope.currSort.order*2-1)\r\n\t\t\t\t\t\t\t* ((val1.meta.template.toLowerCase() > val2.meta.template.toLowerCase())?1:-1);\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t}\r\n\t\t\t\t$scope.isSearching = false;\r\n\t\t\t}\r\n\r\n\t\t\t$scope.editArticle = function(articleId) {\r\n\t\t\t\tvar path = \"/portal/edit/\" + articleId;\r\n\r\n\t\t\t\t$location.path(path);\r\n\t\t\t}\r\n\r\n\t\t\t$scope.removeCrit = function(index) {\r\n\t\t\t\t$scope.searchCrits.splice(index, 1);\r\n\t\t\t}\r\n\r\n\t\t\t$scope.addNewCrit = function () {\r\n\t\t\t\t$scope.searchCrits.push(angular.copy($scope.newCrit));\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t$scope.dateToUI = function(date) {\r\n\t\t\t\treturn dateUtils.formatter(new Date(date));\r\n\t\t\t}\r\n\r\n\t\t}\r\n\t]);\r\n}(angular));\r\n","(function(angular) {\r\n\t'use strict';\r\n\r\n\tangular.module('xpsui:controllers')\r\n\t.controller('xpsui:PortalEditorMenuCtrl', [\r\n\t\t'$scope',\r\n\t\t'$sce',\r\n\t\t'$route',\r\n\t\t'xpsui:SchemaUtil',\r\n\t\t'xpsui:NotificationFactory',\r\n\t\t'$http',\r\n\t\t'$location',\r\n\t\tfunction(\r\n\t\t\t$scope,\r\n\t\t\t$sce,\r\n\t\t\t$route,\r\n\t\t\tschemaUtilFactory,\r\n\t\t\tnotificationFactory,\r\n\t\t\t$http,\r\n\t\t\t$location\r\n\t\t) {\r\n\t\t\tvar portalSchemaUri = schemaUtilFactory.decodeUri('uri://registries/portal#');\r\n\t\t\tvar emptyMenu = {\r\n\t\t\t\tindex: {\r\n\t\t\t\t\tname: 'ROOT',\r\n\t\t\t\t\ttransCode: null,\r\n\t\t\t\t\ttags: [],\r\n\t\t\t\t\thash: '',\r\n\t\t\t\t\tsubElements: []\r\n\t\t\t\t}\r\n\t\t\t};\r\n\r\n\t\t\t$scope.model = angular.copy(emptyMenu);\r\n\r\n\t\t\t$scope.cancel = function() {\r\n\t\t\t\t$route.reload();\r\n\t\t\t};\r\n\r\n\t\t\t$scope.save = function() {\r\n\t\t\t\t$http({\r\n\t\t\t\t\turl: '/udao/save/portalMenu',\r\n\t\t\t\t\tmethod: 'PUT',\r\n\t\t\t\t\tdata: $scope.model\r\n\t\t\t\t})\r\n\t\t\t\t.success(function(data, status, headers, config){\r\n\t\t\t\t\tnotificationFactory.clear();\r\n\t\t\t\t\t$route.reload();\r\n\t\t\t\t}).error(function(err) {\r\n\t\t\t\t\tnotificationFactory.error({translationCode:'registry.unsuccesfully.saved', time:3000});\r\n\t\t\t\t});\r\n\t\t\t};\r\n\r\n\t\t\t$http({\r\n\t\t\t\tmethod : 'GET',\r\n\t\t\t\turl: '/udao/list/portalMenu',\r\n\t\t\t\tdata: {\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t\t.success(function(data, status, headers, config){\r\n\t\t\t\tif (data && data.length > 0 && data[0].index) {\r\n\t\t\t\t\t$scope.model = data[0];\r\n\t\t\t\t}\r\n\t\t\t}).error(function(err) {\r\n\t\t\t\tnotificationFactory.error(err);\r\n\t\t\t});\r\n\r\n\t\t}\r\n\t]);\r\n}(angular));\r\n","(function(angular) {\r\n\t'use strict';\r\n\r\n\tangular.module('xpsui:controllers')\r\n\t.controller('xpsui:RegistryCustomGenerateCtrl', ['$scope', '$routeParams', '$http'\r\n\t\t,'xpsui:GeneratorsGenerator', 'xpsui:SchemaUtil', 'xpsui:NotificationFactory', \r\n\t\tfunction($scope, $routeParams, $http, generator,schemaUtilFactory, notificationFactory) {\r\n\t\t\t$scope.model = {};\r\n\t\t\t// $scope.currentSchemaUri = schemaUtilFactory.decodeUri($routeParams.schema);\r\n\r\n\t\t\t$scope.save=function(){\r\n\t\t\t\tgenerator.save($scope.model,$routeParams.generateBy,function(err,progess){\r\n\t\t\t\t\tif(err){\r\n\t\t\t\t\t\tnotificationFactory.error({translationCode:'registry.unsuccesfully.saved', time:3000});\r\n\t\t\t\t\t} else\r\n\t\t\t\t\tnotificationFactory.info({translationCode:'registry.succesfully.saved', time:3000});\r\n\t\t\t\t});\r\n\t\t\t};\r\n\r\n\t\t\tfunction toXlsHtml(tableHtml){\r\n\t\t\t\tvar retVal='<html xmlns:o=\"urn:schemas-microsoft-com:office:office\" xmlns:x=\"urn:schemas-microsoft-com:office:excel\" xmlns=\"http://www.w3.org/TR/REC-html40\"><head><meta http-equiv=Content-Type content=\"text/html; charset=utf-8\"><!--[if gte mso 9]><xml><x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet><x:Name>{worksheet}</x:Name><x:WorksheetOptions><x:DisplayGridlines/></x:WorksheetOptions></x:ExcelWorksheet></x:ExcelWorksheets></x:ExcelWorkbook></xml><![endif]--></head><body>';\r\n\t\t\t\t\tretVal+=tableHtml;\r\n\t\t\t\t\tretVal+='</body></html>';\r\n\t\t\t\treturn retVal;\r\n\t\t\t}\r\n\r\n\t\t\t$scope.exportTable=function(id){\r\n\t\t\t\tvar element=document.getElementById(id);\r\n\r\n\t\t\t\tvar data=toXlsHtml(element.innerHTML);\r\n\r\n\t\t\t\tvar blob = new Blob([data], {type: 'application/vnd.ms-excel;charset=utf-8'});\r\n\t\t\t\tvar url  =  window.webkitURL||window.URL;\r\n\t\t\t\tvar link = document.createElementNS('http://www.w3.org/1999/xhtml', 'a');\r\n\t\t\t\tlink.href = url.createObjectURL(blob);\r\n\t\t\t\tlink.download = 'export.xls'; // whatever file name you want :)\r\n\r\n\t\t\t\tvar event = document.createEvent('MouseEvents');\r\n\t\t\t\tevent.initEvent('click', true, false);\r\n\t\t\t\tlink.dispatchEvent(event);\r\n\r\n\t\t\t};\r\n\r\n\t\t\tfunction fillClubLogos() {\r\n\t\t\t\tvar clubIds = [];\r\n\t\t\t\tfor (var pos=0; pos<$scope.model.listOfTeam.team.length; pos++) {\r\n\t\t\t\t\t(function (position) {\r\n\t\t\t\t\t\tvar rosterId = $scope.model.listOfTeam.team[position].oid;\r\n\t\t\t\t\t\t$http({\r\n\t\t\t\t\t\t\tmethod : 'GET',\r\n\t\t\t\t\t\t\turl : '/udao/getBySchema/uri~3A~2F~2Fregistries~2Frosters~23views~2Frosters~2Fview/' + rosterId,\r\n\t\t\t\t\t\t\tdata : {\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}).success(function(roster) {\r\n\t\t\t\t\t\t\tfillForClub(position, roster.baseData.club.oid);\r\n\t\t\t\t\t\t}).error(function(err) {\r\n\t\t\t\t\t\t\tcallback(err);\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}(pos));\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tfunction fillForClub(position, clubOid) {\r\n\t\t\t\t$http({\r\n\t\t\t\t\tmethod : 'GET',\r\n\t\t\t\t\turl : '/udao/getBySchema/uri~3A~2F~2Fregistries~2Forganizations~23views~2Fclub~2Fview/' + clubOid,\r\n\t\t\t\t\tdata : {\r\n\t\t\t\t\t}\r\n\t\t\t\t}).success(function(club) {\r\n\t\t\t\t\t$scope.model.listOfTeam.team[position].photo = club.logoInfo.photo;\r\n\t\t\t\t}).error(function(err) {\r\n\t\t\t\t\tcallback(err);\r\n\t\t\t\t});\r\n\t\t\t}\r\n\r\n\t\t\t// /registry/generated/:schemaFrom/:idFrom/:generateBy/:template\r\n\t\t\t$http({ method : 'GET',url: '/udao/getBySchema/'+$routeParams.schemaFrom+'/'+ $routeParams.idFrom})\r\n\t\t\t.success(function(data, status, headers, config){\r\n\t\t\t\t$scope.model = data;\r\n\t\t\t\tgenerator.generate(data,$routeParams.generateBy,function(err,progess){\r\n\t\t\t\t\tif(err){\r\n\t\t\t\t\t\tnotificationFactory.error({translationCode:'registry.unsuccesfully.generated', time:3000});\r\n\t\t\t\t\t} else\r\n\t\t\t\t\tnotificationFactory.info({translationCode:'registry.succesfully.generated', time:3000});\r\n\t\t\t\t\tfillClubLogos();\r\n\t\t\t\t});\r\n\r\n\t\t\t}).error(function(err) {\r\n\t\t\t\tnotificationFactory.error(err);\r\n\t\t\t\tfillClubLogos();\r\n\t\t\t});\r\n\t\t}\r\n\t]);\r\n}(window.angular));\r\n","(function(angular) {\r\n\t'use strict';\r\n\r\n\tangular.module('xpsui:controllers')\r\n\t.controller('xpsui:RegistryCustomTemplateCtrl', ['$scope', '$routeParams', '$http', \r\n\t\t'xpsui:SchemaUtil', 'xpsui:NotificationFactory', '$location', 'xpsui:NavigationService',\r\n\t\tfunction($scope, $routeParams, $http, schemaUtilFactory, notificationFactory, $location, navigationService) {\r\n\t\t\t$scope.model = {};\r\n\t\t\t$scope.currentSchemaUri = schemaUtilFactory.decodeUri($routeParams.schema);\r\n\r\n\t\t\tif ($routeParams.template == 'playerLicenseCard.html' || $routeParams.template == 'playerHostingCard.html' || $routeParams.template == 'officerCard.html') {\r\n\t\t\t\t$scope.model = {};\r\n\t\t\t\t$scope.currentSchemaUri = schemaUtilFactory.decodeUri($routeParams.schema);\r\n\r\n\t\t\t\t$http({ method : 'GET',url: '/udao/getBySchema/'+$routeParams.schema+'/'+ $routeParams.id})\r\n\t\t\t\t.success(function(data, status, headers, config){\r\n\t\t\t\t\t$scope.model = data;\r\n\t\t\t\t}).error(function(err) {\r\n\t\t\t\t\tnotificationFactory.error(err);\r\n\t\t\t\t});\r\n\t\t\t\treturn;\r\n\t\t\t};\r\n\r\n\r\n\t\t\tif ($routeParams.template == 'createMember.html') {\r\n\t\t\t\t$http({ method : 'GET',\r\n\t\t\t\t\turl: '/udao/getBySchema/uri~3A~2F~2Fregistries~2Frequests~23views~2FpeopleRegistrationApplicant~2Fview'\r\n\t\t\t\t\t\t+ '/' + $routeParams.id})\r\n\t\t\t\t.success(function(data, status, headers, config) {\r\n\t\t\t\t\tdelete data.id;\r\n\t\t\t\t\tvar copyFields = [\r\n\t\t\t\t\t                  { 'path': 'model.obj', 'value': data }\r\n\t\t\t\t\t];\r\n\t\t\t\t\tvar uri = '/registry/new/uri~3A~2F~2Fregistries~2Fpeople~23views~2Ffullperson';\r\n\t\t\t\t\tnavigationService.navigateToPath(uri, copyFields);\r\n\t\t\t\t\t$location.path(uri);\r\n\t\t\t\t}).error(function(err) {\r\n\t\t\t\t\tnotificationFactory.error(err);\r\n\t\t\t\t});\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tif ($routeParams.template == 'createTransfer.html') {\r\n\t\t\t\t$http({ method : 'GET',\r\n\t\t\t\t\turl: '/udao/getBySchema/uri~3A~2F~2Fregistries~2Frequests~23views~2FtransferApplicant~2Fview'\r\n\t\t\t\t\t\t+ '/' + $routeParams.id})\r\n\t\t\t\t.success(function(data, status, headers, config) {\r\n\t\t\t\t\tvar copyFields = [\r\n\t\t\t\t\t                  { 'path': 'model.obj.baseData', 'value': data.transferData }\r\n\t\t\t\t\t];\r\n\t\t\t\t\tvar uri = '/registry/new/uri~3A~2F~2Fregistries~2Ftransfers~23views~2Ftransfers';\r\n\t\t\t\t\tnavigationService.navigateToPath(uri, copyFields);\r\n\t\t\t\t\t$location.path(uri);\r\n\t\t\t\t}).error(function(err) {\r\n\t\t\t\t\tnotificationFactory.error(err);\r\n\t\t\t\t});\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tif ($routeParams.template == 'personalAccountActivation.html') {\r\n\t\t\t\t$http({ method : 'GET',\r\n\t\t\t\t\turl: '/udao/getBySchema/uri~3A~2F~2Fregistries~2Fpeople~23views~2Ffullperson~2Fview'\r\n\t\t\t\t\t\t+ '/' + $routeParams.id})\r\n\t\t\t\t.success(function(data, status, headers, config) {\r\n\t\t\t\t\t$http({ method : 'GET', url: '/security/profiles' })\r\n\t\t\t\t\t.success(function(dataProfiles, statusProfiles, headersProfiles, configProfiles) {\r\n\t\t\t\t\t\tvar defaultProfile = {};\r\n\t\t\t\t\t\tfor (var pos = 0; pos < dataProfiles.length; pos++) {\r\n\t\t\t\t\t\t\tif (dataProfiles[pos].baseData.name == 'default') {\r\n\t\t\t\t\t\t\t\tdefaultProfile = {};\r\n\t\t\t\t\t\t\t\tdefaultProfile.oid = dataProfiles[pos].id;\r\n\t\t\t\t\t\t\t\tdefaultProfile.refData = { name: dataProfiles[pos].baseData.name };\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tvar email = '';\r\n\t\t\t\t\t\tif (data && data.contactInfo) {\r\n\t\t\t\t\t\t\temail = data.contactInfo.email;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tvar accountName = '';\r\n\t\t\t\t\t\tif (data && data.baseData) {\r\n\t\t\t\t\t\t\taccountName = data.baseData.name;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tvar copyFields = [\r\n\t\t\t\t\t\t\t{ 'path': 'model.obj.account.email', 'value': email },\r\n\t\t\t\t\t\t\t{ 'path': 'model.obj.account.name', 'value': accountName },\r\n\t\t\t\t\t\t\t{ 'path': 'model.obj.account.profiles', 'value': [defaultProfile] }\r\n\t\t\t\t\t\t];\r\n\t\t\t\t\t\tvar uri = '/registry/new/uri~3A~2F~2Fregistries~2FpersonalAccount~23views~2FpersonalAccount';\r\n\t\t\t\t\t\tnavigationService.navigateToPath(uri, copyFields);\r\n\t\t\t\t\t\t$location.path(uri);\r\n\t\t\t\t\t}).error(function(err) {\r\n\t\t\t\t\t\tnotificationFactory.error(err);\r\n\t\t\t\t\t});\r\n\t\t\t\t}).error(function(err) {\r\n\t\t\t\t\tnotificationFactory.error(err);\r\n\t\t\t\t});\r\n\t\t\t\treturn;\t\t\t\t\r\n\t\t\t}\r\n\r\n\t\t}\r\n\t]);\r\n}(window.angular));\r\n","(function(angular) {\r\n\t'use strict';\r\n\r\n\r\n\tangular.module('xpsui:controllers')\r\n\t.controller('xpsui:RegistryNewCtrl', [\r\n\t\t'$route',\r\n\t\t'$scope',\r\n\t\t'$parse',\r\n\t\t'$routeParams',\r\n\t\t'$http',\r\n\t\t'$location',\r\n\t\t'xpsui:SchemaUtil',\r\n\t\t'xpsui:NotificationFactory',\r\n\t\t'xpsui:NavigationService',\r\n\t\tfunction($route, $scope, $parse, $routeParams, $http, $location, schemaUtilFactory, notificationFactory, navigationService) {\r\n\t\t\t// $scope.currentSchemaUri = 'uri://registries/' + schemaUtilFactory.decodeUri($routeParams.schema);\r\n\t\t\t$scope.currentSchemaUri = schemaUtilFactory.decodeUri($routeParams.schema);\r\n\t\t\t$scope.model = {};\r\n\t\t\t$scope.model.obj = {};\r\n\r\n\t\t\t$scope.schemaFormOptions = {\r\n\t\t\t\tmodelPath: 'model.obj',\r\n\t\t\t\tschema: {}\r\n\t\t\t};\r\n\r\n\t\t\t$scope.save = function() {\r\n\t\t\t\t$scope.newForm.xpsui.prepareForSubmit();\r\n\t\t\t\tif ($scope.newForm.$invalid) {\r\n\t\t\t\t\tnotificationFactory.error({translationCode: 'registry.form.not.filled.correctly', time: 5000});\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\r\n\t\t\t\t$http({url: '/udao/saveBySchema/'+schemaUtilFactory.encodeUri(schemaUtilFactory.concatUri($scope.currentSchemaUri , 'new')), method: 'PUT',data: $scope.model.obj})\r\n\t\t\t\t.success(function(data, status, headers, config){\r\n\t\t\t\t\tnotificationFactory.clear();\r\n\t\t\t\t\t//$location.path('/registry/view/' + schemaUtilFactory.encodeUri($routeParams.schema) + '/' + data.id);\r\n\t\t\t\t\t$location.path('/registry/view/' + $routeParams.schema + '/' + data.id);\r\n\t\t\t\t}).error(function(err) {\r\n\t\t\t\t\tnotificationFactory.error({translationCode:'registry.unsuccesfully.saved', time:3000});\r\n\t\t\t\t});\r\n\t\t\t};\r\n\r\n\t\t\t$scope.cancel = function() {\r\n\t\t\t\t$route.reload();\r\n\t\t\t};\r\n\r\n\t\t\tschemaUtilFactory.getCompiledSchema($scope.currentSchemaUri, 'new').success(function(data) {\r\n\t\t\t\t$scope.schemaFormOptions.schema = data;\r\n\t\t\t\tschemaUtilFactory.generateObjectFromSchema($scope.schemaFormOptions.schema, $scope.model.obj);\r\n\t\t\t\tvar filler = navigationService.restore();\r\n\t\t\t\tif (filler) {\r\n\t\t\t\t\tschemaUtilFactory.fillObj($scope, filler);\r\n\t\t\t\t}\r\n\t\t\t}).error(function(err) {\r\n\t\t\t\tnotificationFactory.error(err);\r\n\t\t\t});\r\n\t\t}\r\n\t]);\r\n}(window.angular));\r\n","(function(angular) {\n\t'use strict';\n\n\t/**\n\t * @module xpsui:controllers\n\t */\n\tangular.module('xpsui:controllers')\n\t\t/**\n\t\t *\n\t\t * Requires:\n\t\t * * #routeParams contain 'schema' \n\t\t */\n\t.controller('xpsui:RegistrySearchCtrl', [ \n\t\t'$scope', \n\t\t'$routeParams',\n\t\t'xpsui:SchemaUtil',\n\t\t'$translate',\n\t\t'xpsui:HttpHandlerFactory',\n\t\t'$parse',\n\t\t'xpsui:logging',\n\t\t'xpsui:QueryFilter',\n\t\tfunction($scope, $routeParams, schemaUtil, $translate, httpFactory, $parse, log, QueryFilter) {\n\n\t\t\tvar httpHandler = httpFactory.newHandler();\n\n\t\t\t//FIXME this function must be replaced by generic objecttools function shared among client and server if poosible\n\t\t\t$scope.objectPathToSchemaPath = function(objPath) {\n\t\t\t\tif (objPath) {\n\t\t\t\t\treturn 'properties.'+objPath.replace(/\\./g, '.properties.');\n\t\t\t\t} else {\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\t\t\t};\n\t\t\t\n\t\t\t$scope.fieldWeigth = function(field) {\n\t\t\t\tif (field.render && field.render.width) {\n\t\t\t\t\tif (field.render.width == 'narrow') {\n\t\t\t\t\t\treturn '2 0 100px';\n\t\t\t\t\t} else if (field.render.width == 'wide') {\n\t\t\t\t\t\treturn '50 0 150px';\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn '10 0 200px';\n\t\t\t}\n\n\t\t\t$scope.limit = 50;\n\t\t\t$scope.moreData = false;\n\t\t\t$scope.isSearching = false;\n\t\t\t$scope.isExporting = false;\n\n\t\t\t// current sort definition\n\t\t\t$scope.currSort = {\n\t\t\t\tfield: null,\n\t\t\t\torder: QueryFilter.sort.ASC\n\t\t\t};\n\n\t\t\t$scope.sort = QueryFilter.sort;\n\n\t\t\t$scope.addNewCrit = function() {\n\t\t\t\t$scope.searchCrits.push({\n\t\t\t\t\top: $scope.allOps[0]\n\t\t\t\t});\n\t\t\t};\n\n\t\t\t$scope.removeCrit = function(idx) {\n\t\t\t\t$scope.searchCrits.splice(idx, 1);\n\t\t\t};\n\n\t\t\t/**\n\t\t\t * Changes search sort order by field.\n\t\t\t * Order of sort can be changed by consequent use of function with\n\t\t\t * same field name.\n\t\t\t *\n\t\t\t * @param {string} field name of parameter\n\t\t\t *\n\t\t\t */\n\t\t\t$scope.changeSort = function(field) {\n\t\t\t\tif ($scope.currSort.field == field) {\n\t\t\t\t\t// same field clicked twice, change sort order\n\n\t\t\t\t\tif ($scope.currSort.order == QueryFilter.sort.ASC) {\n\t\t\t\t\t\t$scope.currSort.order = QueryFilter.sort.DESC;\n\t\t\t\t\t} else {\n\t\t\t\t\t\t$scope.currSort.order = QueryFilter.sort.ASC;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t$scope.currSort.field = field;\n\n\t\t\t\t$scope.search();\n\t\t\t};\n\n\t\t\t$scope.filterKeyPressed = function (event) {\n\t\t\t\tif(event.which === 13) {\n\t\t\t\t\t$scope.search();\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t$scope.exportCsv = function() {\n\t\t\t\t$scope.isExporting = true;\n\n\t\t\t\tsetTimeout(function() {\n\t\t\t\t\tvar data = $scope.data\n\n\t\t\t\t\tvar htmlData = [];\n\t\t\t\t\thtmlData.push('<html xmlns:o=\"urn:schemas-microsoft-com:office:office\" xmlns:x=\"urn:schemas-microsoft-com:office:excel\" xmlns=\"http://www.w3.org/TR/REC-html40\"><head><meta http-equiv=Content-Type content=\"text/html; charset=utf-8\"><!--[if gte mso 9]><xml><x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet><x:Name>{worksheet}</x:Name><x:WorksheetOptions><x:DisplayGridlines/></x:WorksheetOptions></x:ExcelWorksheet></x:ExcelWorksheets></x:ExcelWorkbook></xml><![endif]--></head><body><table id=\"tblExport\" style=\"border:1px solid black; \"><thead><tr>');\n\t\t\t\t\tfor (var li in $scope.schema.listFields) {\n\t\t\t\t\t\tvar lisDef=$scope.schema.listFields[li];\n\t\t\t\t\t\thtmlData.push('<th>'+lisDef.title+'</th>');\n\t\t\t\t\t}\n\t\t\t\t\thtmlData.push('<tr></thead><tbody>');\n\n\t\t\t\t\tfor (var item=0; item<data.length; item++) {\n\t\t\t\t\t\thtmlData.push('<tr>');\n\t\t\t\t\t\tfor (var li=0; li<$scope.schema.listFields.length; li++) {\n\t\t\t\t\t\t\tvar field = $scope.schema.listFields[li].field;\n\t\t\t\t\t\t\tvar value = data[item][field];\n\t\t\t\t\t\t\tif (value && value.refData) {\n\t\t\t\t\t\t\t\tvar text = \"\";\n\t\t\t\t\t\t\t\tvar sep = \"\";\n\t\t\t\t\t\t\t\tfor (var key in value.refData) {\n\t\t\t\t\t\t\t\t\ttext = text + sep + value.refData[key];\n\t\t\t\t\t\t\t\t\tsep = \" | \";\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\thtmlData.push('<td>' + text +'</td>');\n\t\t\t\t\t\t\t} else if (value || value === 0) {\n\t\t\t\t\t\t\t\thtmlData.push('<td>' + value + '</td>');\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\thtmlData.push('<td></td>');\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\thtmlData.push('</tr>');\n\t\t\t\t\t}\n\t\t\t\t\thtmlData.push('</tbody></table></body></html>');\n\n\t\t\t\t\tvar blob = new Blob([htmlData.join('')], {type: 'application/vnd.ms-excel;charset=utf-8'});\n\t\t\t\t\tvar url  =  window.webkitURL||window.URL;\n\t\t\t\t\tvar link = document.createElementNS('http://www.w3.org/1999/xhtml', 'a');\n\t\t\t\t\tlink.href = url.createObjectURL(blob);\n\t\t\t\t\tlink.download = 'search-export.xls'; // whatever file name you want :)\n\n\t\t\t\t\tvar event = document.createEvent('MouseEvents');\n\t\t\t\t\tevent.initEvent('click', true, false);\n\t\t\t\t\tlink.dispatchEvent(event);\n\n\t\t\t\t\t$scope.$apply(function () {\n\t\t\t\t\t\t$scope.isExporting = false;\n\t\t\t\t\t});\n\t\t\t\t}, 10);\n\t\t\t};\n\n\t\t\t$scope.setSearch = function(field) {\n\t\t\t};\n\n\t\t\t$scope.search = function() {\n\t\t\t\t$scope.model = [];\n\t\t\t\t$scope.data = [];\n\t\t\t\t$scope.moreData = false;\n\t\t\t\t$scope.currPage = 0;\n\t\t\t\tfetchData();\n\t\t\t};\n\n\t\t\t$scope.next = function() {\n\t\t\t\t++$scope.currPage;\n\t\t\t\tfetchData();\n\t\t\t};\n\n\t\t\t$scope.findFieldDefinition = function(fieldPath) {\n\t\t\t\tfor (var i = 0; i < $scope.schemaFields.length; i++) {\n\t\t\t\t\tif (fieldPath == $scope.schemaFields[i].path) {\n\t\t\t\t\t\treturn $scope.schemaFields[i];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t};\n\n\t\t\tfunction fetchData() {\n\t\t\t\t$scope.isSearching = true;\n\n\t\t\t\tvar qf = QueryFilter.create();\n\t\t\t\t\n\t\t\t\t// add criteria\n\t\t\t\tfor (var i = 0; i <$scope.searchCrits.length; ++i) {\n\t\t\t\t\t// skip criteria with empty field\n\t\t\t\t\tif ($scope.searchCrits[i].field) {\n\t\t\t\t\t\tvar val = $scope.searchCrits[i].val;\n\t\t\t\t\t\tvar path = $scope.searchCrits[i].field.path;\n\n\t\t\t\t\t\tvar fieldDef = $scope.findFieldDefinition($scope.searchCrits[i].field.path);\n\t\t\t\t\t\tif (fieldDef\n\t\t\t\t\t\t\t&& fieldDef.fragment.type == 'number'\n\t\t\t\t\t\t\t&& val == parseInt(val)) {\n\t\t\t\t\t\t\tval = parseInt(val);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (fieldDef\n\t\t\t\t\t\t\t\t&& fieldDef.fragment.type == 'object'\n\t\t\t\t\t\t\t\t&& val.oid) {\n\t\t\t\t\t\t\tval = $scope.searchCrits[i].val.oid;\n\t\t\t\t\t\t\tpath = $scope.searchCrits[i].field.path + '.oid';\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (fieldDef\n\t\t\t\t\t\t\t\t&& fieldDef.fragment.type == 'array'\n\t\t\t\t\t\t\t\t&& val\n\t\t\t\t\t\t\t\t&& val.length > 0) {\n\t\t\t\t\t\t\tpath = $scope.searchCrits[i].field.path + '.oid';\n\t\t\t\t\t\t\tvar oids = [];\n\t\t\t\t\t\t\tfor (var i=0; i<val.length; i++) {\n\t\t\t\t\t\t\t\toids.push(val[i].oid);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tqf.addCriterium(\n\t\t\t\t\t\t\t\t\tpath,\n\t\t\t\t\t\t\t\t\t'in',\n\t\t\t\t\t\t\t\t\toids\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tqf.addCriterium(\n\t\t\t\t\t\t\tpath,\n\t\t\t\t\t\t\tQueryFilter.operation[$scope.searchCrits[i].op.op],\n\t\t\t\t\t\t\tval\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// add fields\n\t\t\t\tfor (i = 0; i < $scope.schema.listFields.length; ++i) {\n\t\t\t\t\tqf.addField($scope.schema.listFields[i].field);\n\t\t\t\t}\n\t\t\t\tqf.addField('id'); //ID should be always returned\n\n\t\t\t\t// add sorts and limits\n\t\t\t\tqf.addSort($scope.currSort.field, $scope.currSort.order)\n\t\t\t\t\t.setSkip($scope.currPage * $scope.limit)\n\t\t\t\t\t.setLimit($scope.limit + 1);\n\n\t\t\t\tconsole.log(qf);\n\t\t\t\thttpHandler.http({\n\t\t\t\t\turl: '/search/' + schemaUtil.encodeUri(schemaUri),\n\t\t\t\t\tmethod: 'POST',\n\t\t\t\t\tdata: qf\n\t\t\t\t}).then(function(data) {\n\t\t\t\t\t//success\n\n\t\t\t\t\tvar d = data.data;\n\t\t\t\t\t$scope.isSearching = false;\n\t\t\t\t\tif (d.length > $scope.limit) {\n\t\t\t\t\t\t$scope.moreData = true;\n\t\t\t\t\t\td = d.slice(0,$scope.limit);\n\t\t\t\t\t} else {\n\t\t\t\t\t\t$scope.moreData = false;\n\t\t\t\t\t}\n\t\t\t\t\t$scope.model = $scope.model.concat(d);\n\t\t\t\t\t$scope.data = $scope.data.concat(flattenData(d, $scope.schema.listFields));\n\t\t\t\t}, function(err) {\n\t\t\t\t\t// error\n\t\t\t\t\t// FIXME notification\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tvar schemaUri = schemaUtil.decodeUri($routeParams.schema);\n\t\t\t$scope.schema = null;\n\t\t\t$scope.model = [];\n\t\t\t$scope.data = [];\n\n\t\t\t// prepare known operations\n\t\t\t$scope.allOps = [];\n\t\t\t\n\t\t\tfor (var i in QueryFilter.operation) {\n\t\t\t\tif (QueryFilter.operation.hasOwnProperty(i)) {\n\t\t\t\t\t$scope.allOps.push({\n\t\t\t\t\t\ttext: $translate.instant('queryfilter.ops.' + (QueryFilter.operation[i].text || i)),\n\t\t\t\t\t\top: (QueryFilter.operation[i].code || i)\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t$scope.searchCrits = []; // actual row\n\n\t\t\tfunction flattenSchema(schema, path, group) {\n\t\t\t\tvar result = [];\n\n\t\t\t\tif (!(path && angular.isArray(path))) {\n\t\t\t\t\tpath = [];\n\t\t\t\t}\n\n\t\t\t\tif (schema.properties) {\n\t\t\t\t\tfor (var propertyName in schema.properties) {\n\t\t\t\t\t\tif (schema.properties.hasOwnProperty(propertyName)) {\n\t\t\t\t\t\t\tvar property = schema.properties[propertyName];\n\t\t\t\t\t\t\tvar propertyTitle = $translate.instant(property.transCode || property.title);\n\t\t\t\t\t\t\tvar localPath = path.concat(propertyName);\n\n\t\t\t\t\t\t\tif (property.properties) {\n\t\t\t\t\t\t\t\tresult = result.concat(flattenSchema(property, localPath, propertyTitle));\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t// property has no additional properties\n\t\t\t\t\t\t\t\tresult.push({\n\t\t\t\t\t\t\t\t\tname: propertyTitle,\n\t\t\t\t\t\t\t\t\tpath: localPath.join('.'),\n\t\t\t\t\t\t\t\t\tgroup: group,\n\t\t\t\t\t\t\t\t\tfragment: property\n\t\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\treturn result;\n\t\t\t}\n\n\t\t\tfunction flattenData(data, fields) {\n\t\t\t\tvar result = [];\n\n\t\t\t\tif (data && angular.isArray(data)) {\n\t\t\t\t\tfor (var d in data) {\n\t\t\t\t\t\tvar dataRow= {};\n\t\t\t\t\t\tfor (var f in fields) {\n\t\t\t\t\t\t\tdataRow[fields[f].field] = $parse(fields[f].field)(data[d]);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tresult.push(dataRow);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\treturn result;\n\t\t\t}\n\n\t\t\tschemaUtil.getCompiledSchema(schemaUri)\n\t\t\t.success(function(data) {\n\t\t\t\t\t$scope.schema = data;\n\t\t\t\t\t$scope.schemaFields = flattenSchema(data, '');\n\t\t\t\t\t// FIXME check if schema is correct, there has to be at least one field\n\t\t\t\t\t$scope.currSort.field  = $scope.schema.listFields[0].field;\n\t\t\t\t\t$scope.addNewCrit();\n\t\t\t\t}\n\t\t\t)\n\t\t\t.error(function() {\n\t\t\t\tlog.error('Failed to get schema');\n\t\t\t\t//TODO notification anbout error state\n\t\t\t});\n\n\t\t}]);\n\n}(window.angular));\n\n","(function(angular) {\r\n\t'use strict';\r\n\r\n\tangular.module('xpsui:controllers')\r\n\t.controller('xpsui:RegistryViewCtrl', ['$scope', '$routeParams', '$http', '$location','xpsui:SchemaUtil','xpsui:NotificationFactory', function($scope, $routeParams, $http, $location,schemaUtilFactory,notificationFactory) {\r\n\t\t//$scope.currentSchema = 'uri://registries/' + $routeParams.schema;\r\n\t\t$scope.currentSchema = $routeParams.schema;\r\n\t\t$scope.currentId = $routeParams.id;\r\n\t\t//$scope.currentSchemaUri = schemaUtilFactory.decodeUri('uri://registries/' + $routeParams.schema);\r\n\t\t$scope.currentSchemaUri = schemaUtilFactory.decodeUri($routeParams.schema);\r\n\r\n\t\t$scope.model = {};\r\n\t\t$scope.model.obj = {};\r\n\r\n\t\t$scope.schemaFormOptions = {\r\n\t\t\tmodelPath: 'model.obj',\r\n\t\t\tschema: {}\r\n\t\t};\r\n\r\n\t\t$scope.save = function() {\r\n\t\t\t$http({url: '/udao/saveBySchema/'+schemaUtilFactory.encodeUri(schemaUtilFactory.concatUri($scope.currentSchemaUri, 'view')), method: 'PUT',data: $scope.model.obj})\r\n\t\t\t.success(function(data, status, headers, config){\r\n\t\t\t\t$http({ method : 'GET',url: '/udao/getBySchema/'+schemaUtilFactory.encodeUri(schemaUtilFactory.concatUri(schemaUri, 'view'))+'/'+ $scope.currentId})\r\n\t\t\t\t.success(function(data, status, headers, config){\r\n\t\t\t\t\tschemaUtilFactory.generateObjectFromSchema($scope.schemaFormOptions.schema, $scope.model.obj);\r\n\t\t\t\t\t$scope.model.obj = data;\r\n\t\t\t\t}).error(function(err) {\r\n\t\t\t\t\tnotificationFactory.error(err);\r\n\t\t\t\t});\r\n\t\t\t\tnotificationFactory.info({translationCode:'registry.succesfully.saved', time:3000});\r\n\t\t\t})\r\n\t\t\t.error(function(data, status, headers, config) {\r\n\t\t\t\tif (status===400){\r\n\t\t\t\t\tfor(var item in data.error){\r\n\r\n\t\t\t\t\t\tdata.error[item].map(function(fieldError){\r\n\t\t\t\t\t\t\tnotificationFactory.warn({translationCode:fieldError.c,translationData:fieldError.d, time:3000});\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t} else {\r\n\t\t\t\t\tnotificationFactory.error({translationCode:'registry.unsuccesfully.saved', time:3000});\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t};\r\n\r\n\t\t$scope.$on('xpsui:model_changed', function() {\r\n\t\t\t$scope.save();\r\n\t\t});\r\n\r\n\t\tvar schemaUri = schemaUtilFactory.decodeUri($scope.currentSchema);\r\n\r\n\t\tschemaUtilFactory.getCompiledSchema(schemaUri, 'view')\r\n\t\t.success(function(data) {\r\n\t\t\t$scope.schemaFormOptions.schema = data;\r\n\r\n\t\t\t$http({ method : 'GET',url: '/udao/getBySchema/'+schemaUtilFactory.encodeUri(schemaUtilFactory.concatUri(schemaUri, 'view'))+'/'+ $scope.currentId})\r\n\t\t\t.success(function(data, status, headers, config){\r\n\t\t\t\tschemaUtilFactory.generateObjectFromSchema($scope.schemaFormOptions.schema, $scope.model.obj);\r\n\t\t\t\t$scope.model.obj = data;\r\n\t\t\t}).error(function(err) {\r\n\t\t\t\tnotificationFactory.error(err);\r\n\t\t\t});\r\n\r\n\t\t});\r\n\t}]);\r\n}(window.angular));\r\n","(function(angular) {\n\t'use strict';\n\n\tangular.module('xpsui:controllers')\n\t.controller('xpsui:SchemaEditorIndexCtrl', ['$scope', 'schemas', function ($scope, schemas) {\n\n\t\t$scope.schemaList = schemas;\n\n\t}]);\n\n}(window.angular));","(function(angular) {\n\t'use strict';\n\n\tangular.module('xpsui:controllers')\n\t.controller('xpsui:SchemaEditorShowCtrl', [\n\t\t'$scope', '$routeParams', '$location', 'schema', 'xpsui:SchemaEditorService', 'xpsui:NotificationFactory',\n\t\tfunction ($scope, $routeParams, $location, schema, schemaService, notificationFactory) {\n\n\t\t\t$scope.schema = JSON.stringify(schema, null, \"\\t\");\n\t\t\t$scope.loading = false;\n\n\t\t\t$scope.aceConfig = {\n\t\t\t\tuseWrapMode: true,\n\t\t\t\tshowGutter: true,\n\t\t\t\ttheme: 'twilight',\n\t\t\t\tmode: 'json',\n\t\t\t\tonLoad: function aceOnLoad(_editor) {\n\t\t\t\t\t// Options\n\t\t\t\t\t_editor.setReadOnly(false);\n\t\t\t\t\t_editor.getSession().setMode('ace/mode/json');\n\t\t\t\t\tace.config.set(\"basePath\", \"/libs/ace-builds/src\");\n\t\t\t\t}\n\t\t\t};\n\n\t\t\t$scope.postData = function saveSchema(data) {\n\t\t\t\t$scope.loading = true;\n\t\t\t\ttry {\n\t\t\t\t\tschemaService.getPostContent($routeParams.schema,\n\t\t\t\t\t\tJSON.stringify(JSON.parse(data), null, '\\t')).success(function redirectToIndex(data) {\n\t\t\t\t\t\t\t// On success go to the index\n\t\t\t\t\t\t\t$location.url('/schema/edit');\n\t\t\t\t\t\t}).error(function displayError(err) {\n\t\t\t\t\t\t\t$scope.alert = err;\n\t\t\t\t\t\t\t$scope.loading = false;\n\t\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\tcatch (err) {\n\t\t\t\t\t$scope.loading = false;\n\t\t\t\t\tnotificationFactory.error({\n\t\t\t\t\t\ttype: 'error',\n\t\t\t\t\t\ttext: 'Nevalidná schéma: ' + err.message,\n\t\t\t\t\t\tdeletable: true,\n\t\t\t\t\t\ttime: -1,\n\t\t\t\t\t\ttimeout: null\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\t]);\n\n}(window.angular));","(function(angular) {\r\n\t'use strict';\r\n\r\n\tangular.module('xpsui:controllers')\r\n\t/**\r\n\t* Controller used to handele Forgotten Password Page.\r\n\t* Page Form reads user email and recaptcha.\r\n\t* <br> Controller does:\r\n\t* <li> reads Captcha Site Key\r\n\t* <li> recreates captcha compoment\r\n\t* <li> handles submit to send captha and email address\r\n\t* <li> handles potential backend validation  errors\r\n\t* @method security.forgottenCtrl\r\n\t*/\r\n\t.controller('xpsui:SecurityForgottenCtrl', [ '$scope', 'xpsui:SecurityService', '$rootScope', '$location','$timeout','xpsui:NotificationFactory','$window','reCAPTCHA', function($scope, SecurityService, $rootScope, $location,$timeout,notificationFactory,$window,reCAPTCHA) {\r\n\t\t$scope.email = '';\r\n\t\t$scope.capcha = '';\r\n\t\t$scope.done=false;\r\n\r\n\r\n\t\tSecurityService.getCaptchaKey().success(function(json){\r\n\t\t\treCAPTCHA.destroy();\r\n\t\t\treCAPTCHA.setPublicKey(json.key);\r\n\t\t\treCAPTCHA.create('captcha');\r\n\t\t\treCAPTCHA.reload();\r\n\t\t}).error(\r\n\t\t\tfunction(err,data) {\r\n\t\t\t\tvar mes = {translationCode:err.code,translationData:err.data,time:3000};\r\n\t\t\t\tnotificationFactory.error(mes);\r\n\t\t\t}\r\n\t\t);\r\n\r\n\r\n\t\t$scope.submit=function(){\r\n\t\t\tSecurityService.getForgotenToken($scope.email, {challenge:reCAPTCHA.challenge(),response:reCAPTCHA.response()}).success(function(data) {\r\n\t\t\t\tvar mes = {translationCode:'security.forgotten.token.generated',time:3000};\r\n\r\n\t\t\t\tnotificationFactory.info(mes);\r\n\t\t\t\t$scope.done=true;\r\n\r\n\t\t\t\t$timeout(function(){$location.path('/'); },5000);\r\n\t\t\t}).error(function(err,data) {\r\n\t\t\t\tvar mes = {translationCode:err.code,translationData:err.data,time:3000};\r\n\t\t\t\tnotificationFactory.error(mes);\r\n\t\t\t\t$window.Recaptcha.reload();\r\n\t\t\t});\r\n\t\t}\r\n\t} ]);\r\n\r\n}(window.angular));\r\n","(function(angular) {\r\n\t'use strict';\r\n\r\n\tangular.module('xpsui:controllers')\r\n\r\n\t.controller('xpsui:SecurityForgottenResetCtrl', [ '$scope', 'xpsui:SecurityService', '$routeParams', '$location','$timeout','xpsui:NotificationFactory', function($scope, SecurityService, $routeParams, $location,$timeout,notificationFactory) {\r\n\r\n\t\tvar token=$routeParams.token;\r\n\t\t$scope.done=false;\r\n\r\n\t\tSecurityService.getForgotenPasswordReset(token).success(function(data) {\r\n\t\t\tvar mes = {translationCode:'security.forgotten.reset.done',time:3000};\r\n\t\t\tnotificationFactory.info(mes);\r\n\t\t\t$timeout(function(){\t$location.path('/');},5000);\r\n\t\t}).error(function(err,data) {\r\n\t\t\tvar mes = {translationCode:err.code,translationData:err.data,time:3000};\r\n\t\t\tnotificationFactory.error(mes);\r\n\t\t});\r\n\r\n\r\n\t} ]);\r\n\r\n}(window.angular));\r\n","(function(angular) {\r\n\t'use strict';\r\n\r\n\tangular.module('xpsui:controllers')\r\n\t.controller('xpsui:SecurityGroupEditCtrl', [\r\n\t\t'$scope',\r\n\t\t'xpsui:SecurityService',\r\n\t\t'xpsui:SchemaUtil',\r\n\t\t'xpsui:NotificationFactory',\r\n\t\t'schema',\r\n\t\tfunction($scope, SecurityService, schemaUtilFactory, notificationFactory, schema) {\r\n\r\n\t\t\t$scope.groups = [];\r\n\t\t\t$scope.selectedGroup = null;\r\n\t\t\t$scope.group = {};\r\n\t\t\t$scope.group.permissions = [];\r\n\r\n\t\t\t$scope.schemaFormOptions = {\r\n\t\t\t\tmodelPath : 'selectedSchema',\r\n\t\t\t\tschema : {}\r\n\t\t\t};\r\n\r\n\t\t\t$scope.schemaFormOptions.schema = schema;\r\n\r\n\t\t\t// schemaUtilFactory.getCompiledSchema('uri://registries/security#groupmaster', 'new').success(function(data) {\r\n\t\t\t// \t$scope.schemaFormOptions.schema = data;\r\n\t\t\t// }).error(function(err) {\r\n\t\t\t// \tnotificationFactory.error(err);\r\n\t\t\t// });\r\n\r\n\t\t\tvar remove = function(arr, item) {\r\n\t\t\t\tfor (var i = arr.length; i--;) {\r\n\t\t\t\t\tif (arr[i] === item) {\r\n\t\t\t\t\t\tarr.splice(i, 1);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t};\r\n\r\n\t\t\tfunction fillGroupPerm(group, perms) {\r\n\r\n\t\t\t\tvar retval = [];\r\n\t\t\t\tif (!group.security) {\r\n\t\t\t\t\tgroup.security = {\r\n\t\t\t\t\t\tpermissions : {}\r\n\t\t\t\t\t};\r\n\t\t\t\t}\r\n\r\n\t\t\t\tvar groupper = group.security.permissions;\r\n\r\n\t\t\t\tfor ( var p in groupper) {\r\n\t\t\t\t\tif (groupper[p]) {\r\n\t\t\t\t\t\tretval.push(p);\r\n\t\t\t\t\t\tremove(perms, p);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\treturn retval;\r\n\t\t\t}\r\n\r\n\t\t\tSecurityService.getSecurityGroups().success(function(data) {\r\n\t\t\t\t$scope.groups = data;\r\n\t\t\t});\r\n\r\n\t\t\tSecurityService.getSecurityPermissions().success(function(data) {\r\n\t\t\t\t$scope.permissions = data;\r\n\t\t\t});\r\n\r\n\t\t\t$scope.addPermission = function(value) {\r\n\t\t\t\t$scope.group.permissions.push(value);\r\n\t\t\t\tremove($scope.permissions, value);\r\n\r\n\t\t\t};\r\n\t\t\t$scope.removePermission = function(value) {\r\n\t\t\t\t$scope.permissions.push(value);\r\n\t\t\t\tremove($scope.group.permissions, value);\r\n\t\t\t};\r\n\r\n\t\t\t$scope.updateGroupPermissions = function() {\r\n\t\t\t\tSecurityService.updateSecurityGroup($scope.selectedGroup.id, $scope.selectedGroup.baseData.name, $scope.selectedGroup.baseData.id,\r\n\t\t\t\t\t\t$scope.group.permissions, $scope.selectedGroup.baseData.parent);\r\n\t\t\t\t$scope.selectedGroup = null;\r\n\t\t\t\tsetTimeout(function() {\r\n\t\t\t\t\t SecurityService.getSecurityGroups().success(function(data) {\r\n\t\t\t\t\t\t$scope.groups = data;\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t}, 500);\r\n\t\t\t};\r\n\r\n\t\t\t$scope.selectGroup = function(group) {\r\n\t\t\t\t$scope.selectedGroup = group;\r\n\t\t\t\tSecurityService.getSecurityPermissions().success(function(data) {\r\n\t\t\t\t\t$scope.permissions = data;\r\n\t\t\t\t\t$scope.group.permissions = fillGroupPerm($scope.selectedGroup, data);\r\n\t\t\t\t}).error(function(err) {\r\n\t\t\t\t\t notificationFactory.error(err);\r\n\t\t\t\t});\r\n\t\t\t};\r\n\r\n\t\t} \r\n\t]);\r\n\t\r\n}(window.angular));","(function(angular) {\r\n\t'use strict';\r\n\r\n\tangular.module('xpsui:controllers')\r\n\t.controller('xpsui:SecurityLoginCtrl', [ \r\n\t\t'$scope', 'xpsui:SecurityService', \r\n\t\t'$rootScope', \r\n\t\t'$location',\r\n\t\t'xpsui:NotificationFactory', \r\n\t\t'xpsui:NavigationService' ,\r\n\t\tfunction($scope, SecurityService, $rootScope, $location,notificationFactory, navigationService) {\r\n\t\t\t// FIXME remove this in production\r\n\t\t\t// $scope.user = 'johndoe';\r\n\t\t\t// $scope.password = 'johndoe';\r\n\t\t\t$scope.user = '';\r\n\t\t\t$scope.password = '';\r\n\r\n\t\t\t/**\r\n\t\t\t * Login button click\r\n\t\t\t */\r\n\t\t\t$scope.login = function() {\r\n\t\t\t\tSecurityService.getLogin($scope.user, $scope.password).success(function(user) {\r\n\t\t\t\t\tif (user.systemCredentials.profiles.length>1){\r\n\t\t\t\t\t\t$scope.profiles=user.systemCredentials.profiles;\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\tSecurityService.selectProfile(user.systemCredentials.profiles[0].id).success(function(){\r\n\t\t\t\t\t\t\tSecurityService.getCurrentUser().success(function(data){\r\n\t\t\t\t\t\t\t$rootScope.security.currentUser=data;\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tif (!navigationService.back()) {\r\n\t\t\t\t\t\t\t\t$location.path('/personal-page');\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t}).error(function(err) {\r\n\t\t\t\t\tif (err){\r\n\t\t\t\t\t\tconsole.log(err);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tdelete $rootScope.security.currentUser;\r\n\t\t\t\t\tvar mes = {translationCode:'login.authentication.failed',time:5000};\r\n\t\t\t\t\tnotificationFactory.error(mes);\r\n\t\t\t\t});\r\n\t\t\t};\r\n\r\n\t\t\t$scope.selectProfile=function(){\r\n\t\t\t\tif (!$scope.selectedProfile) return;\r\n\t\t\t\tSecurityService.selectProfile($scope.selectedProfile.id).success(function(){\r\n\t\t\t\t\t SecurityService.getCurrentUser().success(function(data){\r\n\t\t\t\t\t\t$rootScope.security.currentUser=data;\r\n\t\t\t\t\t\tif (!navigationService.back()) {\r\n\t\t\t\t\t\t\t$location.path('/personal-page');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t});\r\n\t\t\t};\r\n\r\n\t\t\t$scope.resetPassword = function() {\r\n\t\t\t\tSecurityService.getResetPassword($scope.user);\r\n\t\t\t};\r\n\t\t} \r\n\t]);\r\n\r\n}(window.angular));","(function(angular) {\r\n\t'use strict';\r\n\r\n\tangular.module('xpsui:controllers')\r\n\t.controller(\r\n\t\t'xpsui:SecurityLogoutCtrl',\r\n\t\t[ '$scope', 'xpsui:SecurityService', '$location',\r\n\t\t\t\tfunction($scope, SecurityService, $location) {\r\n\t\t\t\t\t$scope.logout = function() {\r\n\t\t\t\t\t\tSecurityService.getLogout().then(function() {\r\n\t\t\t\t\t\t\t$scope.security.currentUser = undefined;\r\n\t\t\t\t\t\t\t$location.path('/login');\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t};\r\n\t\t\t\t}\r\n\t]);\r\n\t\r\n}(window.angular));","(function(angular) {\r\n\t'use strict';\r\n\r\n\tangular.module('xpsui:controllers')\r\n\t.controller( 'xpsui:SecurityPersonalChangePasswordCtrl', [ \r\n\t\t'$scope', \r\n\t\t'xpsui:SecurityService', \r\n\t\t'$rootScope', \r\n\t\t'$location', \r\n\t\t'xpsui:NotificationFactory',\r\n\t\tfunction($scope, SecurityService, $rootScope, $location, notificationFactory) {\r\n\t\t\t$scope.currentPassword = '';\r\n\t\t\t$scope.newPassword = '';\r\n\t\t\t$scope.newPasswordCheck = '';\r\n\r\n\t\t\t$scope.changePassword = function() {\r\n\t\t\t\tif ($scope.newPassword !== $scope.newPasswordCheck) {\r\n\t\t\tvar mes = {translationCode:'personal.change.password.passwords.not.equal'};\r\n\t\t\tnotificationFactory.warn(mes);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tSecurityService.getChangePassword($scope.currentPassword, $scope.newPassword).success(function(data) {\r\n\t\t\t\tvar mes = {translationCode:'personal.change.password.password.changed'};\r\n\t\t\t\tnotificationFactory.info(mes);\r\n\t\t\t\t\t}).error(function(err, data) {\r\n\t\t\t\t\t\tif (data == 400) {\r\n\t\t\t\t\t\t\tvar mes = {translationCode: err.code,translationData:data,time:3000};\r\n\t\t\t\t\t\t\tnotificationFactory.error(mes);\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tvar mes = {translationCode:'security.user.missing.permissions',translationData:data,time:3000};\r\n\t\t\t\t\t\t\tnotificationFactory.error(mes);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t} \r\n\t]);\r\n\t\r\n}(window.angular));","(function(angular) {\n\t'use strict';\n\n\tangular.module('xpsui:controllers')\n\t.controller('xpsui:SecurityProfileEditCtrl', [\n\t\t'$scope',\n\t\t'$routeParams',\n\t\t'xpsui:SecurityService',\n\t\t'xpsui:GenericSearchFactory',\n\t\t'xpsui:SchemaUtil',\n\t\t'xpsui:NotificationFactory',\n\t\tfunction($scope, $routeParams, securityService, genericSearchFactory, schemaUtilFactory, notificationFactory) {\n\n\t\t\tvar entityUri = 'uri://registries/security#profilesmaster';\n\n\t\t\t$scope.profileList = [];\n\t\t\t$scope.selectedProfile = null;\n\n\t\t\t$scope.profile = {};\n\t\t\t$scope.profile.permissions = [];\n\t\t\t$scope.profile.groups = [];\n\n\n\n\t\t\t$scope.removeCrit = function(index) {\n\t\t\t\t$scope.searchCrit.splice(index, 1);\n\t\t\t};\n\n\t\t\t$scope.searchCrit = [];\n\t\t\t$scope.profileCrit=[];\n\n\t\t\t$scope.editCrit = function(index) {\n\t\t\t\t$scope.critTempAtt = $scope.searchCrit[index].attribute;\n\t\t\t\t$scope.critTempOper = $scope.searchCrit[index].oper;\n\t\t\t\t$scope.critTempVal = $scope.searchCrit[index].value;\n\t\t\t};\n\n\t\t\t$scope.addCrit = function() {\n\t\t\t\t$scope.searchCrit.push({});\n\t\t\t};\n\n\t\t\t$scope.addProfileCrit = function() {\n\t\t\t\t$scope.profileCrit.push({});\n\t\t\t};\n\t\t\t$scope.removeProfileCrit = function(index) {\n\t\t\t\t$scope.profileCrit.splice(index, 1);\n\t\t\t};\n\n\t\t\t$scope.schemaChange=function(crit,done) {\n\t\t\t\tschemaUtilFactory.getCompiledSchema(crit.schema).success(function(data) {\n\t\t\t\tcrit.attDef = genericSearchFactory.parseSearchDef(data);\n\n\t\t\t\tif (done) done(crit);\n\n\t\t\t}).error(function(err) {\n\t\t\t\tnotificationFactory.error(err);\n\n\t\t\t});\n\n\n\t\t\t};\n\n\t\t\tschemaUtilFactory.getCompiledSchema(entityUri, 'search').success(function(data) {\n\t\t\t\t$scope.searchDef = genericSearchFactory.parseSearchDef(data);\n\t\t\t\t$scope.schema = data;\n\t\t\t\t$scope.addCrit({});\n\n\t\t\t}).error(function(err) {\n\t\t\t\tnotificationFactory.error(err);\n\n\t\t\t});\n\n\t\t\tsecurityService.getSecuritySearchSchemas().success(function(data){\n\t\t\t\t$scope.searchSchemas=data;\n\t\t\t}).error(function(err) {\n\t\t\t\tnotificationFactory.error(err);\n\n\t\t\t});\n\n\t\t\tfunction mapOperator(operator){\n\t\t\t\tfor(var op in $scope.searchDef.operators){\n\t\t\t\t\tif ($scope.searchDef.operators[op].value===operator) return $scope.searchDef.operators[op];\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tfunction mapAttribute(attributes,attribute){\n\t\t\t\tfor(var att in attributes){\n\t\t\t\t\tif (attributes[att].path===attribute){\n\t\t\t\t\treturn attributes[att];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tfunction convertCriteria(crit) {\n\n\t\t\t\tvar retval = [];\n\n\t\t\t\tcrit.map(function(c) {\n\t\t\t\t\tif (c && c.attribute && c.attribute.path) {\n\t\t\t\t\t\tif (c.attribute.objectLink2){\n\t\t\t\t\t\t\tretval.push({\n\t\t\t\t\t\t\t\tf : c.attribute.path,\n\t\t\t\t\t\t\t\tv : c.object.oid,\n\t\t\t\t\t\t\t\top : c.operator.value\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse {\n\t\t\t\t\t\t\tretval.push({\n\t\t\t\t\t\t\t\tf : c.attribute.path,\n\t\t\t\t\t\t\t\tv : c.value,\n\t\t\t\t\t\t\t\top : c.operator.value\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\treturn retval;\n\t\t\t}\n\n\t\t\tfunction convertProfileCriteria(crit) {\n\n\t\t\t\tvar retval = [];\n\n\t\t\t\tcrit.map(function(c) {\n\t\t\t\t\tif (c && c.attribute && c.attribute.path) {\n\t\t\t\t\t\tif (c.attribute.render && c.attribute.render.objectLink2){\n\t\t\t\t\t\t\tretval.push({\n\t\t\t\t\t\t\t\tschema: c.schema,\n\t\t\t\t\t\t\t\tf : c.attribute.path,\n\t\t\t\t\t\t\t\tv : c.obj ? c.obj.oid : null,\n\t\t\t\t\t\t\t\texpr : c.expr,\n\t\t\t\t\t\t\t\top : c.operator.value,\n\t\t\t\t\t\t\t\tobj: c.obj\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse {\n\t\t\t\t\t\t\tretval.push({\n\t\t\t\t\t\t\t\tschema: c.schema,\n\t\t\t\t\t\t\t\tf : c.attribute.path,\n\t\t\t\t\t\t\t\tv : c.value,\n\t\t\t\t\t\t\t\texpr : c.expr,\n\t\t\t\t\t\t\t\top : c.operator.value\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\treturn retval;\n\t\t\t}\n\n\n\t\t\t$scope.search = function() {\n\t\t\t\tgenericSearchFactory.getSearch(entityUri, convertCriteria($scope.searchCrit)).success(function(data) {\n\t\t\t\t\t$scope.profileList = data;\n\t\t\t\t}).error(function(err) {\n\t\t\t\t\tnotificationFactory.error(err);\n\t\t\t\t});\n\t\t\t};\n\n\t\t\tfunction remove(arr, item) {\n\t\t\t\tfor (var i = arr.length; i--;) {\n\t\t\t\t\tif (arr[i] === item) {\n\t\t\t\t\t\tarr.splice(i, 1);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t$scope.addPermission = function(value) {\n\t\t\t\t$scope.profile.permissions.push(value);\n\t\t\t\tremove($scope.permissions, value);\n\n\t\t\t};\n\t\t\t$scope.removePermission = function(value) {\n\t\t\t\t$scope.permissions.push(value);\n\t\t\t\tremove($scope.profile.permissions, value);\n\t\t\t};\n\n\t\t\t$scope.addGroup = function(value) {\n\t\t\t\t$scope.profile.groups.push(value);\n\t\t\t\tremove($scope.groups, value);\n\n\t\t\t};\n\t\t\t$scope.removeGroup = function(value) {\n\t\t\t\t$scope.groups.push(value);\n\t\t\t\tremove($scope.profile.groups, value);\n\t\t\t};\n\n\t\t\tfunction fillProfilePerm(profile, perms) {\n\t\t\t\tvar retval = [];\n\t\t\t\tif ( 'security' in profile ){\n\t\t\t\t\tif('permissions' in profile.security ){\n\t\t\t\t\t\tfor(var per in profile.security.permissions ){\n\t\t\t\t\t\t\tif (profile.security.permissions[per]){\n\t\t\t\t\t\t\t\tretval.push(per);\n\t\t\t\t\t\t\t\tremove(perms, per);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\treturn retval;\n\t\t\t}\n\n\t\t\tfunction fillProfileGroups(profile, groups) {\n\t\t\t\tvar retval = [];\n\n\t\t\t\tif (!('security' in profile)){\n\t\t\t\t\t profile.security={};\n\t\t\t\t}\n\t\t\t\tif ( !('groups' in profile.security)) {\n\t\t\t\t\tprofile.security.groups = [];\n\t\t\t\t}\n\n\t\t\t\tfor ( var ug in profile.security.groups) {\n\t\t\t\t\tvar profilegroup = profile.security.groups[ug];\n\t\t\t\t\tgroups.map(function(item) {\n\n\t\t\t\t\t\tif (profilegroup.id === item.id) {\n\t\t\t\t\t\t\tretval.push(item);\n\t\t\t\t\t\t\tremove(groups, item);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\treturn retval;\n\t\t\t}\n\n\n\n\t\t\t$scope.selectProfile = function(profile) {\n\t\t\t\t$scope.selectedProfile = profile;\n\t\t\t\t$scope.profileCrit=[];\n\n\t\t\t\tif (!('security' in profile)){\n\t\t\t\t\tprofile.security={};\n\t\t\t\t}\n\n\t\t\t\tif ( !('groups' in profile.security)) {\n\t\t\t\t\tprofile.security.groups = [];\n\t\t\t\t}\n\t\t\t\tif ('forcedCriteria' in profile.security){\n\t\t\t\t\tprofile.security.forcedCriteria.map(function(schemaCrit){\n\t\t\t\t\t\tschemaCrit.crits.map(function(crit){\n\t\t\t\t\t\t\tvar modelCrit={schema:schemaCrit.applySchema,operator:mapOperator(crit.op),attribute:crit.f,value:crit.v};\n\t\t\t\t\t\t\t\t$scope.schemaChange(modelCrit,function(c){\n\t\t\t\t\t\t\t\t\t\tc.attribute=mapAttribute( c.attDef.attributes,c.attribute);\n\t\t\t\t\t\t\t\t\t\tc.obj=crit.obj;\n\t\t\t\t\t\t\t\t\t\tc.expr=crit.expr;\n\t\t\t\t\t\t\t\t\t\t$scope.profileCrit.push(c);\n\t\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t});\n\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\tsecurityService.getSecurityPermissions().success(function(data) {\n\t\t\t\t\t$scope.permissions = data;\n\t\t\t\t\t$scope.profile.permissions = fillProfilePerm($scope.selectedProfile, data);\n\n\t\t\t\t}).error(function(err){ notificationFactory.error(err);});\n\n\t\t\t\tsecurityService.getSecurityGroups().success(function(data) {\n\t\t\t\t\t$scope.groups = data;\n\t\t\t\t\t$scope.profile.groups = fillProfileGroups($scope.selectedProfile, $scope.groups);\n\t\t\t\t}).error(function(err){\n\t\t\t\t\t notificationFactory.error(err);\n\t\t\t\t\t});\n\n\t\t\t};\n\n\t\t\t$scope.updateProfileSecurity = function() {\n\t\t\t\tsecurityService.updateProfileSecurity($scope.selectedProfile.id, $scope.selectedProfile.baseData.name, $scope.profile.permissions, $scope.profile.groups,convertProfileCriteria($scope.profileCrit)).success(function(data) {\n\t\t\t\t\tnotificationFactory.info({translationCode:'security.profile.edit.modification.done',time:3000});\n\t\t\t\t\t$scope.search();\n\t\t\t\t}).error(function (err){\n\t\t\t\t\tconsole.log(err);\n\t\t\t\t\tnotificationFactory.error(err)});\n\t\t\t};\n\n\t\t\t$scope.fieldKeyDown = function($event) {\n\t\t\t\tif ($event.keyCode == 13) {\n\t\t\t\t\t$scope.search();\n\t\t\t\t\t//$event.stopPropagation();\n\t\t\t\t\t$event.preventDefault();\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t};\n\t\t}\n\t]);\n\n}(window.angular));\n","(function(angular) {\n\t'use strict';\n\n\tangular.module('xpsui:controllers')\n\t.controller( 'xpsui:SecurityUserEditCtrl', [\n\t\t'$scope',\n\t\t'$routeParams',\n\t\t'xpsui:SecurityService',\n\t\t'xpsui:GenericSearchFactory',\n\t\t'xpsui:SchemaUtil',\n\t\t'xpsui:NotificationFactory',\n\t\tfunction($scope, $routeParams, securityService, genericSearchFactory, schemaUtilFactory, notificationFactory) {\n\n\t\t\tvar entityUri = 'uri://registries/userSecurity';\n\t\t\tvar pageSize=20;\n\n\t\t\t$scope.userList = [];\n\t\t\t$scope.selectedUser = null;\n\n\t\t\t$scope.user = {};\n\n\t\t\t$scope.profiles=[];\n\t\t\t$scope.user.profiles=[];\n\n\t\t\t$scope.removeCrit = function(index) {\n\t\t\t\t$scope.searchCrit.splice(index, 1);\n\t\t\t};\n\n\t\t\t$scope.searchCrit = [];\n\n\t\t\t$scope.editCrit = function(index) {\n\t\t\t\t$scope.critTempAtt = $scope.searchCrit[index].attribute;\n\t\t\t\t$scope.critTempOper = $scope.searchCrit[index].oper;\n\t\t\t\t$scope.critTempVal = $scope.searchCrit[index].value;\n\t\t\t};\n\n\t\t\t$scope.addCrit = function() {\n\t\t\t\t$scope.searchCrit.push({});\n\t\t\t};\n\n\t\t\tschemaUtilFactory.getCompiledSchema(entityUri, 'search').success(function(data) {\n\t\t\t\t$scope.searchDef = genericSearchFactory.parseSearchDef(data);\n\t\t\t\t$scope.schema = data;\n\t\t\t\t$scope.addCrit({});\n\t\t\t}).error(function(err) {\n\t\t\t\tnotificationFactory.error(err);\n\t\t\t});\n\n\t\t\tfunction convertCriteria(crit) {\n\t\t\t\tvar retval = [];\n\n\t\t\t\tcrit.map(function(c) {\n\n\t\t\t\t\tif (c.attribute && c.attribute.path && c.operator.value) {\n\t\t\t\t\t\tif (!c.value) {\n\t\t\t\t\t\t\tc.value = '';\n\t\t\t\t\t\t}\n\t\t\t\t\t\tretval.push({\n\t\t\t\t\t\t\tf : c.attribute.path,\n\t\t\t\t\t\t\tv : c.value,\n\t\t\t\t\t\t\top : c.operator.value\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\treturn retval;\n\n\t\t\t}\n\n\n\t\t\tfunction convertSortBy(searchBy){\n\t\t\t\tif (!searchBy)  {\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\t\t\t\treturn [{ f:searchBy.header.field, o: searchBy.direction}];\n\t\t\t}\n\n\t\t\t$scope.search = function() {\n\t\t\t\tvar c = convertCriteria($scope.searchCrit);\n\t\t\t\t// add forced criteria\n\n\t\t\t\t$scope.lastCriteria=JSON.parse(JSON.stringify(c));\n\n\t\t\t\tgenericSearchFactory.getSearch(entityUri, c,convertSortBy( $scope.sortBy),0,pageSize).success(function(data) {\n\t\t\t\t\t$scope.userList = data;\n\t\t\t\t}).error(function(err) {\n\t\t\t\t\tnotificationFactory.error(err);\n\t\t\t\t});\n\t\t\t};\n\n\n\t\t\t$scope.searchNext = function() {\n\t\t\t\tvar c = convertCriteria($scope.searchCrit);\n\t\t\t\t// add forced criteria\n\n\t\t\t\tgenericSearchFactory.getSearch(entityUri, $scope.lastCriteria,convertSortBy( $scope.sortBy),$scope.userList.length,pageSize).success(function(data) {\n\n\t\t\t\tdata.map(function (newItems){\n\t\t\t\t\t$scope.userList.push(newItems);\n\t\t\t\t});\n\n\n\t\t\t\t}).error(function(err) {\n\t\t\t\t\tnotificationFactory.error(err);\n\t\t\t\t});\n\t\t\t};\n\n\t\t\tfunction remove(arr, item) {\n\t\t\t\tfor (var i = arr.length; i--;) {\n\t\t\t\t\tif (arr[i] === item) {\n\t\t\t\t\t\tarr.splice(i, 1);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t$scope.addProfile = function(value) {\n\t\t\t\t$scope.user.profiles.push(value);\n\t\t\t\tremove($scope.profiles, value);\n\t\t\t};\n\t\t\t$scope.removeProfile = function(value) {\n\t\t\t\t$scope.profiles.push(value);\n\t\t\t\tremove($scope.user.profiles, value);\n\t\t\t};\n\n\t\t\tfunction fillUserProfiles(user, groups) {\n\t\t\t\tvar retval = [];\n\n\t\t\t\tif (!('systemCredentials' in user)){\n\t\t\t\t\t user.systemCredentials={};\n\t\t\t\t}\n\t\t\t\tif ( !('profiles' in user.systemCredentials)) {\n\t\t\t\t\tuser.systemCredentials.profiles = [];\n\t\t\t\t}\n\n\t\t\t\tuser.systemCredentials.profiles.map(function(pr){\n\t\t\t\t\tgroups.map(function(item) {\n\t\t\t\t\t\tif (pr === item.id) {\n\t\t\t\t\t\t\tretval.push(item);\n\t\t\t\t\t\t\tremove(groups, item);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t});\n\n\t\t\t\treturn retval;\n\t\t\t}\n\n\t\t\t$scope.selectUser = function(user) {\n\t\t\t\t$scope.selectedUser = user;\n\n\t\t\t\tsecurityService.getSecurityProfiles().success(function(data) {\n\t\t\t\t\t$scope.profiles = data;\n\t\t\t\t\t$scope.user.profiles = fillUserProfiles($scope.selectedUser, data);\n\t\t\t\t}).error(function(err){ notificationFactory.error(err);});\n\n\t\t\t\tif (!('systemCredentials' in user)){\n\t\t\t\t\tuser.systemCredentials={};\n\t\t\t\t\tif ('contactInfo' in user && 'email' in user.contactInfo){\n\t\t\t\t\t\tuser.systemCredentials.login={loginName:user.contactInfo.email,email:user.contactInfo.email};\n\t\t\t\t\t\tsetTimeout( $scope.updateUserSecurity(),2000);\n\t\t\t\t\t} else {\n\t\t\t\t\t\t\tuser.systemCredentials={};\n\t\t\t\t\t\t\tuser.systemCredentials.login={loginName:''};\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t};\n\n\t\t\tfunction convertProfiles(profiles){\n\t\t\t\tvar retval=[];\n\n\t\t\t\tfor (var profile in profiles){\n\t\t\t\t\tretval.push(profiles[profile].id);\n\t\t\t\t}\n\n\t\t\t\treturn retval;\n\t\t\t}\n\n\t\t\t$scope.updateUserSecurity = function() {\n\t\t\t\tsecurityService.updateUserSecurity($scope.selectedUser.id, $scope.selectedUser.systemCredentials.login.loginName,$scope.selectedUser.systemCredentials.login.email,convertProfiles( $scope.user.profiles)).success(function() {\n\t\t\t\t\tnotificationFactory.info({translationCode:'security.user.edit.modification.done',time:3000});\n\t\t\t\t\t$scope.search();\n\t\t\t\t}).error(function (err){\n\t\t\t\t\tconsole.log(err);\n\t\t\t\t\tnotificationFactory.error(err)});\n\t\t\t};\n\n\t\t\t$scope.resetPassword= function (){\n\t\t\t\tsecurityService.updateUserSecurity($scope.selectedUser.id, $scope.selectedUser.systemCredentials.login.loginName,$scope.selectedUser.systemCredentials.login.email, $scope.user.permissions, $scope.user.groups,$scope.user.profiles).success(function() {\n\t\t\t\t\tsecurityService.getResetPassword($scope.selectedUser.id).success(function (){\n\t\t\t\t\t\tnotificationFactory.info({type:'info',text:'Nové heslo bolo zaslané na: ' +$scope.selectedUser.systemCredentials.login.email,deletable : true, time:5000, timeout: null});\n\t\t\t\t\t}).error(function (err){\n\t\t\t\t\t\tconsole.log(err);\n\t\t\t\t\t\tnotificationFactory.error(err);\n\t\t\t\t\t});\n\n\t\t\t\t}).error(function (err){\n\t\t\t\t\tconsole.log(err);\n\t\t\t\t\tnotificationFactory.error(err);\n\t\t\t\t});\n\t\t\t};\n\n\t\t\t$scope.fieldKeyDown = function($event) {\n\t\t\t\tif ($event.keyCode == 13) {\n\t\t\t\t\t$scope.search();\n\t\t\t\t\t//$event.stopPropagation();\n\t\t\t\t\t$event.preventDefault();\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t};\n\t\t}\n\t]);\n\n}(window.angular));\n","(function(angular) {\r\n\t'use strict';\r\n\r\n\tangular.module('xpsui:controllers')\r\n\t.controller('xpsui:StatisticsViewCtrl', [\r\n\t\t'$scope', '$routeParams', '$http', '$location','xpsui:SchemaUtil','xpsui:NotificationFactory','xpsui:StatisticsServiceFactory', \r\n\t\tfunction($scope, $routeParams, $http, $location,schemaUtilFactory,notificationFactory,StatisticsServiceFactory) {\r\n\t\t\tvar generateObjectFromSchema = function(schema, obj) {\r\n\t\t\t\tvar _obj = obj;\r\n\t\t\t\tangular.forEach(schema.properties, function(value, key){\r\n\t\t\t\t\tif (value.type === 'object') {\r\n\t\t\t\t\t\t_obj[key] = {};\r\n\t\t\t\t\t\tgenerateObjectFromSchema(value, _obj[key]);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\t_obj[key] = '';\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t};\r\n\r\n\t\t\t$scope.currentId = $routeParams.id;\r\n\t\t\t$scope.currentSchemaUri = 'uri://registries/statistics';\r\n\t\t\t$scope.currentSchema = schemaUtilFactory.encodeUri($scope.currentSchemaUri);\r\n\r\n\t\t\t$scope.model = {};\r\n\t\t\t$scope.model.obj = {};\r\n\r\n\t\t\t$scope.schemaFormOptions = {\r\n\t\t\t\tmodelPath: 'model.obj',\r\n\t\t\t\tschema: {}\r\n\t\t\t};\r\n\r\n\t\t\t$scope.save = function() {\r\n\t\t\t\t// $http({url: '/udao/saveBySchema/'+schemaUtilFactory.encodeUri(schemaUtilFactory.concatUri($scope.currentSchemaUri, 'new')), method: 'PUT',data: $scope.model.obj})\r\n\t\t\t\t// .success(function(data, status, headers, config){\r\n\t\t\t\t// \tnotificationFactory.info({translationCode:'registry.succesfully.saved', time:3000});\r\n\t\t\t\t// })\r\n\t\t\t\t// .error(function(data, status, headers, config) {\r\n\t\t\t\t// \tnotificationFactory.error({translationCode:'registry.unsuccesfully.saved', time:3000});\r\n\t\t\t\t// });\r\n\t\t\t};\r\n\r\n\t\t\t// $scope.$on('psui:model_changed', function() {\r\n\t\t\t// \t$scope.save();\r\n\t\t\t// });\r\n\r\n\t\t\tvar schemaUri = 'uri://registries/statistics';\r\n\r\n\t\t\tschemaUtilFactory.getCompiledSchema(schemaUri, 'view')\r\n\t\t\t.success(function(data) {\r\n\t\t\t\t$scope.schemaFormOptions.schema = data;\r\n\t\t\t\tStatisticsServiceFactory.getStatisticsData().success(function(data, status, headers, config){\r\n\t\t\t\t\tgenerateObjectFromSchema($scope.schemaFormOptions.schema, $scope.model.obj);\r\n\t\t\t\t\t$scope.model.obj = data;\r\n\t\t\t\t}).error(function(err) {\r\n\t\t\t\t\tnotificationFactory.error(err);\r\n\t\t\t\t});\r\n\r\n\t\t\t});\r\n\t\t}\r\n\t]);\r\n}(window.angular));","(function(angular) {\r\n\t'use strict';\r\n\r\n\tangular.module('xpsui:filters', []);\r\n}(angular));","(function(angular) {\r\n\t'use strict';\r\n\r\n\tangular.module('xpsui:filters')\r\n\t.filter('dateToString', function() {\r\n\t\treturn function(value) {\r\n\t\t\tif (value) {\r\n\t\t\t\tvar year = value.substring(0,4);\r\n\t\t\t\tvar month = value.substring(4,6);\r\n\t\t\t\tvar day = value.substring(6,8);\r\n\t\t\t\tif (year.length === 4 && month.length === 2 && day.length === 2) {\r\n\t\t\t\t\tvar d = new Date(year, month-1, day);\r\n\r\n\t\t\t\t\treturn d.getDate() + '.' + (d.getMonth()+1) + '.' + d.getFullYear();\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn value;\r\n\t\t\t}\r\n\t\t\treturn '';\r\n\t\t};\r\n\t});\r\n\r\n}(window.angular));\r\n","(function(angular) {\r\n\t'use strict';\r\n\r\n\tangular.module('xpsui:filters')\r\n\t.filter('httpPrefixed', function() {\r\n\t\treturn function(value) {\r\n\t\t\tif (value && \r\n\t\t\t\t\t(value.toLowerCase().startsWith('http://') || value.toLowerCase().startsWith('https://'))) {\r\n\t\t\t\treturn value;\r\n\t\t\t}\r\n\r\n\t\t\treturn 'http://' + value;\r\n\t\t};\r\n\t});\r\n\r\n}(window.angular));\r\n","(function(angular) {\r\n\t'use strict';\r\n\r\n\tangular.module('xpsui:filters')\r\n\t.filter('xpsuiuriescape', ['xpsui:SchemaUtil', function(schemaUtilFactory) {\r\n\t\treturn  function(data){return schemaUtilFactory.encodeUri(data);};\r\n\t}]);\r\n\r\n}(window.angular));"]}